(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{103:function(e,t,o){"use strict";o(15),o(84);var r,n,l,a,i=o(76),c=o(11),s=o(37);function u(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function h(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var d=function(){function e(t,o,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.row=t,this.col=o,this.rowspan=r,this.colspan=n,this.removed=!1}var t,o,d;return t=e,d=[{key:"NEGATIVE_VALUES_WARNING",value:function(e){return Object(s.a)(r||(r=u(["The merged cell declared with {row: ",", col: ",", \n      rowspan: ",", colspan: ","} contains negative values, which is \n      not supported. It will not be added to the collection."],["The merged cell declared with {row: ",", col: ",",\\x20\n      rowspan: ",", colspan: ","} contains negative values, which is\\x20\n      not supported. It will not be added to the collection."])),e.row,e.col,e.rowspan,e.colspan)}},{key:"IS_OUT_OF_BOUNDS_WARNING",value:function(e){return Object(s.a)(n||(n=u(["The merged cell declared at [",", ","] is positioned \n      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup."],["The merged cell declared at [",", ","] is positioned\\x20\n      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup."])),e.row,e.col)}},{key:"IS_SINGLE_CELL",value:function(e){return Object(s.a)(l||(l=u(["The merged cell declared at [",", ",'] has both "rowspan" \n      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.'],["The merged cell declared at [",", ",'] has both "rowspan"\\x20\n      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.'])),e.row,e.col)}},{key:"ZERO_SPAN_WARNING",value:function(e){return Object(s.a)(a||(a=u(["The merged cell declared at [",", ",'] has "rowspan" \n      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.'],["The merged cell declared at [",", ",'] has "rowspan"\\x20\n      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.'])),e.row,e.col)}},{key:"containsNegativeValues",value:function(e){return e.row<0||e.col<0||e.rowspan<0||e.colspan<0}},{key:"isSingleCell",value:function(e){return 1===e.colspan&&1===e.rowspan}},{key:"containsZeroSpan",value:function(e){return 0===e.colspan||0===e.rowspan}},{key:"isOutOfBounds",value:function(e,t,o){return e.row<0||e.col<0||e.row>=t||e.row+e.rowspan-1>=t||e.col>=o||e.col+e.colspan-1>=o}}],(o=[{key:"normalize",value:function(e){var t=e.countRows(),o=e.countCols();this.row<0?this.row=0:this.row>t-1&&(this.row=t-1),this.col<0?this.col=0:this.col>o-1&&(this.col=o-1),this.row+this.rowspan>t-1&&(this.rowspan=t-this.row),this.col+this.colspan>o-1&&(this.colspan=o-this.col)}},{key:"includes",value:function(e,t){return this.row<=e&&this.col<=t&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=t}},{key:"includesHorizontally",value:function(e){return this.col<=e&&this.col+this.colspan-1>=e}},{key:"includesVertically",value:function(e){return this.row<=e&&this.row+this.rowspan-1>=e}},{key:"shift",value:function(e,t){var o=e[0]||e[1],r=t+Math.abs(e[0]||e[1])-1,n=e[0]?"colspan":"rowspan",l=e[0]?"col":"row",a=Math.min(t,r),i=Math.max(t,r),c=this[l],s=this[l]+this[n]-1;if(c>=t&&(this[l]+=o),o>0)t<=s&&t>c&&(this[n]+=o);else if(o<0){if(a<=c&&i>=s)return this.removed=!0,!1;if(c>=a&&c<=i){var u=i-c+1,h=Math.abs(o)-u;this[l]-=h+o,this[n]-=u}else if(c<=a&&s>=i)this[n]+=o;else if(c<=a&&s>=a&&s<i){var d=s-a+1;this[n]-=d}}return!0}},{key:"isFarther",value:function(e,t){return!e||("down"===t?e.row+e.rowspan-1<this.row+this.rowspan-1:"up"===t?e.row>this.row:"right"===t?e.col+e.colspan-1<this.col+this.colspan-1:"left"===t?e.col>this.col:null)}},{key:"getLastRow",value:function(){return this.row+this.rowspan-1}},{key:"getLastColumn",value:function(){return this.col+this.colspan-1}},{key:"getRange",value:function(){return new i.a(new c.a(this.row,this.col),new c.a(this.row,this.col),new c.a(this.getLastRow(),this.getLastColumn()))}}])&&h(t.prototype,o),d&&h(t,d),e}();t.a=d},210:function(e,t,o){"use strict";o.d(t,"a",(function(){return r}));o(4),o(105);function r(e,t,o,r){t?t.row===o&&t.col===r?(e.setAttribute("rowspan",t.rowspan.toString()),e.setAttribute("colspan",t.colspan.toString())):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="none"):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="")}},575:function(e,t,o){"use strict";o(26),o(66),o(10),o(12),o(4),o(13),o(5),o(6),o(7),o(16),o(15),o(20),o(84);var r,n=o(103),l=o(11),a=o(76),i=o(14),c=o(35),s=o(1),u=o(210),h=o(37);function d(e){return function(e){if(Array.isArray(e))return f(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return f(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);"Object"===o&&e.constructor&&(o=e.constructor.name);if("Map"===o||"Set"===o)return Array.from(e);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return f(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,r=new Array(t);o<t;o++)r[o]=e[o];return r}function g(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var p=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.plugin=t,this.mergedCells=[],this.hot=t.hot}var t,o,f;return t=e,f=[{key:"IS_OVERLAPPING_WARNING",value:function(e){return Object(h.a)(r||(t=["The merged cell declared at [",", ","], overlaps \n      with the other declared merged cell. The overlapping merged cell was not added to the table, please \n      fix your setup."],(o=["The merged cell declared at [",", ","], overlaps\\x20\n      with the other declared merged cell. The overlapping merged cell was not added to the table, please\\x20\n      fix your setup."])||(o=t.slice(0)),r=Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(o)}}))),e.row,e.col);var t,o}}],(o=[{key:"get",value:function(e,t){var o=this.mergedCells,r=!1;return Object(s.arrayEach)(o,(function(o){return!(o.row<=e&&o.row+o.rowspan-1>=e&&o.col<=t&&o.col+o.colspan-1>=t&&(r=o,1))})),r}},{key:"getByRange",value:function(e){var t=this.mergedCells,o=!1;return Object(s.arrayEach)(t,(function(t){return!(t.row<=e.from.row&&t.row+t.rowspan-1>=e.to.row&&t.col<=e.from.col&&t.col+t.colspan-1>=e.to.col)||(o=t)})),o}},{key:"getWithinRange",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=this.mergedCells,r=[],n=e;if(!n.includesRange){var i=new l.a(n.from.row,n.from.col),c=new l.a(n.to.row,n.to.col);n=new a.a(i,i,c)}return Object(s.arrayEach)(o,(function(e){var o=new l.a(e.row,e.col),i=new l.a(e.row+e.rowspan-1,e.col+e.colspan-1),c=new a.a(o,o,i);t?n.overlaps(c)&&r.push(e):n.includesRange(c)&&r.push(e)})),!!r.length&&r}},{key:"add",value:function(t){var o=this.mergedCells,r=t.row,l=t.col,a=t.rowspan,i=t.colspan,s=new n.a(r,l,a,i),u=this.get(r,l),h=this.isOverlapping(s);return u||h?(Object(c.b)(e.IS_OVERLAPPING_WARNING(s)),!1):(this.hot&&s.normalize(this.hot),o.push(s),s)}},{key:"remove",value:function(e,t){var o=this.mergedCells,r=this.get(e,t),n=r?this.mergedCells.indexOf(r):-1;return!(!r||-1===n)&&(o.splice(n,1),r)}},{key:"clear",value:function(){var e=this,t=this.mergedCells,o=[],r=[];Object(s.arrayEach)(t,(function(t){var r=e.hot.getCell(t.row,t.col);r&&o.push([r,e.get(t.row,t.col),t.row,t.col])})),this.mergedCells.length=0,Object(s.arrayEach)(o,(function(t,n){Object(i.rangeEach)(0,t.rowspan-1,(function(o){Object(i.rangeEach)(0,t.colspan-1,(function(n){if(0!==n||0!==o){var l=e.hot.getCell(t.row+o,t.col+n);l&&r.push([l,null,null,null])}}))})),o[n][1]=null})),Object(s.arrayEach)(o,(function(e){u.a.apply(void 0,d(e))})),Object(s.arrayEach)(r,(function(e){u.a.apply(void 0,d(e))}))}},{key:"isOverlapping",value:function(e){var t=new a.a(new l.a(0,0),new l.a(e.row,e.col),new l.a(e.row+e.rowspan-1,e.col+e.colspan-1)),o=!1;return Object(s.arrayEach)(this.mergedCells,(function(e){return!new a.a(new l.a(0,0),new l.a(e.row,e.col),new l.a(e.row+e.rowspan-1,e.col+e.colspan-1)).overlaps(t)||(o=!0,!1)})),o}},{key:"isFirstRenderableMergedCell",value:function(e,t){var o=this.get(e,t);return o&&this.hot.rowIndexMapper.getFirstNotHiddenIndex(o.row,1)===e&&this.hot.columnIndexMapper.getFirstNotHiddenIndex(o.col,1)===t}},{key:"getFirstRenderableCoords",value:function(e,t){var o=this.get(e,t);if(!o||this.isFirstRenderableMergedCell(e,t))return new l.a(e,t);var r=this.hot.rowIndexMapper.getFirstNotHiddenIndex(o.row,1),n=this.hot.columnIndexMapper.getFirstNotHiddenIndex(o.col,1);return new l.a(r,n)}},{key:"shiftCollections",value:function(e,t,o){var r=this,n=[0,0];switch(e){case"right":n[0]+=o;break;case"left":n[0]-=o;break;case"down":n[1]+=o;break;case"up":n[1]-=o}Object(s.arrayEach)(this.mergedCells,(function(e){e.shift(n,t)})),Object(i.rangeEachReverse)(this.mergedCells.length-1,0,(function(e){var t=r.mergedCells[e];t&&t.removed&&r.mergedCells.splice(r.mergedCells.indexOf(t),1)}))}}])&&g(t.prototype,o),f&&g(t,f),e}();t.a=p},576:function(e,t,o){"use strict";o(15),o(26),o(10),o(12),o(4),o(13),o(5),o(6),o(7),o(20),o(16);var r=o(2),n=o(11),l=o(76),a=o(1);function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==o)return;var r,n,l=[],a=!0,i=!1;try{for(o=o.call(e);!(a=(r=o.next()).done)&&(l.push(r.value),!t||l.length!==t);a=!0);}catch(e){i=!0,n=e}finally{try{a||null==o.return||o.return()}finally{if(i)throw n}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return c(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);"Object"===o&&e.constructor&&(o=e.constructor.name);if("Map"===o||"Set"===o)return Array.from(e);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return c(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,r=new Array(t);o<t;o++)r[o]=e[o];return r}function s(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.plugin=t,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}var t,o,c;return t=e,(o=[{key:"correctSelectionAreaSize",value:function(e){if(e[0]===e[2]&&e[1]===e[3]){var t=this.mergedCellsCollection.get(e[0],e[1]);t&&(e[2]=e[0]+t.rowspan-1,e[3]=e[1]+t.colspan-1)}}},{key:"getDirection",value:function(e,t){return t[0]===e[0]&&t[1]===e[1]&&t[3]===e[3]?"down":t[2]===e[2]&&t[1]===e[1]&&t[3]===e[3]?"up":t[1]===e[1]&&t[2]===e[2]?"right":"left"}},{key:"snapDragArea",value:function(e,t,o,r){var n=t.slice(0),l=this.getAutofillSize(e,t,o),a=i(e,4),c=a[0],s=a[1],u=a[2],h=a[3],d=["up","down"].indexOf(o)>-1?u-c+1:h-s+1,f=l-Math.floor(l/d)*d,g=this.getFarthestCollection(e,t,o,r);if(g)if("down"===o){var p=g.row+g.rowspan-c-f;n[2]+p>=this.plugin.hot.countRows()?n[2]-=f:n[2]+=f?p:0}else if("right"===o){var w=g.col+g.colspan-s-f;n[3]+w>=this.plugin.hot.countCols()?n[3]-=f:n[3]+=f?w:0}else if("up"===o){var v=u-f-g.row+1;n[0]+v<0?n[0]+=f:n[0]-=f?v:0}else if("left"===o){var m=h-f-g.col+1;n[1]+m<0?n[1]+=f:n[1]-=f?m:0}return this.updateCurrentFillCache({baseArea:e,dragDirection:o,foundMergedCells:r,fillSize:l,dragArea:n,cycleLength:d}),n}},{key:"updateCurrentFillCache",value:function(e){this.currentFillData||(this.currentFillData={}),Object(r.extend)(this.currentFillData,e)}},{key:"getAutofillSize",value:function(e,t,o){var r=i(e,4),n=r[0],l=r[1],a=r[2],c=r[3],s=i(t,4),u=s[0],h=s[1],d=s[2],f=s[3];switch(o){case"up":return n-u;case"down":return d-a;case"left":return l-h;case"right":return f-c;default:return null}}},{key:"getDragArea",value:function(e,t,o){var r=i(e,4),n=r[0],l=r[1],a=r[2],c=r[3],s=i(t,4),u=s[0],h=s[1],d=s[2],f=s[3];switch(o){case"up":return[u,h,n-1,c];case"down":return[a+1,l,d,c];case"left":return[u,h,a,l-1];case"right":return[n,c+1,d,f];default:return null}}},{key:"getFarthestCollection",value:function(e,t,o,r){var n=i(e,4),l=n[0],c=n[1],s=n[2],u=n[3],h=["up","down"].indexOf(o)>-1,d=h?s:u,f=h?l:c,g=this.getAutofillSize(e,t,o),p=h?s-l+1:u-c+1,w=g-Math.floor(g/p)*p,v=null,m=null,y=null;switch(o){case"up":v="includesVertically",y=d-w+1;break;case"left":v="includesHorizontally",y=d-w+1;break;case"down":v="includesVertically",y=f+w-1;break;case"right":v="includesHorizontally",y=f+w-1}return Object(a.arrayEach)(r,(function(e){e[v](y)&&e.isFarther(m,o)&&(m=e)})),m}},{key:"recreateAfterDataPopulation",value:function(e){if(this.currentFillData){var t=this.getRangeFromChanges(e),o=this.currentFillData.foundMergedCells,r=this.currentFillData.dragDirection,n=function(e,o){switch(r){case"up":return e.row-o>=t.from.row;case"down":return e.row+e.rowspan-1+o<=t.to.row;case"left":return e.col-o>=t.from.column;case"right":return e.col+e.colspan-1+o<=t.to.column;default:return null}},l=0,a=null,i=1;do{for(var c=0;c<o.length;c+=1){if(n(a=o[c],l=i*this.currentFillData.cycleLength))switch(r){case"up":this.plugin.mergedCellsCollection.add({row:a.row-l,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+l,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-l,colspan:a.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+l,colspan:a.colspan})}c===o.length-1&&(i+=1)}}while(n(a,l));this.currentFillData=null,this.plugin.hot.render()}}},{key:"getRangeFromChanges",value:function(e){var t=this,o={min:null,max:null},r={min:null,max:null};return Object(a.arrayEach)(e,(function(e){var n=e[0],l=t.plugin.hot.propToCol(e[1]);(null===o.min||n<o.min)&&(o.min=n),(null===o.max||n>o.max)&&(o.max=n),(null===r.min||l<r.min)&&(r.min=l),(null===r.max||l>r.max)&&(r.max=l)})),{from:{row:o.min,column:r.min},to:{row:o.max,column:r.max}}}},{key:"dragAreaOverlapsCollections",value:function(e,t,o){var r=i(this.getDragArea(e,t,o),4),a=r[0],c=r[1],s=r[2],u=r[3],h=new n.a(a,c),d=new n.a(s,u),f=new l.a(h,h,d);return!!this.mergedCellsCollection.getWithinRange(f,!0)}}])&&s(t.prototype,o),c&&s(t,c),e}();t.a=u},577:function(e,t,o){"use strict";o(32),o(42),o(51);var r=o(76),n=o(11);function l(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.plugin=t,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}var t,o,a;return t=e,(o=[{key:"snapDelta",value:function(e,t,o){var r=t.to,n=r.row+e.row,l=r.col+e.col;e.row?this.jumpOverMergedCell(e,o,n):e.col&&this.jumpOverMergedCell(e,o,l)}},{key:"jumpOverMergedCell",value:function(e,t,o){var r=e.row||e.col,n=null,l=null,a=null;e.row?(n=t.includesVertically(o),l=t.row,a=t.getLastRow()):e.col&&(n=t.includesHorizontally(o),l=t.col,a=t.getLastColumn()),0!==r&&(r>0?n&&o!==l&&(r+=a-o+1):n&&o!==a&&(r-=o-l+1),e.row?e.row=r:e.col&&(e.col=r))}},{key:"getUpdatedSelectionRange",value:function(e,t){return new r.a(e.highlight,e.from,new n.a(e.to.row+t.row,e.to.col+t.col))}},{key:"getSelectedMergedCellClassName",value:function(e,t,o,r){var n=Math.min(o[0],o[2]),l=Math.min(o[1],o[3]),a=Math.max(o[0],o[2]),i=Math.max(o[1],o[3]);if(void 0!==r&&this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,t)){var c=this.plugin.mergedCellsCollection.get(e,t);if(c){var s=c.getLastRow(),u=c.getLastColumn();return n<=c.row&&l<=c.col&&a>=s&&i>=u?"".concat(this.fullySelectedMergedCellClassName,"-").concat(r):this.plugin.selectionCalculations.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange())?"".concat(this.fullySelectedMergedCellClassName,"-multiple"):void 0}}}},{key:"isMergeCellFullySelected",value:function(e,t){var o=[];if(!t||!e)return!1;for(var r=0;r<e.rowspan;r+=1)for(var l=0;l<e.colspan;l+=1)o.push(new n.a(e.row+r,e.col+l));for(var a=0;a<o.length;a+=1){for(var i=[],c=0;c<t.length;c+=1)i[c]=t[c].includes(o[a]);if(!i.includes(!0))return!1}return!0}},{key:"getSelectedMergedCellClassNameToRemove",value:function(){for(var e=[],t=0;t<=7;t+=1)e.push("".concat(this.fullySelectedMergedCellClassName,"-").concat(t));return e.push("".concat(this.fullySelectedMergedCellClassName,"-multiple")),e}}])&&l(t.prototype,o),a&&l(t,a),e}();t.a=a},578:function(e,t,o){"use strict";o.d(t,"a",(function(){return l}));var r=o(3),n=o(103);function l(e){return{key:"mergeCells",name:function(){var t=this.getSelectedLast();if(t){var o=e.mergedCellsCollection.get(t[0],t[1]);if(o.row===t[0]&&o.col===t[1]&&o.row+o.rowspan-1===t[2]&&o.col+o.colspan-1===t[3])return this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_UNMERGE_CELLS)}return this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_MERGE_CELLS)},callback:function(){e.toggleMergeOnSelection()},disabled:function(){var e=this.getSelectedLast();return!e||(n.a.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner())},hidden:!1}}},766:function(e,t,o){"use strict";o.d(t,"a",(function(){return x}));o(5),o(4),o(6),o(40),o(7),o(47),o(66),o(32),o(42),o(51),o(18),o(17),o(19),o(31),o(23),o(10),o(12),o(13),o(16),o(15),o(20);var r=o(49),n=o(21),l=o(25),a=o(11),i=o(76),c=o(575),s=o(103),u=o(576),h=o(577),d=o(578),f=o(1),g=o(2),p=o(35),w=o(14),v=o(210);function m(e){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==o)return;var r,n,l=[],a=!0,i=!1;try{for(o=o.call(e);!(a=(r=o.next()).done)&&(l.push(r.value),!t||l.length!==t);a=!0);}catch(e){i=!0,n=e}finally{try{a||null==o.return||o.return()}finally{if(i)throw n}}return l}(e,t)||b(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e){return function(e){if(Array.isArray(e))return k(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||b(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){if(e){if("string"==typeof e)return k(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?k(e,t):void 0}}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,r=new Array(t);o<t;o++)r[o]=e[o];return r}function R(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function S(e,t,o){return(S="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,o){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=j(e)););return e}(e,t);if(r){var n=Object.getOwnPropertyDescriptor(r,t);return n.get?n.get.call(o):n.value}})(e,t,o||e)}function O(e,t){return(O=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function M(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,r=j(e);if(t){var n=j(this).constructor;o=Reflect.construct(r,arguments,n)}else o=r.apply(this,arguments);return A(this,o)}}function A(e,t){if(t&&("object"===m(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return I(e)}function I(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function j(e){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}n.a.getSingleton().register("beforeMergeCells"),n.a.getSingleton().register("afterMergeCells"),n.a.getSingleton().register("beforeUnmergeCells"),n.a.getSingleton().register("afterUnmergeCells");var E=new WeakMap,x=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&O(e,t)}(m,e);var t,o,r,n=M(m);function m(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,m),t=n.call(this,e),E.set(I(t),{lastDesiredCoords:null}),t.mergedCellsCollection=null,t.autofillCalculations=null,t.selectionCalculations=null,t}return t=m,r=[{key:"PLUGIN_KEY",get:function(){return"mergeCells"}},{key:"PLUGIN_PRIORITY",get:function(){return 150}}],(o=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().mergeCells}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.mergedCellsCollection=new c.a(this),this.autofillCalculations=new u.a(this),this.selectionCalculations=new h.a(this),this.addHook("afterInit",(function(){return e.onAfterInit.apply(e,arguments)})),this.addHook("beforeKeyDown",(function(){return e.onBeforeKeyDown.apply(e,arguments)})),this.addHook("modifyTransformStart",(function(){return e.onModifyTransformStart.apply(e,arguments)})),this.addHook("afterModifyTransformStart",(function(){return e.onAfterModifyTransformStart.apply(e,arguments)})),this.addHook("modifyTransformEnd",(function(){return e.onModifyTransformEnd.apply(e,arguments)})),this.addHook("modifyGetCellCoords",(function(){return e.onModifyGetCellCoords.apply(e,arguments)})),this.addHook("beforeSetRangeStart",(function(){return e.onBeforeSetRangeStart.apply(e,arguments)})),this.addHook("beforeSetRangeStartOnly",(function(){return e.onBeforeSetRangeStart.apply(e,arguments)})),this.addHook("beforeSetRangeEnd",(function(){return e.onBeforeSetRangeEnd.apply(e,arguments)})),this.addHook("afterIsMultipleSelection",(function(){return e.onAfterIsMultipleSelection.apply(e,arguments)})),this.addHook("afterRenderer",(function(){return e.onAfterRenderer.apply(e,arguments)})),this.addHook("afterContextMenuDefaultOptions",(function(){return e.addMergeActionsToContextMenu.apply(e,arguments)})),this.addHook("afterGetCellMeta",(function(){return e.onAfterGetCellMeta.apply(e,arguments)})),this.addHook("afterViewportRowCalculatorOverride",(function(){return e.onAfterViewportRowCalculatorOverride.apply(e,arguments)})),this.addHook("afterViewportColumnCalculatorOverride",(function(){return e.onAfterViewportColumnCalculatorOverride.apply(e,arguments)})),this.addHook("modifyAutofillRange",(function(){return e.onModifyAutofillRange.apply(e,arguments)})),this.addHook("afterCreateCol",(function(){return e.onAfterCreateCol.apply(e,arguments)})),this.addHook("afterRemoveCol",(function(){return e.onAfterRemoveCol.apply(e,arguments)})),this.addHook("afterCreateRow",(function(){return e.onAfterCreateRow.apply(e,arguments)})),this.addHook("afterRemoveRow",(function(){return e.onAfterRemoveRow.apply(e,arguments)})),this.addHook("afterChange",(function(){return e.onAfterChange.apply(e,arguments)})),this.addHook("beforeDrawBorders",(function(){return e.onBeforeDrawAreaBorders.apply(e,arguments)})),this.addHook("afterDrawSelection",(function(){return e.onAfterDrawSelection.apply(e,arguments)})),this.addHook("beforeRemoveCellClassNames",(function(){return e.onBeforeRemoveCellClassNames.apply(e,arguments)})),this.addHook("beforeUndoStackChange",(function(e,t){if("MergeCells"===t)return!1})),S(j(m.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.clearCollections(),this.hot.render(),S(j(m.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){var e=this.hot.getSettings().mergeCells;this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(e),S(j(m.prototype),"updatePlugin",this).call(this)}},{key:"validateSetting",value:function(e){var t=!0;return!!e&&(s.a.containsNegativeValues(e)?(Object(p.b)(s.a.NEGATIVE_VALUES_WARNING(e)),t=!1):s.a.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(Object(p.b)(s.a.IS_OUT_OF_BOUNDS_WARNING(e)),t=!1):s.a.isSingleCell(e)?(Object(p.b)(s.a.IS_SINGLE_CELL(e)),t=!1):s.a.containsZeroSpan(e)&&(Object(p.b)(s.a.ZERO_SPAN_WARNING(e)),t=!1),t)}},{key:"generateFromSettings",value:function(e){var t=this;if(Array.isArray(e)){var o,r=[];Object(f.arrayEach)(e,(function(e){if(t.validateSetting(e)){var o=new a.a(e.row,e.col),n=new a.a(e.row+e.rowspan-1,e.col+e.colspan-1),l=new i.a(o,o,n);r.push(t.mergeRange(l,!0,!0))}})),r=r.filter((function(e){return!0!==e}));var n=this.getBulkCollectionData(r);(o=this.hot).populateFromArray.apply(o,C(n))}}},{key:"getBulkCollectionData",value:function(e){var t,o=this.getBulkCollectionDataRange(e),r=(t=this.hot).getData.apply(t,C(o)).splice(0);return Object(f.arrayEach)(e,(function(e){var t=y(e,3),n=t[0],l=t[1],a=t[2];Object(f.arrayEach)(a,(function(e,t){Object(f.arrayEach)(e,(function(e,a){r[n-o[0]+t][l-o[1]+a]=e}))}))})),[o[0],o[1],r]}},{key:"getBulkCollectionDataRange",value:function(e){var t=[0,0],o=[0,0],r=null,n=null,l=null;return Object(f.arrayEach)(e,(function(e){r=e[0],n=e[1],l=e[2],t[0]=Math.min(r,t[0]),t[1]=Math.min(n,t[1]),o[0]=Math.max(r+l.length-1,o[0]),o[1]=Math.max(n+l[0].length-1,o[1])})),[].concat(t,o)}},{key:"clearCollections",value:function(){this.mergedCellsCollection.clear()}},{key:"canMergeRange",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!!t||this.validateSetting(e)}},{key:"toggleMergeOnSelection",value:function(){var e=this.hot.getSelectedRangeLast();if(e){e.setDirection("NW-SE");var t=e.from,o=e.to;this.toggleMerge(e),this.hot.selectCell(t.row,t.col,o.row,o.col,!1)}}},{key:"mergeSelection",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(e){e.setDirection("NW-SE");var t=e.from,o=e.to;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(t.row,t.col,o.row,o.col,!1)}}},{key:"unmergeSelection",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(e){var t=e.from,o=e.to;this.unmergeRange(e,!0),this.hot.selectCell(t.row,t.col,o.row,o.col,!1)}}},{key:"mergeRange",value:function(e){var t=this,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=e.getTopLeftCorner(),l=e.getBottomRightCorner(),a={row:n.row,col:n.col,rowspan:l.row-n.row+1,colspan:l.col-n.col+1},i=[],c=null;if(!this.canMergeRange(a,o))return!1;this.hot.runHooks("beforeMergeCells",e,o),Object(w.rangeEach)(0,a.rowspan-1,(function(e){Object(w.rangeEach)(0,a.colspan-1,(function(o){var r=null;i[e]||(i[e]=[]),0===e&&0===o?r=t.hot.getDataAtCell(a.row,a.col):t.hot.setCellMeta(a.row+e,a.col+o,"hidden",!0),i[e][o]=r}))})),this.hot.setCellMeta(a.row,a.col,"spanned",!0);var s=this.mergedCellsCollection.add(a);return!s||(r?c=[a.row,a.col,i]:this.hot.populateFromArray(a.row,a.col,i,void 0,void 0,this.pluginName),this.hot.runHooks("afterMergeCells",e,a,o),c)}},{key:"unmergeRange",value:function(e){var t=this,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.mergedCellsCollection.getWithinRange(e);r&&(this.hot.runHooks("beforeUnmergeCells",e,o),Object(f.arrayEach)(r,(function(e){t.mergedCellsCollection.remove(e.row,e.col),Object(w.rangeEach)(0,e.rowspan-1,(function(o){Object(w.rangeEach)(0,e.colspan-1,(function(r){t.hot.removeCellMeta(e.row+o,e.col+r,"hidden")}))})),t.hot.removeCellMeta(e.row,e.col,"spanned")})),this.hot.runHooks("afterUnmergeCells",e,o),this.hot.render())}},{key:"toggleMerge",value:function(e){var t=this.mergedCellsCollection.get(e.from.row,e.from.col);t.row===e.from.row&&t.col===e.from.col&&t.row+t.rowspan-1===e.to.row&&t.col+t.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}},{key:"merge",value:function(e,t,o,r){var n=new a.a(e,t),l=new a.a(o,r);this.mergeRange(new i.a(n,n,l))}},{key:"unmerge",value:function(e,t,o,r){var n=new a.a(e,t),l=new a.a(o,r);this.unmergeRange(new i.a(n,n,l))}},{key:"onAfterInit",value:function(){this.generateFromSettings(this.hot.getSettings().mergeCells),this.hot.render()}},{key:"onBeforeKeyDown",value:function(e){(e.ctrlKey||e.metaKey)&&!e.altKey&&77===e.keyCode&&(this.toggleMerge(this.hot.getSelectedRangeLast()),this.hot.render(),Object(l.stopImmediatePropagation)(e))}},{key:"onAfterIsMultipleSelection",value:function(e){if(e)for(var t=this.mergedCellsCollection.mergedCells,o=this.hot.getSelectedRangeLast(),r=0;r<t.length;r+=1)if(o.from.row===t[r].row&&o.from.col===t[r].col&&o.to.row===t[r].row+t[r].rowspan-1&&o.to.col===t[r].col+t[r].colspan-1)return!1;return e}},{key:"onModifyTransformStart",value:function(e){var t,o=E.get(this),r=this.hot.getSelectedRangeLast(),n={row:e.row,col:e.col},l=new a.a(r.highlight.row,r.highlight.col),c=this.mergedCellsCollection.get(l.row,l.col);if(o.lastDesiredCoords||(o.lastDesiredCoords=new a.a(null,null)),c){var s=new a.a(c.row,c.col),u=new a.a(c.row+c.rowspan-1,c.col+c.colspan-1);new i.a(s,s,u).includes(o.lastDesiredCoords)||(o.lastDesiredCoords=new a.a(null,null)),n.row=o.lastDesiredCoords.row?o.lastDesiredCoords.row-l.row:n.row,n.col=o.lastDesiredCoords.col?o.lastDesiredCoords.col-l.col:n.col,e.row>0?n.row=c.row+c.rowspan-1-l.row+e.row:e.row<0&&(n.row=l.row-c.row+e.row),e.col>0?n.col=c.col+c.colspan-1-l.col+e.col:e.col<0&&(n.col=l.col-c.col+e.col)}t=new a.a(r.highlight.row+n.row,r.highlight.col+n.col);var h=this.mergedCellsCollection.get(t.row,t.col);if(h){var d=this.mergedCellsCollection.getFirstRenderableCoords(h.row,h.col);o.lastDesiredCoords=t,n={row:d.row-l.row,col:d.col-l.col}}0!==n.row&&(e.row=n.row),0!==n.col&&(e.col=n.col)}},{key:"onModifyTransformEnd",value:function(e){var t=this,o=this.hot.getSelectedRangeLast(),r=Object(g.clone)(e),n=this.selectionCalculations.getUpdatedSelectionRange(o,e),l=Object(g.clone)(r),a=this.mergedCellsCollection.getWithinRange(n,!0);do{l=Object(g.clone)(r),this.selectionCalculations.getUpdatedSelectionRange(o,r),Object(f.arrayEach)(a,(function(e){t.selectionCalculations.snapDelta(r,o,e)}))}while(r.row!==l.row||r.col!==l.col);e.row=r.row,e.col=r.col}},{key:"onModifyGetCellCoords",value:function(e,t){if(!(e<0||t<0)){var o=this.mergedCellsCollection.get(e,t);if(o){var r=o.row,n=o.col,l=o.colspan;return[r,n,r+o.rowspan-1,n+l-1]}}}},{key:"addMergeActionsToContextMenu",value:function(e){e.items.push({name:"---------"},Object(d.a)(this))}},{key:"onAfterRenderer",value:function(e,t,o){var r=this.mergedCellsCollection.get(t,o),n=Object(g.isObject)(r)?Object(g.clone)(r):void 0;if(Object(g.isObject)(n)){var l=this.hot,a=l.rowIndexMapper,i=l.columnIndexMapper,c=n.row,s=n.col,u=n.colspan,h=n.rowspan,d=y(this.translateMergedCellToRenderable(c,h,s,u),2),f=d[0],p=d[1],w=f-a.getRenderableFromVisualIndex(t)+1,m=p-i.getRenderableFromVisualIndex(o)+1;n.row=a.getFirstNotHiddenIndex(n.row,1),n.col=i.getFirstNotHiddenIndex(n.col,1),n.rowspan=Math.min(n.rowspan,w),n.colspan=Math.min(n.colspan,m)}Object(v.a)(e,n,t,o)}},{key:"onBeforeSetRangeStart",value:function(e){if(this.mergedCellsCollection.isFirstRenderableMergedCell(e.row,e.col)){var t=this.mergedCellsCollection.get(e.row,e.col),o=[t.row,t.col];e.row=o[0],e.col=o[1]}}},{key:"onBeforeSetRangeEnd",value:function(e){var t=this.hot.getSelectedRangeLast();t.highlight=new a.a(t.highlight.row,t.highlight.col),t.to=e;var o=!1;if(!this.hot.selection.isSelectedByColumnHeader()&&!this.hot.selection.isSelectedByRowHeader())do{o=!1;for(var r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1){var n=this.mergedCellsCollection.mergedCells[r].getRange();t.expandByRange(n)&&(e.row=t.to.row,e.col=t.to.col,o=!0)}}while(o)}},{key:"onAfterGetCellMeta",value:function(e,t,o){var r=this.mergedCellsCollection.get(e,t);r&&(r.row!==e||r.col!==t?o.copyable=!1:(o.rowspan=r.rowspan,o.colspan=r.colspan))}},{key:"onAfterViewportRowCalculatorOverride",value:function(e){var t=this.hot.countCols();this.modifyViewportRowStart(e,t),this.modifyViewportRowEnd(e,t)}},{key:"modifyViewportRowStart",value:function(e,t){for(var o=this.hot.rowIndexMapper,r=o.getVisualFromRenderableIndex(e.startRow),n=0;n<t;n+=1){var l=this.mergedCellsCollection.get(r,n);if(Object(g.isObject)(l)){var a=o.getRenderableFromVisualIndex(o.getFirstNotHiddenIndex(l.row,1));if(a<e.startRow)return e.startRow=a,void this.modifyViewportRowStart(e,t)}}}},{key:"modifyViewportRowEnd",value:function(e,t){for(var o=this.hot.rowIndexMapper,r=o.getVisualFromRenderableIndex(e.endRow),n=0;n<t;n+=1){var l=this.mergedCellsCollection.get(r,n);if(Object(g.isObject)(l)){var a=l.row+l.rowspan-1,i=o.getRenderableFromVisualIndex(o.getFirstNotHiddenIndex(a,-1));if(i>e.endRow)return e.endRow=i,void this.modifyViewportRowEnd(e,t)}}}},{key:"onAfterViewportColumnCalculatorOverride",value:function(e){var t=this.hot.countRows();this.modifyViewportColumnStart(e,t),this.modifyViewportColumnEnd(e,t)}},{key:"modifyViewportColumnStart",value:function(e,t){for(var o=this.hot.columnIndexMapper,r=o.getVisualFromRenderableIndex(e.startColumn),n=0;n<t;n+=1){var l=this.mergedCellsCollection.get(n,r);if(Object(g.isObject)(l)){var a=o.getRenderableFromVisualIndex(o.getFirstNotHiddenIndex(l.col,1));if(a<e.startColumn)return e.startColumn=a,void this.modifyViewportColumnStart(e,t)}}}},{key:"modifyViewportColumnEnd",value:function(e,t){for(var o=this.hot.columnIndexMapper,r=o.getVisualFromRenderableIndex(e.endColumn),n=0;n<t;n+=1){var l=this.mergedCellsCollection.get(n,r);if(Object(g.isObject)(l)){var a=l.col+l.colspan-1,i=o.getRenderableFromVisualIndex(o.getFirstNotHiddenIndex(a,-1));if(i>e.endColumn)return e.endColumn=i,void this.modifyViewportColumnEnd(e,t)}}}},{key:"translateMergedCellToRenderable",value:function(e,t,o,r){var n,l,a=this.hot,i=a.rowIndexMapper,c=a.columnIndexMapper;return n=0===t?i.getFirstNotHiddenIndex(e,1):i.getFirstNotHiddenIndex(e+t-1,-1),l=0===r?c.getFirstNotHiddenIndex(o,1):c.getFirstNotHiddenIndex(o+r-1,-1),[e>=0?i.getRenderableFromVisualIndex(n):e,o>=0?c.getRenderableFromVisualIndex(l):o]}},{key:"onModifyAutofillRange",value:function(e,t){this.autofillCalculations.correctSelectionAreaSize(t);var o=this.autofillCalculations.getDirection(t,e),r=e;if(this.autofillCalculations.dragAreaOverlapsCollections(t,r,o))return r=t;var n=this.mergedCellsCollection.getWithinRange({from:{row:t[0],col:t[1]},to:{row:t[2],col:t[3]}});return n?r=this.autofillCalculations.snapDragArea(t,r,o,n):r}},{key:"onAfterCreateCol",value:function(e,t){this.mergedCellsCollection.shiftCollections("right",e,t)}},{key:"onAfterRemoveCol",value:function(e,t){this.mergedCellsCollection.shiftCollections("left",e,t)}},{key:"onAfterCreateRow",value:function(e,t,o){"auto"!==o&&this.mergedCellsCollection.shiftCollections("down",e,t)}},{key:"onAfterRemoveRow",value:function(e,t){this.mergedCellsCollection.shiftCollections("up",e,t)}},{key:"onAfterChange",value:function(e,t){"Autofill.fill"===t&&this.autofillCalculations.recreateAfterDataPopulation(e)}},{key:"onBeforeDrawAreaBorders",value:function(e,t){if(t&&"area"===t){var o=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getWithinRange(o);Object(f.arrayEach)(r,(function(t){o.getBottomRightCorner().row===t.getLastRow()&&o.getBottomRightCorner().col===t.getLastColumn()&&(e[2]=t.row,e[3]=t.col)}))}}},{key:"onAfterModifyTransformStart",value:function(e,t,o){if(this.enabled){var r=this.mergedCellsCollection.get(e.row,e.col);if(r){var n=t>0,l=t<0,a=o<0,i=o>0,c=r.row+r.rowspan-1==this.hot.countRows()-1,s=0===r.row,u=r.col+r.colspan-1==this.hot.countCols()-1,h=0===r.col;(n&&c||l&&s||i&&u||a&&h)&&(e.row=r.row,e.col=r.col)}}}},{key:"onAfterDrawSelection",value:function(e,t,o,r){if(o)return this.selectionCalculations.getSelectedMergedCellClassName(e,t,o,r)}},{key:"onBeforeRemoveCellClassNames",value:function(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}}])&&R(t.prototype,o),r&&R(t,r),m}(r.a)}}]);