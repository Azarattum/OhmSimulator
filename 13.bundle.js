(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{126:function(e,t,n){"use strict";n.d(t,"b",(function(){return T})),n.d(t,"a",(function(){return U}));n(32),n(43),n(5),n(4),n(78),n(6),n(7),n(92),n(42),n(51),n(230),n(119),n(40),n(18),n(17),n(19),n(31),n(23),n(10),n(12),n(13),n(15),n(20),n(16),n(64),n(47),n(89);var o=n(49),i=n(67),r=n(35),a=n(14),s=n(9),u=n(164),l=n(321),h=n(209),c=n(77),f=n(44),d=n(21);function p(e){return function(e){if(Array.isArray(e))return S(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||b(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){A(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var o,i,r=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(o=n.next()).done)&&(r.push(o.value),!t||r.length!==t);a=!0);}catch(e){s=!0,i=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return r}(e,t)||b(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){if(e){if("string"==typeof e)return S(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?S(e,t):void 0}}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function C(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function O(e,t,n){return(O="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=E(e)););return e}(e,t);if(o){var i=Object.getOwnPropertyDescriptor(o,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function R(e,t){return(R=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=E(e);if(t){var i=E(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return j(this,n)}}function j(e,t){if(t&&("object"===v(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return k(e)}function k(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function E(e){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function A(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function D(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function I(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,x(e,t,"set"),n),n}function N(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,x(e,t,"get"))}function x(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var T="formulas";d.a.getSingleton().register("afterNamedExpressionAdded"),d.a.getSingleton().register("afterNamedExpressionRemoved"),d.a.getSingleton().register("afterSheetAdded"),d.a.getSingleton().register("afterSheetRemoved"),d.a.getSingleton().register("afterSheetRenamed"),d.a.getSingleton().register("afterFormulasValuesUpdate");var H=function(e){return"UndoRedo.undo"===e||"UndoRedo.redo"===e||"auto"===e},_=new WeakMap,B=new WeakMap,M=new WeakMap,U=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&R(e,t)}(g,e);var t,n,o,d=P(g);function g(){var e;w(this,g);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return D(k(e=d.call.apply(d,[this].concat(n))),_,{writable:!0,value:!1}),D(k(e),B,{writable:!0,value:!1}),D(k(e),M,{writable:!0,value:[["valuesUpdated",function(){var t;return(t=e).onEngineValuesUpdated.apply(t,arguments)}],["namedExpressionAdded",function(){var t;return(t=e).onEngineNamedExpressionsAdded.apply(t,arguments)}],["namedExpressionRemoved",function(){var t;return(t=e).onEngineNamedExpressionsRemoved.apply(t,arguments)}],["sheetAdded",function(){var t;return(t=e).onEngineSheetAdded.apply(t,arguments)}],["sheetRenamed",function(){var t;return(t=e).onEngineSheetRenamed.apply(t,arguments)}],["sheetRemoved",function(){var t;return(t=e).onEngineSheetRemoved.apply(t,arguments)}]]}),A(k(e),"staticRegister",Object(i.a)("formulas")),A(k(e),"engine",null),A(k(e),"sheetName",null),e}return t=g,o=[{key:"PLUGIN_KEY",get:function(){return T}},{key:"PLUGIN_PRIORITY",get:function(){return 260}}],(n=[{key:"sheetId",get:function(){return null===this.sheetName?null:this.engine.getSheetId(this.sheetName)}},{key:"isEnabled",value:function(){return!!this.hot.getSettings()[T]}},{key:"enablePlugin",value:function(){var e,t=this;if(!this.enabled)if(this.engine=null!==(e=Object(u.b)(this.hot))&&void 0!==e?e:this.engine,this.engine){if(null!==this.sheetName&&!this.engine.doesSheetExist(this.sheetName)){var n=this.addSheet(this.sheetName,this.hot.getSourceDataArray());!1!==n&&(this.sheetName=n)}this.addHook("beforeLoadData",(function(){return t.onBeforeLoadData.apply(t,arguments)})),this.addHook("afterLoadData",(function(){return t.onAfterLoadData.apply(t,arguments)})),this.addHook("modifyData",(function(){return t.onModifyData.apply(t,arguments)})),this.addHook("modifySourceData",(function(){return t.onModifySourceData.apply(t,arguments)})),this.addHook("beforeValidate",(function(){return t.onBeforeValidate.apply(t,arguments)})),this.addHook("afterSetSourceDataAtCell",(function(){return t.onAfterSetSourceDataAtCell.apply(t,arguments)})),this.addHook("afterSetDataAtCell",(function(){return t.onAfterSetDataAtCell.apply(t,arguments)})),this.addHook("afterSetDataAtRowProp",(function(){return t.onAfterSetDataAtCell.apply(t,arguments)})),this.addHook("beforeCreateRow",(function(){return t.onBeforeCreateRow.apply(t,arguments)})),this.addHook("beforeCreateCol",(function(){return t.onBeforeCreateCol.apply(t,arguments)})),this.addHook("afterCreateRow",(function(){return t.onAfterCreateRow.apply(t,arguments)})),this.addHook("afterCreateCol",(function(){return t.onAfterCreateCol.apply(t,arguments)})),this.addHook("beforeRemoveRow",(function(){return t.onBeforeRemoveRow.apply(t,arguments)})),this.addHook("beforeRemoveCol",(function(){return t.onBeforeRemoveCol.apply(t,arguments)})),this.addHook("afterRemoveRow",(function(){return t.onAfterRemoveRow.apply(t,arguments)})),this.addHook("afterRemoveCol",(function(){return t.onAfterRemoveCol.apply(t,arguments)})),this.addHook("beforeUndo",(function(e){"row_move"!==(null==e?void 0:e.actionType)&&t.engine.undo()})),this.addHook("beforeRedo",(function(e){"row_move"!==(null==e?void 0:e.actionType)&&t.engine.redo()})),this.addHook("afterDetachChild",(function(){return t.onAfterDetachChild.apply(t,arguments)})),this.addHook("beforeAutofill",(function(){return t.onBeforeAutofill.apply(t,arguments)})),N(this,M).forEach((function(e){var n=m(e,2),o=n[0],i=n[1];return t.engine.on(o,i)})),O(E(g.prototype),"enablePlugin",this).call(this)}else Object(r.b)("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.")}},{key:"disablePlugin",value:function(){var e=this;N(this,M).forEach((function(t){var n=m(t,2),o=n[0],i=n[1];return e.engine.off(o,i)})),Object(u.d)(this.engine,this.hot),this.engine=null,O(E(g.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(e){this.engine.updateConfig(Object(h.c)(this.hot.getSettings()));var t=this.hot.getSettings()[T];if(Object(s.isDefined)(t)&&Object(s.isDefined)(t.sheetName)&&t.sheetName!==this.sheetName&&this.switchSheet(t.sheetName),!e.data&&null===this.sheetName){var n=this.hot.getSettings()[T].sheetName;n&&this.engine.doesSheetExist(n)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(null!=n?n:void 0,this.hot.getSourceDataArray())}O(E(g.prototype),"updatePlugin",this).call(this,e)}},{key:"destroy",value:function(){var e=this;N(this,M).forEach((function(t){var n,o=m(t,2),i=o[0],r=o[1];return null===(n=e.engine)||void 0===n?void 0:n.off(i,r)})),I(this,M,null),Object(u.d)(this.engine,this.hot),this.engine=null,O(E(g.prototype),"destroy",this).call(this)}},{key:"getPhysicalIndexPosition",value:function(e,t,n,o,i){return!i&&e>=n?o+(e-n):t}},{key:"toPhysicalRowPosition",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPhysicalIndexPosition(e,this.hot.toPhysicalRow(e),this.hot.countRows(),this.hot.countSourceRows(),t)}},{key:"toPhysicalColumnPosition",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPhysicalIndexPosition(e,this.hot.toPhysicalColumn(e),this.hot.countCols(),this.hot.countSourceCols(),t)}},{key:"addSheet",value:function(e,t){if(Object(s.isDefined)(t)&&!Object(c.isArrayOfArrays)(t))return Object(r.b)("The provided data should be an array of arrays."),!1;if(null!=e&&this.engine.doesSheetExist(e))return Object(r.b)("Sheet with the provided name already exists."),!1;try{var n=this.engine.addSheet(null!=e?e:void 0);return t&&this.engine.setSheetContent(this.engine.getSheetId(n),t),n}catch(e){return Object(r.b)(e.message),!1}}},{key:"switchSheet",value:function(e){if(this.engine.doesSheetExist(e)){this.sheetName=e;var t=this.engine.getSheetSerialized(this.sheetId);t.length>0&&this.hot.loadData(t,"".concat(Object(f.toUpperCaseFirst)(T),".switchSheet"))}else Object(r.a)("The sheet named `".concat(e,"` does not exist, switch aborted."))}},{key:"getCellType",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId,o=this.hot.toPhysicalRow(e),i=this.hot.toPhysicalColumn(t);return null!==o&&null!==i?this.engine.getCellType({sheet:n,row:o,col:i}):"EMPTY"}},{key:"isFormulaCellType",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId,o=this.hot.toPhysicalRow(e),i=this.hot.toPhysicalColumn(t);return null!==o&&null!==i&&this.engine.doesCellHaveFormula({sheet:n,row:o,col:i})}},{key:"renderDependentSheets",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=new Set;e.forEach((function(e){var t,n=null==e||null===(t=e.address)||void 0===t?void 0:t.sheet;void 0!==n&&(o.has(n)||o.add(n))})),Object(u.a)(this.engine).forEach((function(e,i){var r;(n||i!==t.sheetId)&&o.has(i)&&(e.render(),null===(r=e.view)||void 0===r||r.adjustElementsSize())}))}},{key:"validateDependentCells",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=function(e){var t,n=null!==(t=null==e?void 0:e.address)&&void 0!==t?t:{},o=n.row,i=n.col,r=n.sheet;return Object(s.isDefined)(r)?"".concat(r,":").concat(o,"x").concat(i):""},i=new Set(n.map((function(e){return o(e)})));e.forEach((function(e){var n,r,a=null!==(n=e.address)&&void 0!==n?n:{},l=a.row,h=a.col,c=Object(s.isDefined)(l)?t.hot.toVisualRow(l):null,f=Object(s.isDefined)(h)?t.hot.toVisualColumn(h):null;if(null!==c&&null!==f){var d=null==e||null===(r=e.address)||void 0===r?void 0:r.sheet,p=o(e);if(void 0!==d&&!i.has(p)){var g=Object(u.a)(t.engine).get(d);g.validateCell(g.getDataAtCell(c,f),g.getCellMeta(c,f),(function(){}))}}}))}},{key:"syncChangeWithEngine",value:function(e,t,n){var o={row:this.toPhysicalRowPosition(e),col:this.toPhysicalColumnPosition(t),sheet:this.sheetId};if(this.engine.isItPossibleToSetCellContents(o))return this.engine.setCellContents(o,n);Object(r.b)("Not possible to set cell data at ".concat(JSON.stringify(o)))}},{key:"onBeforeValidate",value:function(e,t,n){var o=this.hot.propToCol(n);if(this.isFormulaCellType(t,o)){var i={row:this.hot.toPhysicalRow(t),col:this.hot.toPhysicalColumn(o),sheet:this.sheetId},r=this.engine.getCellValue(i);return"object"===v(r)&&null!==r?r.value:r}return e}},{key:"onBeforeAutofill",value:function(e,t,n){var o=this,i=function(e){return y(y({},e),{},{sheet:o.sheetId})},r={start:i(t.getTopLeftCorner()),end:i(t.getBottomRightCorner())},a={start:i(n.getTopLeftCorner()),end:i(n.getBottomRightCorner())};return!1!==this.engine.isItPossibleToSetCellContents(a)&&this.engine.getFillRangeData(r,a)}},{key:"onBeforeLoadData",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";n.includes(Object(f.toUpperCaseFirst)(T))||I(this,B,Object(s.isUndefined)(this.hot.getSettings().data))}},{key:"onAfterLoadData",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!n.includes(Object(f.toUpperCaseFirst)(T)))if(this.sheetName=Object(u.c)(this.engine,this.hot.getSettings()[T].sheetName),N(this,B))this.switchSheet(this.sheetName);else{var o=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,o)){I(this,_,!0);var i=this.engine.setSheetContent(this.sheetId,this.hot.getSourceDataArray());this.renderDependentSheets(i),I(this,_,!1)}}}},{key:"onModifyData",value:function(e,t,n,o){if("get"===o&&!N(this,_)&&null!==this.sheetName&&this.engine.doesSheetExist(this.sheetName)){var i=this.hot.toVisualRow(e);if(!this.isFormulaCellType(i,t)&&"ARRAY"!==this.getCellType(i,t))return void(Object(l.a)(n.value)&&(n.value=Object(l.b)(n.value)));var r={row:e,col:this.toPhysicalColumnPosition(t),sheet:this.sheetId},a=this.engine.getCellValue(r),s="object"===v(a)&&null!==a?a.value:a;n.value=s}}},{key:"onModifySourceData",value:function(e,t,n,o){if("get"===o&&!N(this,_)&&null!==this.sheetName&&this.engine.doesSheetExist(this.sheetName)){var i=this.hot.toVisualRow(e),r=this.hot.propToCol(t);if(!this.isFormulaCellType(i,r)&&"ARRAY"!==this.getCellType(i,r))return;var a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(0!==a.width||0!==a.height){var s={row:e,col:this.toPhysicalColumnPosition(r),sheet:this.sheetId};n.value=this.engine.getCellSerialized(s)}}}},{key:"onAfterSetDataAtCell",value:function(e,t){var n=this;if(!H(t)){var o=[],i=[],r=this.engine.batch((function(){e.forEach((function(e){var t=m(e,4),r=t[0],a=t[1],s=t[3],u=n.hot.propToCol(a),l=n.hot.toPhysicalRow(r),h=n.hot.toPhysicalColumn(u),c={row:l,col:h,sheet:n.sheetId};null!==l&&null!==h?n.syncChangeWithEngine(r,u,s):o.push([r,u,s]),i.push({address:c})}))}));o.length&&this.hot.addHookOnce("afterChange",(function(){var e=n.engine.batch((function(){o.forEach((function(e){var t=m(e,3),o=t[0],i=t[1],r=t[2];n.syncChangeWithEngine(o,i,r)}))}));n.renderDependentSheets(e,!0)})),this.renderDependentSheets(r),this.validateDependentCells(r,i)}}},{key:"onAfterSetSourceDataAtCell",value:function(e,t){var n=this;if(!H(t)){var o=[],i=[];e.forEach((function(e){var t=m(e,4),s=t[0],u=t[1],l=t[3],h=n.hot.propToCol(u);if(Object(a.isNumeric)(h)){var c={row:s,col:n.toPhysicalColumnPosition(h),sheet:n.sheetId};n.engine.isItPossibleToSetCellContents(c)?(i.push({address:c}),o.push.apply(o,p(n.engine.setCellContents(c,l)))):Object(r.b)("Not possible to set source cell data at ".concat(JSON.stringify(c)))}})),this.renderDependentSheets(o),this.validateDependentCells(o,i)}}},{key:"onBeforeCreateRow",value:function(e,t){if(null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[this.toPhysicalRowPosition(e),t]))return!1}},{key:"onBeforeCreateCol",value:function(e,t){if(null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[this.toPhysicalColumnPosition(e),t]))return!1}},{key:"onBeforeRemoveRow",value:function(e,t,n){var o=this;return!1!==n.every((function(e){return o.engine.isItPossibleToRemoveRows(o.sheetId,[e,1])}))&&void 0}},{key:"onBeforeRemoveCol",value:function(e,t,n){var o=this;return!1!==n.every((function(e){return o.engine.isItPossibleToRemoveColumns(o.sheetId,[e,1])}))&&void 0}},{key:"onAfterCreateRow",value:function(e,t,n){if(!H(n)){var o=this.engine.addRows(this.sheetId,[this.toPhysicalRowPosition(e),t]);this.renderDependentSheets(o)}}},{key:"onAfterCreateCol",value:function(e,t,n){if(!H(n)){var o=this.engine.addColumns(this.sheetId,[this.toPhysicalColumnPosition(e),t]);this.renderDependentSheets(o)}}},{key:"onAfterRemoveRow",value:function(e,t,n,o){var i=this;if(!H(o)){var r=n.sort().reverse(),a=this.engine.batch((function(){r.forEach((function(e){i.engine.removeRows(i.sheetId,[e,1])}))}));this.renderDependentSheets(a)}}},{key:"onAfterRemoveCol",value:function(e,t,n,o){var i=this;if(!H(o)){var r=n.sort().reverse(),a=this.engine.batch((function(){r.forEach((function(e){i.engine.removeColumns(i.sheetId,[e,1])}))}));this.renderDependentSheets(a)}}},{key:"onAfterDetachChild",value:function(e,t,n){var o,i=this;I(this,_,!0);var r=this.hot.getSourceDataArray(n,0,n+((null===(o=t.__children)||void 0===o?void 0:o.length)||0),this.hot.countSourceCols());I(this,_,!1),r.forEach((function(e,t){e.forEach((function(e,o){i.engine.setCellContents({col:o,row:n+t,sheet:i.sheetId},[[e]])}))}))}},{key:"onEngineValuesUpdated",value:function(e){this.hot.runHooks("afterFormulasValuesUpdate",e)}},{key:"onEngineNamedExpressionsAdded",value:function(e,t){this.hot.runHooks("afterNamedExpressionAdded",e,t)}},{key:"onEngineNamedExpressionsRemoved",value:function(e,t){this.hot.runHooks("afterNamedExpressionRemoved",e,t)}},{key:"onEngineSheetAdded",value:function(e){this.hot.runHooks("afterSheetAdded",e)}},{key:"onEngineSheetRenamed",value:function(e,t){this.hot.runHooks("afterSheetRenamed",e,t)}},{key:"onEngineSheetRemoved",value:function(e,t){this.hot.runHooks("afterSheetRemoved",e,t)}}])&&C(t.prototype,n),o&&C(t,o),g}(o.a)},164:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return f})),n.d(t,"d",(function(){return d})),n.d(t,"c",(function(){return p}));n(5),n(57),n(4),n(6),n(7),n(16),n(92),n(42),n(51),n(66),n(26),n(43),n(20),n(10),n(12),n(13);var o=n(67),i=n(9),r=n(35),a=n(126),s=n(209);function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(){var e=Object(o.a)(a.b);return e.hasItem("engine_relationship")||e.register("engine_relationship",new Map),e.getItem("engine_relationship")}function h(){var e=Object(o.a)(a.b);return e.hasItem("shared_engine_usage")||e.register("shared_engine_usage",new Map),e.getItem("shared_engine_usage")}function c(e){var t,n=e.getSettings(),o=n[a.b],c=null==o?void 0:o.engine;if(!0===o)return null;if(Object(i.isUndefined)(c))return null;if("function"==typeof c.hyperformula||"function"==typeof c)return function(e,t,n){var o=t[a.b],i=Object(s.b)(t),u=l(),c=h();(function(e,t){t&&t.forEach((function(t){var n=t.name,o=t.plugin,i=t.translations;try{e.registerFunction(n,o,i)}catch(e){Object(r.b)(e.message)}}))})(e,o.functions),function(e,t){if(t){var n=t.langCode;try{e.registerLanguage(n,t)}catch(e){Object(r.b)(e.message)}}}(e,o.language);var f=e.buildEmpty(i);return u.set(f,[n]),c.set(f,[n.guid]),function(e,t){t&&(e.suspendEvaluation(),t.forEach((function(t){var n=t.name,o=t.expression,i=t.scope,a=t.options;try{e.addNamedExpression(n,o,i,a)}catch(e){Object(r.b)(e.message)}})),e.resumeEvaluation())}(f,o.namedExpressions),f.on("sheetAdded",(function(){f.rebuildAndRecalculate()})),f.on("sheetRemoved",(function(){f.rebuildAndRecalculate()})),f}(null!==(t=c.hyperformula)&&void 0!==t?t:c,n,e);if("object"===u(c)&&Object(i.isUndefined)(c.hyperformula)){var f=l(),d=h().get(c);return f.has(c)||f.set(c,[]),f.get(c).push(e),d&&d.push(e.guid),c.getConfig().licenseKey||c.updateConfig({licenseKey:s.a}),c}return null}function f(e){var t,n=l(),o=0===n.size?[]:Array.from(null!==(t=n.get(e))&&void 0!==t?t:[]);return new Map(o.map((function(e){return[e.getPlugin("formulas").sheetId,e]})))}function d(e,t){if(e){var n=l(),o=n.get(e),i=h(),r=i.get(e);o&&o.includes(t)&&(o.splice(o.indexOf(t),1),0===o.length&&n.delete(e)),r&&r.includes(t.guid)&&(r.splice(r.indexOf(t.guid),1),0===r.length&&(i.delete(e),e.destroy()))}}function p(e,t){return!Object(i.isUndefined)(t)&&e.doesSheetExist(t)||(t=e.addSheet(t)),t}},209:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return f}));n(234),n(64),n(10),n(47),n(23),n(43),n(89);var o=n(126);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s="internal-use-in-handsontable",u={licenseKey:s,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!0,nullDate:{year:1899,month:12,day:31},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function l(e){var t,n;return{maxColumns:e.maxColumns,maxRows:e.maxRows,language:null===(t=e[o.b])||void 0===t||null===(n=t.language)||void 0===n?void 0:n.langCode}}function h(e){return Object.keys(e).reduce((function(t,n){return"hyperformula"!==n&&(t[n]=e[n]),t}),{})}function c(e){var t,n=e[o.b],i=h(null!=n&&null!==(t=n.engine)&&void 0!==t&&t.hyperformula?n.engine:{}),a=l(e);return r(r(r({},u),i),a)}function f(e){var t,n=e[o.b],i=h(null!=n&&null!==(t=n.engine)&&void 0!==t&&t.hyperformula?n.engine:{}),a=l(e);return r(r({},i),a)}},321:function(e,t,n){"use strict";function o(e){return"string"==typeof e&&"'"===e.charAt(0)&&"="===e.charAt(1)}function i(e){return o(e)?e.substr(1):e}n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}))}}]);