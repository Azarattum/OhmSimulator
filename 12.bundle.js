(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{107:function(e,t,n){"use strict";n(11),n(12),n(13),n(27),n(8),n(5),n(40),n(16),n(9),n(182),n(70),n(84),n(215),n(10);var a=n(62),r=n(1),o=n(2),i=n(53),s=n(42);function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e))&&"[object Arguments]"!==Object.prototype.toString.call(e))return;var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(r)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function l(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var c=/^\$?[A-Z]+\$?\d+$/,h=/\$?[A-Z]+\$?\d+/,f=/(?:[^0-9A-Z$: ]|^)\s*(\$?[A-Z]+\$?\d+)\s*(?![0-9A-Z_: ])/g,d=/\$?[A-Z]+\$?\d+\s*:\s*\$?[A-Z]+\$?\d+/g,y=/((?:[^0-9A-Z$: ]|^)\s*(\$?[A-Z]+\$?\d+)\s*(?![0-9A-Z_: ]))|(\$?[A-Z]+\$?\d+\s*:\s*\$?[A-Z]+\$?\d+)/g,g=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.expression="",this.cells=[],this.customModifier=null,"string"==typeof t&&this.setExpression(t)}var t,n,o;return t=e,(n=[{key:"setExpression",value:function(e){return this.cells.length=0,this.expression=Object(s.d)(e),this._extractCells(),this._extractCellsRange(),this}},{key:"useCustomModifier",value:function(e){this.customModifier=e}},{key:"translate",value:function(e){var t=this,n=e.row,a=e.column,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(r.arrayEach)(this.cells,(function(e){null!=n&&t._translateCell(e,"row",n,o.row),null!=a&&t._translateCell(e,"column",a,o.column)})),this}},{key:"toString",value:function(){var e=this,t=this.expression.replace(y,(function(t,n,r){var o=-1===t.indexOf(":"),i=t,s=t,u=null;o&&(s=c.test(n)?n:r);var l=e._searchCell(s);return l&&(u=l.refError?Object(a.error)(a.ERROR_REF):l.toLabel(),i=o?t.replace(s,u):u),i}));return t.startsWith("=")||(t="=".concat(t)),t}},{key:"_translateCell",value:function(e,t,n,a){var r=e.start,o=e.end,i=r[t].index,s=o[t].index,l=n,c=n,h=!1;if(this.customModifier){var f=u(this.customModifier(e,t,n,a),3);l=f[0],c=f[1],h=f[2]}else r[t].isAbsolute&&(l=0),o[t].isAbsolute&&(c=0);l&&!h&&(i+l<0&&(h=!0),r[t].index=Math.max(i+l,0)),c&&!h&&(s+c<0&&(h=!0),o[t].index=Math.max(s+c,0)),h&&(e.refError=!0)}},{key:"_extractCells",value:function(){var e=this,t=this.expression.match(f);t&&Object(r.arrayEach)(t,(function(t){var n=t.match(h);if(n){var r=u(Object(a.extractLabel)(n[0]),2),o=r[0],i=r[1];e.cells.push(e._createCell({row:o,column:i},{row:o,column:i},n[0]))}}))}},{key:"_extractCellsRange",value:function(){var e=this,t=this.expression.match(d);t&&Object(r.arrayEach)(t,(function(t){var n=u(t.split(":"),2),r=n[0],o=n[1],i=u(Object(a.extractLabel)(r),2),s=i[0],l=i[1],c=u(Object(a.extractLabel)(o),2),h={row:s,column:l},f={row:c[0],column:c[1]};e.cells.push(e._createCell(h,f,t))}))}},{key:"_searchCell",value:function(e){return u(Object(r.arrayFilter)(this.cells,(function(t){return t.origLabel===e})),1)[0]||null}},{key:"_createCell",value:function(e,t,n){return{start:e,end:t,origLabel:n,type:-1===n.indexOf(":")?"cell":"range",refError:!1,toLabel:function(){var e=Object(a.toLabel)(this.start.row,this.start.column);return"range"===this.type&&(e+=":".concat(Object(a.toLabel)(this.end.row,this.end.column))),e}}}}])&&l(t.prototype,n),o&&l(t,o),e}();Object(o.mixin)(g,i.a),t.a=g},243:function(e,t,n){"use strict";var a=n(62),r=n(2);function o(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var i=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var a=Object(r.isObject)(t),o=Object(r.isObject)(n);this._row=a?t.index:t,this.rowAbsolute=!a||t.isAbsolute,this._column=o?n.index:n,this.columnAbsolute=!o||n.isAbsolute,this.rowOffset=0,this.columnOffset=0,Object.defineProperty(this,"row",{get:function(){return this.rowOffset+this._row},set:function(e){this._row=e},enumerable:!0,configurable:!0}),Object.defineProperty(this,"column",{get:function(){return this.columnOffset+this._column},set:function(e){this._column=e},enumerable:!0,configurable:!0})}var t,n,i;return t=e,(n=[{key:"translateTo",value:function(e,t){this.row=this.row+e,this.column=this.column+t}},{key:"isEqual",value:function(e){return e.row===this.row&&e.column===this.column}},{key:"toString",value:function(){return Object(a.toLabel)({index:this.row,isAbsolute:this.rowAbsolute},{index:this.column,isAbsolute:this.columnAbsolute})}}])&&o(t.prototype,n),i&&o(t,i),e}();t.a=i},305:function(e,t,n){"use strict";n(11),n(12),n(13),n(8),n(17),n(18),n(5),n(9),n(10);var a=n(62);function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var c=function(e){function t(){return o(this,t),s(this,u(t).apply(this,arguments))}var n,r,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(t,e),n=t,(r=[{key:"toString",value:function(){return Object(a.toLabel)({index:this.row,isAbsolute:!1},{index:this.column,isAbsolute:!1})}}])&&i(n.prototype,r),c&&i(n,c),t}(n(243).a);t.a=c},306:function(e,t,n){"use strict";n.r(t),n.d(t,"OPERATION_NAME",(function(){return u})),n.d(t,"prepare",(function(){return l})),n.d(t,"operate",(function(){return c}));n(8),n(5),n(16),n(9),n(39),n(10);var a,r=n(1),o=n(42),i=n(57),s=n(107),u="column_sorting";function l(){var e=this.matrix,t=this.dataProvider;a=new WeakMap,Object(r.arrayEach)(e.data,(function(e){a.set(e,t.t.toVisualRow(e.row))}))}function c(){var e=this.matrix,t=this.dataProvider;e.cellReferences.length=0,Object(r.arrayEach)(e.data,(function(e){e.setState(i.a.STATE_OUT_OFF_DATE),e.clearPrecedents();var n=e.row,r=e.column,u=t.getSourceDataAtCell(n,r);if(Object(o.b)(u)){var l=a.get(e),c=new s.a(u);c.translate({row:t.t.toVisualRow(n)-l}),t.updateSourceData(n,r,c.toString())}})),a=null}},307:function(e,t,n){"use strict";n.r(t),n.d(t,"OPERATION_NAME",(function(){return s})),n.d(t,"operate",(function(){return u}));n(5),n(16);var a=n(1),r=n(42),o=n(57),i=n(107),s="insert_column";function u(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],s=this.matrix,u=this.dataProvider,c=[0,t];Object(a.arrayEach)(s.cellReferences,(function(t){t.column>=e&&t.translateTo.apply(t,c)})),Object(a.arrayEach)(s.data,(function(a){var s=a.row,h=a.column;if(a.column>=e&&(a.translateTo.apply(a,c),a.setState(o.a.STATE_OUT_OFF_DATE)),n){var f=a.row,d=a.column,y=u.getSourceDataAtCell(f,d);if(Object(r.b)(y)){var g=Object(r.a)("column",e),v=new i.a(y);v.useCustomModifier(l),v.translate({column:t},g({row:s,column:h})),u.updateSourceData(f,d,v.toString())}}}))}function l(e,t,n,a){var r=e.start,o=e.end,i=n,s=n;return a>r[t].index&&(i=0),a>o[t].index&&(s=0),[i,s,!1]}},308:function(e,t,n){"use strict";n.r(t),n.d(t,"OPERATION_NAME",(function(){return s})),n.d(t,"operate",(function(){return u}));n(5),n(16);var a=n(1),r=n(42),o=n(57),i=n(107),s="insert_row";function u(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],s=this.matrix,u=this.dataProvider,c=[t,0];Object(a.arrayEach)(s.cellReferences,(function(t){t.row>=e&&t.translateTo.apply(t,c)})),Object(a.arrayEach)(s.data,(function(a){var s=a.row,h=a.column;if(a.row>=e&&(a.translateTo.apply(a,c),a.setState(o.a.STATE_OUT_OFF_DATE)),n){var f=a.row,d=a.column,y=u.getSourceDataAtCell(f,d);if(Object(r.b)(y)){var g=Object(r.a)("row",e),v=new i.a(y);v.useCustomModifier(l),v.translate({row:t},g({row:s,column:h})),u.updateSourceData(f,d,v.toString())}}}))}function l(e,t,n,a){var r=e.start,o=e.end,i=n,s=n;return a>r[t].index&&(i=0),a>o[t].index&&(s=0),[i,s,!1]}},309:function(e,t,n){"use strict";n.r(t),n.d(t,"OPERATION_NAME",(function(){return s})),n.d(t,"operate",(function(){return u}));n(5),n(16);var a=n(1),r=n(42),o=n(57),i=n(107),s="remove_column";function u(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],s=-t,u=this.matrix,c=this.dataProvider,h=this.sheet,f=[0,s],d=Math.abs(s)-1,y=u.removeCellRefsAtRange({column:e},{column:e+d}),g=[];Object(a.arrayEach)(u.data,(function(t){Object(a.arrayEach)(y,(function(e){t.hasPrecedent(e)&&(t.removePrecedent(e),t.setState(o.a.STATE_OUT_OFF_DATE),Object(a.arrayEach)(h.getCellDependencies(t.row,t.column),(function(e){e.setState(o.a.STATE_OUT_OFF_DATE)})))})),t.column>=e&&t.column<=e+d&&g.push(t)})),u.remove(g),Object(a.arrayEach)(u.cellReferences,(function(t){t.column>=e&&t.translateTo.apply(t,f)})),Object(a.arrayEach)(u.data,(function(t){var a=t.row,u=t.column;if(t.column>=e&&(t.translateTo.apply(t,f),t.setState(o.a.STATE_OUT_OFF_DATE)),n){var h=t.row,d=t.column,y=c.getSourceDataAtCell(h,d);if(Object(r.b)(y)){var g=Object(r.a)("column",e),v=new i.a(y);v.useCustomModifier(l),v.translate({column:s},g({row:a,column:u})),c.updateSourceData(h,d,v.toString())}}}))}function l(e,t,n,a){var r=e.start,o=e.end,i=e.type,s=r[t].index,u=o[t].index,l=Math.abs(n)-1,c=n,h=n,f=!1;return s>=a&&u<=a+l&&(f=!0),f||"cell"!==i||a>=s&&(c=0,h=0),f||"range"!==i||(a>=s&&(c=0),a>u?h=0:u<=a+l&&(h-=Math.min(u-(a+l),0))),s+c<0&&(c-=s+c),[c,h,f]}},310:function(e,t,n){"use strict";n.r(t),n.d(t,"OPERATION_NAME",(function(){return s})),n.d(t,"operate",(function(){return u}));n(5),n(16);var a=n(1),r=n(42),o=n(57),i=n(107),s="remove_row";function u(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],s=-t,u=this.matrix,c=this.dataProvider,h=this.sheet,f=[s,0],d=Math.abs(s)-1,y=u.removeCellRefsAtRange({row:e},{row:e+d}),g=[];Object(a.arrayEach)(u.data,(function(t){Object(a.arrayEach)(y,(function(e){t.hasPrecedent(e)&&(t.removePrecedent(e),t.setState(o.a.STATE_OUT_OFF_DATE),Object(a.arrayEach)(h.getCellDependencies(t.row,t.column),(function(e){e.setState(o.a.STATE_OUT_OFF_DATE)})))})),t.row>=e&&t.row<=e+d&&g.push(t)})),u.remove(g),Object(a.arrayEach)(u.cellReferences,(function(t){t.row>=e&&t.translateTo.apply(t,f)})),Object(a.arrayEach)(u.data,(function(t){var a=t.row,u=t.column;if(t.row>=e&&(t.translateTo.apply(t,f),t.setState(o.a.STATE_OUT_OFF_DATE)),n){var h=t.row,d=t.column,y=c.getSourceDataAtCell(h,d);if(Object(r.b)(y)){var g=Object(r.a)("row",e),v=new i.a(y);v.useCustomModifier(l),v.translate({row:s},g({row:a,column:u})),c.updateSourceData(h,d,v.toString())}}}))}function l(e,t,n,a){var r=e.start,o=e.end,i=e.type,s=r[t].index,u=o[t].index,l=Math.abs(n)-1,c=n,h=n,f=!1;return s>=a&&u<=a+l&&(f=!0),f||"cell"!==i||a>=s&&(c=0,h=0),f||"range"!==i||(a>=s&&(c=0),a>u?h=0:u<=a+l&&(h-=Math.min(u-(a+l),0))),s+c<0&&(c-=s+c),[c,h,f]}},42:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return r})),n.d(t,"e",(function(){return o})),n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return s}));n(40),n(182),n(70);function a(e){return"string"==typeof e&&e.length>=2&&"="===e.charAt(0)}function r(e){return"string"==typeof e&&"'"===e.charAt(0)&&"="===e.charAt(1)}function o(e){return r(e)?e.substr(1):e}function i(e){var t=/(\\"|"(?:\\"|[^"])*"|(\+))|(\\'|'(?:\\'|[^'])*'|(\+))/g,n=e.match(t)||[],a=-1;return e.toUpperCase().replace(t,(function(){return n[a+=1]}))}function s(e,t){return function(n){return{row:"row"===e?t:n.row,column:"column"===e?t:n.column}}}},48:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r})),n.d(t,"g",(function(){return o})),n.d(t,"f",(function(){return i})),n.d(t,"h",(function(){return u})),n.d(t,"e",(function(){return l})),n.d(t,"c",(function(){return c})),n.d(t,"k",(function(){return h})),n.d(t,"j",(function(){return f})),n.d(t,"i",(function(){return d})),n.d(t,"d",(function(){return y}));n(33),n(86),n(5),n(16);var a=31,r=7;function o(e,t){return{name:e,days:r,daysBeforeFullWeeks:0,daysAfterFullWeeks:0,fullWeeks:1,index:t}}function i(e,t){var n=s(t[e].name),a=e>0?s(t[e-1].name):null,r=s(t[0].name),o=s(t[t.length-1].name);return e>0?"".concat(a,"/").concat(n):e===t.length-1?"".concat(n,"/").concat(r):"".concat(o,"/").concat(n)}function s(e){return e.substring(0,3)}function u(e){return d(Array.isArray(e)?e[1]:e.startDate)}function l(e){return d(Array.isArray(e)?e[2]:e.endDate)}function c(e){return Array.isArray(e)?e[3]:e.additionalData}function h(e,t){Array.isArray(e)?e[1]=t:e.startDate=t}function f(e,t){Array.isArray(e)?e[2]=t:e.endDate=t}function d(e){var t=e;return null===t?null:t instanceof Date||"Invalid Date"!==(t=new Date(t)).toString()?t:null}function y(e){var t=d(e);return t?t.getFullYear():null}},523:function(e,t,n){"use strict";n(11),n(12),n(13),n(8),n(30),n(17),n(18),n(5),n(31),n(16),n(9),n(10);var a=n(22),r=n(1),o=n(2),i=n(24),s=n(19),u=n(42),l=n(625),c=n(628),h=n(629);function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e))&&"[object Arguments]"!==Object.prototype.toString.call(e))return;var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(r)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function y(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v(e,t,n){return(v="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var a=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=p(e)););return e}(e,t);if(a){var r=Object.getOwnPropertyDescriptor(a,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var m=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,(n=!(r=p(t).call(this,e))||"object"!==f(r)&&"function"!=typeof r?g(a):r).eventManager=new i.a(g(n)),n.dataProvider=new c.a(n.hot),n.sheet=new l.a(n.hot,n.dataProvider),n.undoRedoSnapshot=new h.a(n.sheet),n._skipRendering=!1,n}var n,a,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}(t,e),n=t,(a=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().formulas}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var n=this.hot.getSettings().formulas;Object(o.isObject)(n)&&Object(o.isObject)(n.variables)&&Object(o.objectEach)(n.variables,(function(t,n){return e.setVariable(n,t)})),this.addHook("afterColumnSort",(function(){return e.onAfterColumnSort.apply(e,arguments)})),this.addHook("afterCreateCol",(function(){return e.onAfterCreateCol.apply(e,arguments)})),this.addHook("afterCreateRow",(function(){return e.onAfterCreateRow.apply(e,arguments)})),this.addHook("afterLoadData",(function(){return e.onAfterLoadData()})),this.addHook("afterRemoveCol",(function(){return e.onAfterRemoveCol.apply(e,arguments)})),this.addHook("afterRemoveRow",(function(){return e.onAfterRemoveRow.apply(e,arguments)})),this.addHook("afterSetDataAtCell",(function(){return e.onAfterSetDataAtCell.apply(e,arguments)})),this.addHook("afterSetDataAtRowProp",(function(){return e.onAfterSetDataAtCell.apply(e,arguments)})),this.addHook("beforeColumnSort",(function(){return e.onBeforeColumnSort.apply(e,arguments)})),this.addHook("beforeCreateCol",(function(){return e.onBeforeCreateCol.apply(e,arguments)})),this.addHook("beforeCreateRow",(function(){return e.onBeforeCreateRow.apply(e,arguments)})),this.addHook("beforeRemoveCol",(function(){return e.onBeforeRemoveCol.apply(e,arguments)})),this.addHook("beforeRemoveRow",(function(){return e.onBeforeRemoveRow.apply(e,arguments)})),this.addHook("beforeValidate",(function(){return e.onBeforeValidate.apply(e,arguments)})),this.addHook("beforeValueRender",(function(){return e.onBeforeValueRender.apply(e,arguments)})),this.addHook("modifyData",(function(){return e.onModifyData.apply(e,arguments)})),this.sheet.addLocalHook("afterRecalculate",(function(){return e.onSheetAfterRecalculate.apply(e,arguments)})),v(p(t.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){v(p(t.prototype),"disablePlugin",this).call(this)}},{key:"getCellValue",value:function(e,t){var n=this.sheet.getCellAt(e,t);return n?n.getError()||n.getValue():void 0}},{key:"hasComputedCellValue",value:function(e,t){return null!==this.sheet.getCellAt(e,t)}},{key:"recalculate",value:function(){this.sheet.recalculate()}},{key:"recalculateFull",value:function(){this.sheet.recalculateFull()}},{key:"recalculateOptimized",value:function(){this.sheet.recalculateOptimized()}},{key:"setVariable",value:function(e,t){this.sheet.setVariable(e,t)}},{key:"getVariable",value:function(e){return this.sheet.getVariable(e)}},{key:"onSheetAfterRecalculate",value:function(e){if(this._skipRendering)this._skipRendering=!1;else{var t=this.hot;Object(r.arrayEach)(e,(function(e){var n=e.row,a=e.column;t.validateCell(t.getDataAtCell(n,a),t.getCellMeta(n,a),(function(){}))})),t.render()}}},{key:"onModifyData",value:function(e,t,n,a){"get"===a&&this.hasComputedCellValue(e,t)?n.value=this.getCellValue(e,t):"set"===a&&Object(u.b)(n.value)&&(n.value=Object(u.d)(n.value))}},{key:"onBeforeValueRender",value:function(e){var t=e;return Object(u.c)(t)&&(t=Object(u.e)(t)),t}},{key:"onBeforeValidate",value:function(e,t,n){var a=this.hot.propToCol(n),r=e;return this.hasComputedCellValue(t,a)&&(r=this.getCellValue(t,a)),r}},{key:"onAfterSetDataAtCell",value:function(e,t){var n=this;"loadData"!==t&&(this.dataProvider.clearChanges(),Object(r.arrayEach)(e,(function(e){var t=d(e,4),a=t[0],r=t[1],o=t[2],i=t[3],s=n.hot.propToCol(r),l=n.t.toPhysicalRow(a),c=i;Object(u.b)(c)&&(c=Object(u.d)(c)),n.dataProvider.collectChanges(l,s,c),o!==c&&n.sheet.applyChanges(l,s,c)})),this.recalculate())}},{key:"onBeforeCreateRow",value:function(e,t,n){"UndoRedo.undo"===n&&this.undoRedoSnapshot.restore()}},{key:"onAfterCreateRow",value:function(e,t,n){this.sheet.alterManager.triggerAlter("insert_row",e,t,"UndoRedo.undo"!==n)}},{key:"onBeforeRemoveRow",value:function(e,t){this.undoRedoSnapshot.save("row",e,t)}},{key:"onAfterRemoveRow",value:function(e,t){this.sheet.alterManager.triggerAlter("remove_row",e,t)}},{key:"onBeforeCreateCol",value:function(e,t,n){"UndoRedo.undo"===n&&this.undoRedoSnapshot.restore()}},{key:"onAfterCreateCol",value:function(e,t,n){this.sheet.alterManager.triggerAlter("insert_column",e,t,"UndoRedo.undo"!==n)}},{key:"onBeforeRemoveCol",value:function(e,t){this.undoRedoSnapshot.save("column",e,t)}},{key:"onAfterRemoveCol",value:function(e,t){this.sheet.alterManager.triggerAlter("remove_column",e,t)}},{key:"onBeforeColumnSort",value:function(e,t){this.sheet.alterManager.prepareAlter("column_sorting",e,t)}},{key:"onAfterColumnSort",value:function(e,t){this.sheet.alterManager.triggerAlter("column_sorting",e,t)}},{key:"onAfterLoadData",value:function(){this._skipRendering=!0,this.recalculateFull()}},{key:"destroy",value:function(){this.dataProvider.destroy(),this.dataProvider=null,this.sheet.destroy(),this.sheet=null,v(p(t.prototype),"destroy",this).call(this)}}])&&y(n.prototype,a),s&&y(n,s),t}(a.a);Object(s.d)("formulas",m),t.a=m},524:function(e,t,n){"use strict";n(11),n(12),n(13),n(33),n(8),n(49),n(30),n(17),n(18),n(5),n(31),n(40),n(9),n(70),n(10);var a=n(22),r=n(0),o=n(2),i=n(41),s=n(93),u=n(19),l=n(48),c=n(631),h=n(632);function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function y(e,t){return!t||"object"!==f(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function g(e,t,n){return(g="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var a=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=v(e)););return e}(e,t);if(a){var r=Object.getOwnPropertyDescriptor(a,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var b=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=y(this,v(t).call(this,e))).settings={},n.dateCalculator=null,n.currentYear=null,n.monthList=[],n.monthHeadersArray=[],n.weekHeadersArray=[],n.rangeBars={},n.rangeList={},n.nestedHeadersPlugin=null,n.hotSource=null,n.overallWeekSectionCount=null,n.initialSettings=null,n.dataFeed=null,n.colorData={},n.rangeBarMeta=Object.create(null),n}var n,a,u;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(t,e),n=t,(a=[{key:"checkDependencies",value:function(){this.hot.getSettings().colHeaders||Object(i.b)("You need to enable the colHeaders property in your Gantt Chart Handsontable in order for it to work properly.")}},{key:"isEnabled",value:function(){return!!this.hot.getSettings().ganttChart}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.checkDependencies(),this.parseSettings(),this.currentYear=this.settings.startYear||(new Date).getFullYear(),this.dateCalculator=new c.a({year:this.currentYear,allowSplitWeeks:this.settings.allowSplitWeeks,hideDaysBeforeFullWeeks:this.settings.hideDaysBeforeFullWeeks,hideDaysAfterFullWeeks:this.settings.hideDaysAfterFullWeeks}),this.dateCalculator.setFirstWeekDay(this.settings.firstWeekDay),this.monthList=this.dateCalculator.getMonthList(),this.monthHeadersArray=this.generateMonthHeaders(),this.weekHeadersArray=this.generateWeekHeaders(),this.overallWeekSectionCount=this.dateCalculator.countWeekSections(),this.assignGanttSettings(),this.nestedHeadersPlugin&&(this.applyDataSource(),this.colorData&&this.setRangeBarColors(this.colorData)),this.addHook("afterInit",(function(){return e.onAfterInit()})),Object(r.addClass)(this.hot.rootElement,"ganttChart"),g(v(t.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.internalUpdateSettings||(this.dataFeed&&this.dataFeed.hotSource&&this.dataFeed.removeSourceHotHooks(this.dataFeed.hotSource),this.settings={},this.dataFeed={},this.currentYear=null,this.monthList=[],this.rangeBars={},this.rangeList={},this.rangeBarMeta={},this.hotSource=null,this.deassignGanttSettings(),Object(r.removeClass)(this.hot.rootElement,"ganttChart"),g(v(t.prototype),"disablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),g(v(t.prototype),"updatePlugin",this).call(this)}},{key:"parseSettings",value:function(){this.settings=this.hot.getSettings().ganttChart,"boolean"==typeof this.settings&&(this.settings={}),this.settings.firstWeekDay||(this.settings.firstWeekDay="monday"),void 0===this.settings.allowSplitWeeks&&(this.settings.allowSplitWeeks=!0),"function"!=typeof this.settings.weekHeaderGenerator&&(this.settings.weekHeaderGenerator=null)}},{key:"applyDataSource",value:function(){if(this.settings.dataSource){var e=this.settings.dataSource;e.instance?this.loadData(e.instance,e.startDateColumn,e.endDateColumn,e.additionalData,e.asyncUpdates):this.loadData(e)}}},{key:"loadData",value:function(e,t,n,a,r){this.dataFeed=new h.a(this.hot,e,t,n,a,r),this.hot.render()}},{key:"clearRangeBars",value:function(){this.rangeBars={}}},{key:"clearRangeList",value:function(){this.rangeList={}}},{key:"getRangeBarCoordinates",value:function(e){return this.rangeList[e]}},{key:"generateMonthHeaders",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentYear;return this.dateCalculator.generateHeaderSet("months",this.settings.weekHeaderGenerator,e)}},{key:"generateWeekHeaders",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentYear;return this.dateCalculator.generateHeaderSet("weeks",this.settings.weekHeaderGenerator,e)}},{key:"assignGanttSettings",value:function(){var e=this;this.initialSettings=Object(o.deepClone)(this.hot.getSettings());var t={data:Object(s.createEmptySpreadsheetData)(1,this.overallWeekSectionCount),readOnly:!0,renderer:function(t,n,a,r,o,i,s){return e.uniformBackgroundRenderer(t,n,a,r,o,i,s)},colWidths:60,hiddenColumns:!this.hot.getSettings().hiddenColumns||this.hot.getSettings().hiddenColumns,nestedHeaders:[this.monthHeadersArray.slice(),this.weekHeadersArray.slice()],collapsibleColumns:!this.hot.getSettings().collapsibleColumns||this.hot.getSettings().collapsibleColumns,columnSorting:!1,copyPaste:!1};this.internalUpdateSettings=!0,this.hot.updateSettings(t),this.internalUpdateSettings=void 0}},{key:"deassignGanttSettings",value:function(){this.internalUpdateSettings=!0,this.initialSettings&&this.hot.updateSettings(this.initialSettings),this.internalUpdateSettings=void 0}},{key:"cacheRangeBarMeta",value:function(e,t,n,a){this.rangeBarMeta[e]||(this.rangeBarMeta[e]={}),this.rangeBarMeta[e][t]||(this.rangeBarMeta[e][t]={}),this.rangeBarMeta[e][t][n]=a}},{key:"applyRangeBarMetaCache",value:function(){var e=this;Object(o.objectEach)(this.rangeBarMeta,(function(t,n){Object(o.objectEach)(t,(function(t,a){Object(o.objectEach)(t,(function(t,r){e.hot.setCellMeta(n,a,r,t)}))}))}))}},{key:"getAdjacentWeekColumn",value:function(e,t,n){var a=Object(l.i)(e),r=!0===n?-7:7,o=a.setDate(a.getDate()+r);return this.dateCalculator.dateToColumn(o)}},{key:"addRangeBar",value:function(e,t,n,a){var r=this;null!==t&&null!==n&&this.prepareDaysInColumnsInfo(Object(l.i)(t),Object(l.i)(n));var i=this.dateCalculator.dateToColumn(t),s=this.dateCalculator.dateToColumn(n),u=Object(l.d)(t),c=!1,h=!1;return null===i&&this.settings.hideDaysBeforeFullWeeks&&!1!==(i=this.getAdjacentWeekColumn(t,!0,!1))&&(c=!0),null===s&&this.settings.hideDaysAfterFullWeeks&&!1!==(s=this.getAdjacentWeekColumn(n,!1,!0))&&(h=!0),!(!this.dateCalculator.isValidRangeBarData(t,n)||!1===i||!1===s)&&(this.rangeBars[u]||(this.rangeBars[u]={}),this.rangeBars[u][e]||(this.rangeBars[u][e]={}),this.rangeBars[u][e][i]={barLength:s-i+1,partialStart:!c&&!this.dateCalculator.isOnTheEdgeOfWeek(t)[0],partialEnd:!h&&!this.dateCalculator.isOnTheEdgeOfWeek(n)[1],additionalData:{}},Object(o.objectEach)(a,(function(t,n){r.rangeBars[u][e][i].additionalData[n]=t})),u===this.dateCalculator.getYear()&&(this.colorData[e]&&(this.rangeBars[u][e][i].colors=this.colorData[e]),this.rangeList[e]=[e,i],this.renderRangeBar(e,i,s,a)),[e,i])}},{key:"prepareDaysInColumnsInfo",value:function(e,t){for(var n=e.getFullYear();n<=t.getFullYear();n++)void 0===this.dateCalculator.daysInColumns[n]&&(this.dateCalculator.calculateWeekStructure(n),this.dateCalculator.generateHeaderSet("weeks",null,n))}},{key:"getRangeBarData",value:function(e,t){var n=this.dateCalculator.getYear(),a=this.getRangeBarCoordinates(e);if(!a)return!1;var r=this.rangeBars[n][a[0]][a[1]];return!(!r||e!==a[0]||!(t===a[1]||t>a[1]&&t<a[1]+r.barLength))&&r}},{key:"updateRangeBarData",value:function(e,t,n){var a=this.getRangeBarData(e,t);Object(o.objectEach)(n,(function(e,t){a[t]!==e&&(a[t]=e)}))}},{key:"renderRangeBar",value:function(e,t,n){for(var a=this.dateCalculator.getYear(),r=this.rangeBars[a][e][t],o=t;o<=n;o++){var i=this.hot.getCellMeta(e,o),s="".concat(i.className||""," rangeBar");(o===t&&r.partialStart||o===n&&r.partialEnd)&&(s+=" partial"),o===n&&(s+=" last"),this.hot.setCellMeta(e,o,"originalClassName",i.className),this.hot.setCellMeta(e,o,"className",s),this.hot.setCellMeta(e,o,"additionalData",r.additionalData),this.cacheRangeBarMeta(e,o,"originalClassName",i.className),this.cacheRangeBarMeta(e,o,"className",s),this.cacheRangeBarMeta(e,o,"additionalData",r.additionalData)}}},{key:"removeRangeBarByDate",value:function(e,t){var n=this.dateCalculator.dateToColumn(t);this.removeRangeBarByColumn(e,n)}},{key:"removeRangeBarByColumn",value:function(e,t){var n=this,a=this.dateCalculator.getYear(),r=this.rangeBars[a][e][t];r&&(this.unrenderRangeBar(e,t,t+r.barLength-1),this.rangeBars[a][e][t]=null,Object(o.objectEach)(this.rangeList,(function(a,r){var o=parseInt(r,10);JSON.stringify(a)===JSON.stringify([e,t])&&(n.rangeList[o]=null)})))}},{key:"removeAllRangeBars",value:function(){var e=this;Object(o.objectEach)(this.rangeBars,(function(t,n){Object(o.objectEach)(t,(function(t,a){e.removeRangeBarByColumn(n,a)}))}))}},{key:"unrenderRangeBar",value:function(e,t,n){for(var a=t;a<=n;a++){var r=this.hot.getCellMeta(e,a);this.hot.setCellMeta(e,a,"className",r.originalClassName),this.hot.setCellMeta(e,a,"originalClassName",void 0),this.cacheRangeBarMeta(e,a,"className",r.originalClassName),this.cacheRangeBarMeta(e,a,"originalClassName",void 0)}this.hot.render()}},{key:"uniformBackgroundRenderer",value:function(e,t,n,a,r,i,s){var u=this.getRangeBarData(n,a),l=this.getRangeBarCoordinates(n);t.innerHTML="",s.className&&(t.className=s.className);var c="";Object(o.objectEach)(s.additionalData,(function(e,t){c+="".concat(t,": ").concat(e,"\n")})),c=c.replace(/\n$/,""),t.title=c,u&&u.colors?a===l[1]&&u.partialStart||a===l[1]+u.barLength-1&&u.partialEnd?t.style.background=u.colors[1]:t.style.background=u.colors[0]:t.style.background=""}},{key:"setRangeBarColors",value:function(e){var t=this;this.colorData=e,Object(o.objectEach)(e,(function(e,n){var a=t.getRangeBarCoordinates(n);a&&t.updateRangeBarData(a[0],a[1],{colors:e})})),this.hot.render()}},{key:"setYear",value:function(e){var t=Object(o.extend)(this.hot.getSettings().ganttChart,{startYear:e});this.hot.updateSettings({ganttChart:t})}},{key:"onAfterInit",value:function(){this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.applyDataSource()}},{key:"onUpdateSettings",value:function(){this.internalUpdateSettings?this.applyRangeBarMetaCache():g(v(t.prototype),"onUpdateSettings",this).call(this)}},{key:"destroy",value:function(){this.hotSource&&this.dataFeed.removeSourceHotHooks(this.hotSource),g(v(t.prototype),"destroy",this).call(this)}}])&&d(n.prototype,a),u&&d(n,u),t}(a.a);Object(u.d)("ganttChart",b),t.a=b},57:function(e,t,n){"use strict";n(11),n(12),n(13),n(27),n(8),n(17),n(18),n(5),n(9),n(10);var a=n(62),r=n(1),o=n(243);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function c(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),e}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f=[1,2,3],d=function(e){function t(e,n){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=s(this,u(t).call(this,e,n))).precedents=[],a.value=null,a.error=null,a.state=t.STATE_UP_TO_DATE,a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(t,e),c(t,null,[{key:"STATE_OUT_OFF_DATE",get:function(){return 1}},{key:"STATE_COMPUTING",get:function(){return 2}},{key:"STATE_UP_TO_DATE",get:function(){return 3}}]),c(t,[{key:"setValue",value:function(e){this.value=e}},{key:"getValue",value:function(){return this.value}},{key:"setError",value:function(e){this.error=e}},{key:"getError",value:function(){return this.error}},{key:"hasError",value:function(){return null!==this.error}},{key:"setState",value:function(e){if(-1===f.indexOf(e))throw Error("Unrecognized state: ".concat(e));this.state=e}},{key:"isState",value:function(e){return this.state===e}},{key:"addPrecedent",value:function(e){if(this.isEqual(e))throw Error(a.ERROR_REF);this.hasPrecedent(e)||this.precedents.push(e)}},{key:"removePrecedent",value:function(e){if(this.isEqual(e))throw Error(a.ERROR_REF);this.precedents=Object(r.arrayFilter)(this.precedents,(function(t){return!t.isEqual(e)}))}},{key:"clearPrecedents",value:function(){this.precedents.length=0}},{key:"getPrecedents",value:function(){return this.precedents}},{key:"hasPrecedents",value:function(){return this.precedents.length>0}},{key:"hasPrecedent",value:function(e){return Object(r.arrayFilter)(this.precedents,(function(t){return t.isEqual(e)})).length>0}}]),t}(o.a);t.a=d},625:function(e,t,n){"use strict";n(11),n(12),n(13),n(37),n(8),n(5),n(16),n(9),n(10);var a=n(62),r=n(1),o=n(53),i=n(91),s=n(2),u=n(57),l=n(305),c=n(42),h=n(626),f=n(627);function d(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function y(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var g=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hot=t,this.t=Object(i.a)(this.hot),this.dataProvider=n,this.parser=new a.Parser,this.matrix=new h.a(this.t),this.alterManager=new f.a(this),this._processingCell=null,this._state=3,this.parser.on("callCellValue",(function(){return r._onCallCellValue.apply(r,arguments)})),this.parser.on("callRangeValue",(function(){return r._onCallRangeValue.apply(r,arguments)})),this.alterManager.addLocalHook("afterAlter",(function(){return r._onAfterAlter.apply(r,arguments)}))}var t,n,o;return t=e,(n=[{key:"recalculate",value:function(){switch(this._state){case 3:this.recalculateFull();break;case 2:this.recalculateOptimized()}}},{key:"recalculateOptimized",value:function(){var e=this,t=this.matrix.getOutOfDateCells();Object(r.arrayEach)(t,(function(t){var n=e.dataProvider.getSourceDataAtCell(t.row,t.column);Object(c.b)(n)&&e.parseExpression(t,n.substr(1))})),this._state=1,this.runLocalHooks("afterRecalculate",t,"optimized")}},{key:"recalculateFull",value:function(){var e=this,t=this.dataProvider.getSourceDataByRange();this.matrix.reset(),Object(r.arrayEach)(t,(function(t,n){Object(r.arrayEach)(t,(function(t,a){Object(c.b)(t)&&e.parseExpression(new u.a(n,a),t.substr(1))}))})),this._state=1,this.runLocalHooks("afterRecalculate",t,"full")}},{key:"setVariable",value:function(e,t){this.parser.setVariable(e,t)}},{key:"getVariable",value:function(e){return this.parser.getVariable(e)}},{key:"applyChanges",value:function(e,t,n){this.matrix.remove({row:e,column:t}),Object(c.b)(n)&&this.parseExpression(new u.a(e,t),n.substr(1));var a=this.getCellDependencies.apply(this,d(this.t.toVisual(e,t)));Object(r.arrayEach)(a,(function(e){e.setState(u.a.STATE_OUT_OFF_DATE)})),this._state=2}},{key:"parseExpression",value:function(e,t){e.setState(u.a.STATE_COMPUTING),this._processingCell=e;var n=this.parser.parse(Object(c.d)(t)),a=n.error,r=n.result;Object(c.b)(r)?this.parseExpression(e,r.substr(1)):(e.setValue(r),e.setError(a),e.setState(u.a.STATE_UP_TO_DATE)),this.matrix.add(e),this._processingCell=null}},{key:"getCellAt",value:function(e,t){return this.matrix.getCellAt(e,t)}},{key:"getCellDependencies",value:function(e,t){return this.matrix.getDependencies({row:e,column:t})}},{key:"_onCallCellValue",value:function(e,t){var n=e.row,r=e.column,o=new l.a(n,r);if(!this.dataProvider.isInDataRange(o.row,o.column))throw Error(a.ERROR_REF);this.matrix.registerCellRef(o),this._processingCell.addPrecedent(o);var i=this.dataProvider.getRawDataAtCell(n.index,r.index);if(Object(a.error)(i)){var s=this.matrix.getCellAt(n.index,r.index);if(s&&s.hasError())throw Error(i)}if(Object(c.b)(i)){var u=this.parser.parse(i.substr(1)),h=u.error,f=u.result;if(h)throw Error(h);t(f)}else t(i)}},{key:"_onCallRangeValue",value:function(e,t,n){var o=this,i=e.row,s=e.column,u=t.row,h=t.column,f=this.dataProvider.getRawDataByRange(i.index,s.index,u.index,h.index);n(Object(r.arrayMap)(f,(function(e,t){return function(e,t){return Object(r.arrayMap)(e,(function(e,n){var r=i.index+t,u=s.index+n,h=new l.a(r,u);if(!o.dataProvider.isInDataRange(h.row,h.column))throw Error(a.ERROR_REF);o.matrix.registerCellRef(h),o._processingCell.addPrecedent(h);var f=e;if(Object(a.error)(f)){var d=o.matrix.getCellAt(h.row,h.column);if(d&&d.hasError())throw Error(f)}if(Object(c.b)(f)){var y=o.parser.parse(f.substr(1)),g=y.error,v=y.result;if(g)throw Error(g);f=v}return f}))}(e,t)})))}},{key:"_onAfterAlter",value:function(){this.recalculateOptimized()}},{key:"destroy",value:function(){this.hot=null,this.t=null,this.dataProvider.destroy(),this.dataProvider=null,this.alterManager.destroy(),this.alterManager=null,this.parser=null,this.matrix.reset(),this.matrix=null}}])&&y(t.prototype,n),o&&y(t,o),e}();Object(s.mixin)(g,o.a),t.a=g},626:function(e,t,n){"use strict";n(33),n(27);var a=n(1),r=n(57);function o(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.t=t,this.data=[],this.cellReferences=[]}var t,n,i;return t=e,(n=[{key:"getCellAt",value:function(e,t){var n=null;return Object(a.arrayEach)(this.data,(function(a){if(a.row===e&&a.column===t)return n=a,!1})),n}},{key:"getOutOfDateCells",value:function(){return Object(a.arrayFilter)(this.data,(function(e){return e.isState(r.a.STATE_OUT_OFF_DATE)}))}},{key:"add",value:function(e){Object(a.arrayFilter)(this.data,(function(t){return t.isEqual(e)})).length||this.data.push(e)}},{key:"remove",value:function(e){var t=Array.isArray(e);this.data=Object(a.arrayFilter)(this.data,(function(n){return!function(e,n){var r=!1;return t?Object(a.arrayEach)(n,(function(t){if(e.isEqual(t))return r=!0,!1})):r=e.isEqual(n),r}(n,e)}))}},{key:"getDependencies",value:function(e){var t=this,n=function(e){return Object(a.arrayReduce)(t.data,(function(t,n){return n.hasPrecedent(e)&&-1===t.indexOf(n)&&t.push(n),t}),[])};return function e(r){var o=n(r);return o.length&&Object(a.arrayEach)(o,(function(n){n.hasPrecedents()&&(o=o.concat(e(t.t.toVisual(n))))})),o}(e)}},{key:"registerCellRef",value:function(e){Object(a.arrayFilter)(this.cellReferences,(function(t){return t.isEqual(e)})).length||this.cellReferences.push(e)}},{key:"removeCellRefsAtRange",value:function(e,t){var n=e.row,r=e.column,o=t.row,i=t.column,s=[];return this.cellReferences=Object(a.arrayFilter)(this.cellReferences,(function(e){return!function(e){return void 0===n||e.row>=n&&e.row<=o}(e)||!function(e){return void 0===r||e.column>=r&&e.column<=i}(e)||(s.push(e),!1)})),s}},{key:"reset",value:function(){this.data.length=0,this.cellReferences.length=0}}])&&o(t.prototype,n),i&&o(t,i),e}();t.a=i},627:function(e,t,n){"use strict";n(33),n(8),n(101),n(5),n(9),n(10);var a=n(2),r=n(53),o=n(306),i=n(307),s=n(308),u=n(309),l=n(310);function c(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var h=new Map;y(o.OPERATION_NAME,o),y(i.OPERATION_NAME,i),y(s.OPERATION_NAME,s),y(u.OPERATION_NAME,u),y(l.OPERATION_NAME,l);var f=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sheet=t,this.hot=t.hot,this.dataProvider=t.dataProvider,this.matrix=t.matrix}var t,n,a;return t=e,(n=[{key:"prepareAlter",value:function(e){if(!h.has(e))throw Error('Alter operation "'.concat(e,'" not exist.'));for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];h.get(e).prepare.apply(this,n)}},{key:"triggerAlter",value:function(e){if(!h.has(e))throw Error('Alter operation "'.concat(e,'" not exist.'));for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];h.get(e).operate.apply(this,n),this.runLocalHooks.apply(this,["afterAlter"].concat(n))}},{key:"destroy",value:function(){this.sheet=null,this.hot=null,this.dataProvider=null,this.matrix=null}}])&&c(t.prototype,n),a&&c(t,a),e}();Object(a.mixin)(f,r.a),t.a=f;var d=function(){};function y(e,t){h.has(e)||h.set(e,{prepare:t.prepare||d,operate:t.operate||d})}},628:function(e,t,n){"use strict";n(11),n(12),n(13),n(33),n(37),n(8),n(5),n(16),n(9),n(10);var a=n(1),r=n(4),o=n(2),i=n(91);function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e))&&"[object Arguments]"!==Object.prototype.toString.call(e))return;var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(r)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function u(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function l(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var c=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hot=t,this.changes={},this.t=Object(i.a)(this.hot)}var t,n,c;return t=e,(n=[{key:"collectChanges",value:function(e,t,n){this.changes[this._coordId(e,t)]=n}},{key:"clearChanges",value:function(){this.changes={}}},{key:"isInDataRange",value:function(e,t){return e>=0&&e<this.hot.countRows()&&t>=0&&t<this.hot.countCols()}},{key:"getDataAtCell",value:function(e,t){var n=this._coordId.apply(this,u(this.t.toPhysical(e,t)));return Object(o.hasOwnProperty)(this.changes,n)?this.changes[n]:this.hot.getDataAtCell(e,t)}},{key:"getDataByRange",value:function(e,t,n,r){var i=this,s=this.hot.getData(e,t,n,r);return Object(a.arrayEach)(s,(function(n,r){Object(a.arrayEach)(n,(function(n,a){var l=i._coordId.apply(i,u(i.t.toPhysical(r+e,a+t)));Object(o.hasOwnProperty)(i.changes,l)&&(s[r][a]=i.changes[l])}))})),s}},{key:"getSourceDataAtCell",value:function(e,t){var n=this._coordId(e,t);return Object(o.hasOwnProperty)(this.changes,n)?this.changes[n]:this.hot.getSourceDataAtCell(e,t)}},{key:"getSourceDataByRange",value:function(e,t,n,a){return this.hot.getSourceDataArray(e,t,n,a)}},{key:"getRawDataAtCell",value:function(e,t){return this.getSourceDataAtCell.apply(this,u(this.t.toPhysical(e,t)))}},{key:"getRawDataByRange",value:function(e,t,n,a){var i=this,u=[];return Object(r.rangeEach)(e,n,(function(e){var n=[];Object(r.rangeEach)(t,a,(function(t){var a=s(i.t.toPhysical(e,t),2),r=a[0],u=a[1],l=i._coordId(r,u);Object(o.hasOwnProperty)(i.changes,l)?n.push(i.changes[l]):n.push(i.getSourceDataAtCell(r,u))})),u.push(n)})),u}},{key:"updateSourceData",value:function(e,t,n){this.hot.getSourceData()[e][this.hot.colToProp(t)]=n}},{key:"_coordId",value:function(e,t){return"".concat(e,":").concat(t)}},{key:"destroy",value:function(){this.hot=null,this.changes=null,this.t=null}}])&&l(t.prototype,n),c&&l(t,c),e}();t.a=c},629:function(e,t,n){"use strict";var a=n(1),r=n(630),o=n(57);function i(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sheet=t,this.stack=new r.a}var t,n,s;return t=e,(n=[{key:"save",value:function(e,t,n){var r=this.sheet,o=r.matrix,i=r.dataProvider,s=[];Object(a.arrayEach)(o.data,(function(a){var r=a.row,o=a.column;if(a[e]<t||a[e]>t+(n-1)){var u=i.getSourceDataAtCell(r,o);s.push({row:r,column:o,value:u})}})),this.stack.push({axis:e,index:t,amount:n,changes:s})}},{key:"restore",value:function(){var e=this.sheet,t=e.matrix,n=e.dataProvider,r=this.stack.pop(),i=r.axis,s=r.index,u=r.amount,l=r.changes;l&&Object(a.arrayEach)(l,(function(e){e[i]>s+(u-1)&&(e[i]-=u);var a=e.row,r=e.column,l=e.value;n.getSourceDataAtCell(a,r)!==l&&(n.updateSourceData(a,r,l),t.getCellAt(a,r).setState(o.a.STATE_OUT_OFF_DATE))}))}},{key:"destroy",value:function(){this.sheet=null,this.stack=null}}])&&i(t.prototype,n),s&&i(t,s),e}();t.a=s},631:function(e,t,n){"use strict";n(11),n(12),n(13),n(33),n(27),n(8),n(49),n(56),n(86),n(95),n(5),n(16),n(9),n(10);var a=n(1),r=n(2),o=n(41),i=n(48);function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e))&&"[object Arguments]"!==Object.prototype.toString.call(e))return;var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(r)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function u(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var l=function(){function e(t){var n=t.year,a=t.allowSplitWeeks,r=void 0===a||a,o=t.hideDaysBeforeFullWeeks,i=void 0!==o&&o,s=t.hideDaysAfterFullWeeks,u=void 0!==s&&s;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.year=n,this.firstWeekDay="monday",this.allowSplitWeeks=r,this.hideDaysBeforeFullWeeks=i,this.hideDaysAfterFullWeeks=u,this.weekSectionCount=0,this.monthListCache={},this.daysInColumns={},this.calculateWeekStructure()}var t,n,l;return t=e,(n=[{key:"setYear",value:function(e){this.year=e,this.monthListCache[e]=this.calculateMonthData(e),this.calculateWeekStructure(e)}},{key:"setFirstWeekDay",value:function(e){var t=e.toLowerCase();"monday"!==t&&"sunday"!==t&&Object(o.b)("First day of the week must be set to either Monday or Sunday"),this.firstWeekDay=t,this.calculateWeekStructure()}},{key:"countWeekSections",value:function(){return this.weekSectionCount}},{key:"getFirstWeekDay",value:function(){return this.firstWeekDay}},{key:"getYear",value:function(){return this.year}},{key:"getMonthList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.year;return this.monthListCache[e]||(this.monthListCache[e]=this.calculateMonthData(e)),this.monthListCache[e]}},{key:"getFullMonthList",value:function(){return this.monthListCache}},{key:"dateToColumn",value:function(e){var t=Object(i.i)(e);if(!t)return!1;var n=t.getMonth(),a=t.getDate()-1,r=t.getFullYear();return this.getWeekColumn(a,n,r)}},{key:"getWeekColumn",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.getYear(),o=null,i=this.getMonthCacheArray(t,n);return Object(a.arrayEach)(i,(function(t){if(Object(r.objectEach)(t,(function(t,n){if(t.indexOf(e+1)>-1)return o=parseInt(n,10),!1})),o)return!1})),o}},{key:"getMonthCacheArray",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getYear(),a=this.getMonthList(n),o=[];if(this.allowSplitWeeks)o.push(this.daysInColumns[n][e]);else{var i=-1;Object(r.objectEach)(this.daysInColumns[n],(function(r,s){var u=a[s];if(Object.keys(r).length>1&&(i+=1),i===e)return u.daysBeforeFullWeeks>0&&o.push(t.daysInColumns[n][parseInt(s,10)-1]),o.push(r),u.daysAfterFullWeeks>0&&o.push(t.daysInColumns[n][parseInt(s,10)+1]),!1}))}return o}},{key:"columnToDate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getYear(),n=null;Object(r.objectEach)(this.daysInColumns[t],(function(t,a){if(t[e])return n=a,!1}));var a=this.daysInColumns[t][n][e];if(1===a.length){var o=new Date(t,n,a[0]);return{start:o,end:o}}return{start:new Date(t,n,a[0]),end:new Date(t,n,a[a.length-1])}}},{key:"isOnTheEdgeOfWeek",value:function(e){var t=this,n=Object(i.i)(e);if(!n)return null;var o=n.getMonth(),s=n.getDate()-1,u=n.getFullYear(),l=this.getMonthCacheArray(o,u),c=!1;return Object(a.arrayEach)(l,(function(e){if(Object(r.objectEach)(e,(function(e){if(!t.allowSplitWeeks&&7!==e.length&&(0===s||s===new Date(n.getYear(),n.getMonth()+1,0).getDate()-1))return!0;var a=e.indexOf(s+1);return 0===a?(c=[1,0],!1):a===e.length-1?(c=[0,1],!1):void 0})),c)return!1})),c}},{key:"generateHeaderSet",value:function(e,t){var n=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.year,o=this.getMonthList(a),i=[];return Object(r.objectEach)(o,(function(r,o){var u=r.daysBeforeFullWeeks>0?1:0,l=r.daysAfterFullWeeks>0?1:0,c=n.hideDaysBeforeFullWeeks?0:u,h=n.hideDaysAfterFullWeeks?0:l,f=r.fullWeeks+(n.allowSplitWeeks?c+h:0),d=parseInt(o,10),y="";if("months"===e)i.push({label:r.name,colspan:f});else if("weeks"===e)for(var g=0;g<f;g++){var v=null,p=null;if(n.allowSplitWeeks||1!==r.fullWeeks){var b=s(n.getWeekColumnRange({monthObject:r,monthNumber:d,headerIndex:g,areDaysBeforeFullWeeksVisible:c,areDaysAfterFullWeeksVisible:h,headerCount:f,year:a}),2);v=b[0],p=b[1]}else{var m=s(n.getWeekColumnRange({monthObject:r,monthNumber:d,headerIndex:g,headerCount:f,areDaysBeforeFullWeeksVisible:c,areDaysAfterFullWeeksVisible:h,mixedMonth:!0,year:a}),2);v=m[0],p=m[1]}y=v===p?"".concat(v):"".concat(v," -  ").concat(p),i.push(t?t.call(n,v,p):y),n.addDaysToCache(d,i.length-1,v,p,a)}})),i}},{key:"getWeekColumnRange",value:function(e){var t=e.monthObject,n=e.monthNumber,a=e.headerIndex,r=e.headerCount,o=e.areDaysBeforeFullWeeksVisible,s=e.areDaysAfterFullWeeksVisible,u=e.mixedMonth,l=void 0!==u&&u,c=e.year,h=void 0===c?this.year:c,f=this.getMonthList(h),d=this.allowSplitWeeks,y=null,g=null;return l?0===n?(g=f[n+1].daysBeforeFullWeeks,y=i.a-(i.b-g)+1):n===f.length-1?(g=i.b-f[n-1].daysAfterFullWeeks,y=f[n-1].days-f[n-1].daysAfterFullWeeks+1):(g=f[n+1].daysBeforeFullWeeks,y=f[n-1].days-(i.b-g)+1):d&&o&&0===a?(y=a+1,g=t.daysBeforeFullWeeks):d&&s&&a===r-1?(y=t.days-t.daysAfterFullWeeks+1,g=t.days):(y=null,g=(y=d?t.daysBeforeFullWeeks+(a-o)*i.b+1:t.daysBeforeFullWeeks+a*i.b+1)+i.b-1),[y,g]}},{key:"addDaysToCache",value:function(e,t,n,a){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.getYear();if(this.daysInColumns[r]||(this.daysInColumns[r]={}),this.daysInColumns[r][e]||(this.daysInColumns[r][e]={}),this.daysInColumns[r][e][t]||(this.daysInColumns[r][e][t]=[]),n<=a)for(var o=n;o<=a;o++)this.daysInColumns[r][e][t].push(o);else{for(var i=e-1>=0?this.countMonthDays(e):31,s=n;s<=i;s++)this.daysInColumns[r][e][t].push(s);for(var u=1;u<=a;u++)this.daysInColumns[r][e][t].push(u)}}},{key:"isValidRangeBarData",value:function(e,t){var n=Object(i.i)(e),a=Object(i.i)(t);return n&&a&&n.getTime()<=a.getTime()}},{key:"calculateMonthData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.year;return[{name:"January",days:31},{name:"February",days:new Date(e,2,0).getDate()},{name:"March",days:31},{name:"April",days:30},{name:"May",days:31},{name:"June",days:30},{name:"July",days:31},{name:"August",days:31},{name:"September",days:30},{name:"October",days:31},{name:"November",days:30},{name:"December",days:31}].slice(0)}},{key:"countMonths",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getYear();return this.monthListCache[e].length}},{key:"countMonthDays",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getYear();return this.monthListCache[t][e-1].days}},{key:"countMonthFullWeeks",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getYear();return this.monthListCache[t][e-1].fullWeeks}},{key:"calculateWeekStructure",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getYear();this.monthListCache[t]=this.calculateMonthData(t);var n=this.getFirstWeekDay(),r=this.getMonthList(t),o=[],s=this.hideDaysBeforeFullWeeks?0:1,u=this.hideDaysAfterFullWeeks?0:1,l=0,c=0;"monday"===n&&(l=1),Object(a.arrayEach)(r,(function(n,a){var h=new Date(t,a,1).getDay(),f=0;if(n.daysBeforeFullWeeks=(7-h+l)%7,!e.allowSplitWeeks&&n.daysBeforeFullWeeks&&(o.push(Object(i.g)(Object(i.f)(a,r),a)),f+=1),n.fullWeeks=Math.floor((n.days-n.daysBeforeFullWeeks)/7),n.daysAfterFullWeeks=n.days-n.daysBeforeFullWeeks-7*n.fullWeeks,e.allowSplitWeeks){var d=s*(n.daysBeforeFullWeeks?1:0),y=u*(n.daysAfterFullWeeks?1:0);c+=n.fullWeeks+d+y}else a===r.length-1&&n.daysAfterFullWeeks&&(o.push(Object(i.g)(Object(i.f)(a,r),null)),f+=1),c+=n.fullWeeks+f})),Object(a.arrayEach)(o,(function(n,a){var r=n.index;delete n.index,e.addMixedMonth(null===r?r:a+r,n,t)})),t===this.getYear()&&(this.weekSectionCount=c)}},{key:"addMixedMonth",value:function(e,t,n){null===e?this.monthListCache[n].push(t):this.monthListCache[n].splice(e,0,t)}}])&&u(t.prototype,n),l&&u(t,l),e}();t.a=l},632:function(e,t,n){"use strict";n(33),n(5),n(16),n(58);var a=n(2),r=n(1),o=n(4),i=n(48);function s(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var u=function(){function e(t,n,a,r,o,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data=n,this.chartInstance=t,this.chartPlugin=this.chartInstance.getPlugin("ganttChart"),this.hotSource=null,this.sourceHooks={},this.ongoingAsync=!1,this.applyData(n,a,r,o,i||!1)}var t,n,u;return t=e,(n=[{key:"applyData",value:function(e,t,n,a,r){if("[object Array]"===Object.prototype.toString.call(e))e.length>1&&this.chartInstance.alter("insert_row",0,e.length-1,"".concat(this.pluginName,".loadData")),this.loadData(e);else if(e instanceof this.chartInstance.constructor){var o=e.countRows();o>1&&this.chartInstance.alter("insert_row",0,o-1,"".concat(this.pluginName,".loadData")),this.bindWithHotInstance(e,t,n,a,r)}}},{key:"bindWithHotInstance",value:function(e,t,n,a,r){this.hotSource={instance:e,startColumn:t,endColumn:n,additionalData:a,asyncUpdates:r},this.addSourceHotHooks(),this.asyncCall(this.updateFromSource)}},{key:"asyncCall",value:function(e){var t=this;this.hotSource.asyncUpdates?(this.asyncStart(),setTimeout((function(){e.call(t),t.asyncEnd()}),0)):e.call(this)}},{key:"asyncStart",value:function(){this.ongoingAsync=!0}},{key:"asyncEnd",value:function(){this.ongoingAsync=!1}},{key:"addSourceHotHooks",value:function(){var e=this;this.sourceHooks={afterLoadData:function(){return e.onAfterSourceLoadData()},afterChange:function(t){return e.onAfterSourceChange(t)},afterColumnSort:function(){return e.onAfterColumnSort()}},this.hotSource.instance.addHook("afterLoadData",this.sourceHooks.afterLoadData),this.hotSource.instance.addHook("afterChange",this.sourceHooks.afterChange),this.hotSource.instance.addHook("afterColumnSort",this.sourceHooks.afterColumnSort)}},{key:"removeSourceHotHooks",value:function(e){this.sourceHooks.afterLoadData&&e.instance.removeHook("afterLoadData",this.sourceHooks.afterLoadData),this.sourceHooks.afterChange&&e.instance.removeHook("afterChange",this.sourceHooks.afterChange),this.sourceHooks.afterColumnSort&&e.instance.removeHook("afterColumnSort",this.sourceHooks.afterColumnSort)}},{key:"getDataFromSource",value:function(e){var t,n={},r=this.hotSource,o=[];void 0===e?t=r.instance.getData(0,0,r.instance.countRows()-1,r.instance.countCols()-1):(t=[])[e]=r.instance.getDataAtRow(e);for(var i=function(e,i){n={};var s=t[e];if(null===s[r.startColumn]||""===s[r.startColumn])return"continue";Object(a.objectEach)(r.additionalData,(function(e,t){n[t]=s[e]})),o.push([e,s[r.startColumn],s[r.endColumn],n,e])},s=e||0,u=t.length;s<(e?e+1:u);s++)i(s);return o}},{key:"updateFromSource",value:function(e){var t=this.getDataFromSource(e);!e&&isNaN(e)&&(this.chartPlugin.clearRangeBars(),this.chartPlugin.clearRangeList()),this.loadData(t),this.chartInstance.render()}},{key:"loadData",value:function(e){var t=this,n=[];Object(r.arrayEach)(e,(function(e,a){e.row=a;var r=t.splitRangeIfNeeded(e);n=n.concat(r)})),Object(r.arrayEach)(n,(function(e){t.chartPlugin.addRangeBar(e.row,Object(i.h)(e),Object(i.e)(e),Object(i.c)(e)),delete e.row}))}},{key:"splitRangeIfNeeded",value:function(e){var t=[],n=new Date(Object(i.h)(e)),r=new Date(Object(i.e)(e));if("string"==typeof n||"string"==typeof r)return!1;var s=n.getFullYear(),u=r.getFullYear();return s===u?[e]:(Object(o.rangeEach)(s,u,(function(n){var r=Object(a.clone)(e);n!==s&&Object(i.k)(r,"01/01/".concat(n)),n!==u&&Object(i.j)(r,"12/31/".concat(n)),t.push(r)})),t)}},{key:"onAfterSourceChange",value:function(e){var t=this;this.asyncCall((function(){if(e){for(var n={},r=0,o=e.length;r<o;r++){var i=e[r],s=parseInt(i[0],10),u=parseInt(i[1],10);n[s]||(n[s]={}),n[s][u]=[i[2],i[3]]}Object(a.objectEach)(n,(function(e,n){var a=parseInt(n,10);t.chartPlugin.getRangeBarCoordinates(a)&&t.chartPlugin.removeRangeBarByColumn(a,t.chartPlugin.rangeList[a][1]),t.updateFromSource(n)}))}}))}},{key:"onAfterSourceLoadData",value:function(){var e=this;this.asyncCall((function(){e.chartPlugin.removeAllRangeBars(),e.updateFromSource()}))}},{key:"onAfterColumnSort",value:function(){var e=this;this.asyncCall((function(){e.chartPlugin.removeAllRangeBars(),e.updateFromSource()}))}}])&&s(t.prototype,n),u&&s(t,u),e}();t.a=u}}]);