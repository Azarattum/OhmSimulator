(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{145:function(t,e,n){"use strict";n.d(e,"a",(function(){return y})),n.d(e,"c",(function(){return f})),n.d(e,"b",(function(){return d}));var o=n(246),r=n(294),i=n(295),a=n(71),s=Object(a.a)("sorting.compareFunctionFactory"),u=s.register,l=s.getItem,c=s.hasItem,h=Object(a.a)("sorting.mainSortComparator"),f=h.register,d=h.getItem;function y(t){return c(t)?l(t):l(o.a)}u(r.a,r.b),u(i.a,i.b),u(o.a,o.b)},184:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"c",(function(){return a})),n.d(e,"b",(function(){return s})),n.d(e,"d",(function(){return u}));var o=n(592),r=n(145),i=0,a=-1,s=1;function u(t,e){for(var n=Object(r.b)(e),i=arguments.length,a=new Array(i>2?i-2:0),s=2;s<i;s++)a[s-2]=arguments[s];Object(o.a)(t,n.apply(void 0,a))}},226:function(t,e,n){"use strict";n(11),n(12),n(13),n(33),n(144),n(73),n(141),n(37),n(27),n(8),n(214),n(49),n(110),n(101),n(123),n(124),n(489),n(30),n(483),n(17),n(95),n(18),n(5),n(31),n(16),n(9),n(142),n(10),n(58);var o=n(0),r=n(14),i=n(2),a=n(1),s=n(4),u=n(22),l=n(19),c=n(20),h=n(107),f=n(589),d=n(77),y=n(293),p=n(590),g=n(591),m=n(28);function v(t){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function b(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function C(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function w(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?C(Object(n),!0).forEach((function(e){S(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function S(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function O(t,e){if(null==t)return{};var n,o,r=function(t,e){if(null==t)return{};var n,o,r={},i=Object.keys(t);for(o=0;o<i.length;o++)n=i[o],e.indexOf(n)>=0||(r[n]=t[n]);return r}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(o=0;o<i.length;o++)n=i[o],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function k(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function E(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function j(t,e,n){return(j="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=M(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function M(t){return(M=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function A(t,e){return(A=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Object(m.e)("columnSorting",g.a),c.a.getSingleton().register("beforeColumnSort"),c.a.getSingleton().register("afterColumnSort");var R=function(t){function e(t){var n,o,r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,(n=!(r=M(e).call(this,t))||"object"!==v(r)&&"function"!=typeof r?E(o):r).columnStatesManager=new f.a,n.rowsMapper=new p.a(E(n)),n.blockPluginTranslation=!0,n.columnMetaCache=new Map,n.pluginKey="columnSorting",n}var n,u,l;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&A(t,e)}(e,t),n=e,(u=[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[this.pluginKey]}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(Object(r.isUndefined)(this.hot.getSettings().observeChanges)&&this.enableObserveChangesPlugin(),this.addHook("afterTrimRow",(function(){return t.sortByPresetSortStates()})),this.addHook("afterUntrimRow",(function(){return t.sortByPresetSortStates()})),this.addHook("modifyRow",(function(e,n){return t.onModifyRow(e,n)})),this.addHook("unmodifyRow",(function(e,n){return t.onUnmodifyRow(e,n)})),this.addHook("afterGetColHeader",(function(e,n){return t.onAfterGetColHeader(e,n)})),this.addHook("beforeOnCellMouseDown",(function(e,n,o,r){return t.onBeforeOnCellMouseDown(e,n,o,r)})),this.addHook("afterOnCellMouseDown",(function(e,n){return t.onAfterOnCellMouseDown(e,n)})),this.addHook("afterCreateRow",(function(e,n){return t.onAfterCreateRow(e,n)})),this.addHook("afterRemoveRow",(function(e,n){return t.onAfterRemoveRow(e,n)})),this.addHook("afterInit",(function(){return t.loadOrSortBySettings()})),this.addHook("afterLoadData",(function(e){return t.onAfterLoadData(e)})),this.addHook("afterCreateCol",(function(){return t.onAfterCreateCol()})),this.addHook("afterRemoveCol",(function(){return t.onAfterRemoveCol()})),this.hot.view&&this.loadOrSortBySettings(),j(M(e.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var t=this,n=function(e,n){var o=Object(d.d)(n);!1!==Object(d.f)(e,n)&&null!==o&&t.updateHeaderClasses(o)};this.hot.addHook("afterGetColHeader",n),this.hot.addHookOnce("afterRender",(function(){t.hot.removeHook("afterGetColHeader",n)})),this.rowsMapper.clearMap(),j(M(e.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(t){var e=this,n=this.getSortConfig(),o=this.getNormalizedSortConfigs(t),r=this.areValidSortConfigs(o);if(!1!==this.hot.runHooks("beforeColumnSort",n,o,r)){if(r){var i=Object(a.arrayMap)(o,(function(t){return o=(n=t).column,r=O(n,["column"]),w({column:e.hot.toPhysicalColumn(o)},r);var n,o,r}));this.columnStatesManager.setSortStates(i),this.sortByPresetSortStates(),this.saveAllSortSettings(),this.hot.render(),this.hot.view.wt.draw(!0)}this.hot.runHooks("afterColumnSort",n,this.getSortConfig(),r)}}},{key:"clearSort",value:function(){this.sort([])}},{key:"isSorted",value:function(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}},{key:"getSortConfig",value:function(t){var e=this,n=function(t){var n=t.column,o=O(t,["column"]);return w({column:e.hot.toVisualColumn(n)},o)};if(Object(r.isDefined)(t)){var o=this.hot.toPhysicalColumn(t),i=this.columnStatesManager.getColumnSortState(o);return Object(r.isDefined)(i)?n(i):void 0}var s=this.columnStatesManager.getSortStates();return Object(a.arrayMap)(s,(function(t){return n(t)}))}},{key:"setSortConfig",value:function(t){var e=this,n=this.getNormalizedSortConfigs(t);if(this.areValidSortConfigs(n)){var o=Object(a.arrayMap)(n,(function(t){return o=(n=t).column,r=O(n,["column"]),w({column:e.hot.toPhysicalColumn(o)},r);var n,o,r}));this.columnStatesManager.setSortStates(o)}}},{key:"getNormalizedSortConfigs",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(t)?t.slice(0,1):[t].slice(0,1)}},{key:"areValidSortConfigs",value:function(t){if(!1===Array.isArray(t))return!1;var e=t.map((function(t){return t.column})),n=this.hot.countCols(),o=e.every((function(t){return t<=n&&t>=0}));return Object(d.c)(t)&&o}},{key:"saveAllSortSettings",value:function(){var t=this.columnStatesManager.getAllColumnsProperties();t.initialConfig=this.columnStatesManager.getSortStates(),this.hot.runHooks("persistentStateSave","columnSorting",t)}},{key:"getAllSavedSortSettings",value:function(){var t=this,e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);var n=e.value;return Object(r.isDefined)(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=Object(a.arrayMap)(n.initialConfig,(function(e){var n=e.column,o=O(e,["column"]);return w({column:t.hot.toVisualColumn(n)},o)}))),n}},{key:"getColumnNextConfig",value:function(t){var e=this.hot.toPhysicalColumn(t);if(this.columnStatesManager.isColumnSorted(e)){var n=this.getSortConfig(t),o=Object(d.e)(n.sortOrder);return Object(r.isDefined)(o)?(n.sortOrder=o,n):void 0}var i=this.hot.countCols();if(Number.isInteger(t)&&t>=0&&t<i)return{column:t,sortOrder:Object(d.e)()}}},{key:"getNextSortConfig",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"append",n=this.hot.toPhysicalColumn(t),o=this.columnStatesManager.getIndexOfColumnInSortQueue(n),i=this.columnStatesManager.isColumnSorted(n),a=this.getSortConfig(),s=this.getColumnNextConfig(t);if(i){if(Object(r.isUndefined)(s))return[].concat(b(a.slice(0,o)),b(a.slice(o+1)));if("append"===e)return[].concat(b(a.slice(0,o)),b(a.slice(o+1)),[s]);if("replace"===e)return[].concat(b(a.slice(0,o)),[s],b(a.slice(o+1)))}return Object(r.isDefined)(s)?a.concat(s):a}},{key:"setMergedPluginSettings",value:function(t){var e=this.hot.toPhysicalColumn(t),n=this.hot.getSettings()[this.pluginKey],o=this.columnStatesManager.getAllColumnsProperties(),r=this.hot.getCellMeta(0,t),i=Object.getPrototypeOf(r),a=Object.hasOwnProperty.call(i,this.pluginKey)?i[this.pluginKey]:{};this.columnMetaCache.set(e,Object.assign(o,n,a))}},{key:"getFirstCellSettings",value:function(t){var e=this.blockPluginTranslation;this.blockPluginTranslation=!0,(0===this.columnMetaCache.size||this.columnMetaCache.size<this.hot.countCols())&&this.rebuildColumnMetaCache();var n=this.hot.getCellMeta(0,t);this.blockPluginTranslation=e;var o=Object.create(n);return o[this.pluginKey]=this.columnMetaCache.get(this.hot.toPhysicalColumn(t)),o}},{key:"rebuildColumnMetaCache",value:function(){var t=this,e=this.hot.countCols();0===e?this.columnMetaCache.clear():Object(s.rangeEach)(e-1,(function(e){return t.setMergedPluginSettings(e)}))}},{key:"getNumberOfRowsToSort",value:function(t){var e=this.hot.getSettings();return e.maxRows<=t?e.maxRows:t-e.minSpareRows}},{key:"sortByPresetSortStates",value:function(){var t=this;if(this.columnStatesManager.isListOfSortedColumnsEmpty())this.rowsMapper.clearMap();else{var e=[],n=this.columnStatesManager.getSortedColumns(),o=this.hot.countRows();this.blockPluginTranslation=!0;for(var r=function(e){return Object(a.arrayMap)(n,(function(n){return t.hot.getDataAtCell(e,t.hot.toVisualColumn(n))}))},i=0;i<this.getNumberOfRowsToSort(o);i+=1)e.push([i].concat(r(i)));Object(m.f)(e,this.pluginKey,Object(a.arrayMap)(n,(function(e){return t.columnStatesManager.getSortOrderOfColumn(e)})),Object(a.arrayMap)(n,(function(e){return t.getFirstCellSettings(t.hot.toVisualColumn(e))})));for(var s=e.length;s<o;s+=1)e.push([s].concat(r(s)));this.blockPluginTranslation=!1,this.rowsMapper._arrayMap=Object(a.arrayMap)(e,(function(t){return t[0]}))}}},{key:"loadOrSortBySettings",value:function(){this.columnMetaCache.clear();var t=this.getAllSavedSortSettings();if(Object(i.isObject)(t))this.sortBySettings(t);else{var e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}},{key:"sortBySettings",value:function(t){if(Object(i.isObject)(t)){this.columnStatesManager.updateAllColumnsProperties(t);var e=t.initialConfig;(Array.isArray(e)||Object(i.isObject)(e))&&this.sort(e)}else this.hot.render()}},{key:"enableObserveChangesPlugin",value:function(){var t=this;this.hot._registerTimeout(setTimeout((function(){t.hot.updateSettings({observeChanges:!0})}),0))}},{key:"onModifyRow",value:function(t,e){if(!1===this.blockPluginTranslation&&e!==this.pluginName&&this.isSorted()){var n=this.rowsMapper.getValueByIndex(t);t=null===n?t:n}return t}},{key:"onUnmodifyRow",value:function(t,e){return!1===this.blockPluginTranslation&&e!==this.pluginName&&this.isSorted()&&(t=this.rowsMapper.getIndexByValue(t)),t}},{key:"onAfterGetColHeader",value:function(t,e){var n=Object(d.d)(e);if(!1!==Object(d.f)(t,e)&&null!==n){var o=this.hot.toPhysicalColumn(t),r=this.getFirstCellSettings(t)[this.pluginKey],i=r.indicator,a=r.headerAction;this.updateHeaderClasses(n,this.columnStatesManager,o,i,a)}}},{key:"updateHeaderClasses",value:function(t){if(Object(o.removeClass)(t,Object(y.a)(t)),!1!==this.enabled){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];Object(o.addClass)(t,y.b.apply(void 0,n))}}},{key:"onUpdateSettings",value:function(t){j(M(e.prototype),"onUpdateSettings",this).call(this),this.columnMetaCache.clear(),Object(r.isDefined)(t[this.pluginKey])&&this.sortBySettings(t[this.pluginKey])}},{key:"onAfterLoadData",value:function(t){this.rowsMapper.clearMap(),this.columnMetaCache.clear(),!0===t&&this.hot.view&&this.loadOrSortBySettings()}},{key:"onAfterCreateRow",value:function(t,e){this.rowsMapper.shiftItems(t,e)}},{key:"onAfterRemoveRow",value:function(t,e){this.rowsMapper.unshiftItems(t,e)}},{key:"onAfterCreateCol",value:function(){this.columnMetaCache.clear()}},{key:"onAfterRemoveCol",value:function(){this.columnMetaCache.clear()}},{key:"wasClickableHeaderClicked",value:function(t,e){return this.getFirstCellSettings(e)[this.pluginKey].headerAction&&"SPAN"===t.realTarget.nodeName}},{key:"onBeforeOnCellMouseDown",value:function(t,e,n,o){!1!==Object(d.g)(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)&&Object(h.a)()&&(o.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(t,e){!1!==Object(d.g)(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)&&(Object(h.a)()&&(this.hot.deselectCell(),this.hot.selectColumns(e.col)),this.sort(this.getColumnNextConfig(e.col)))}},{key:"destroy",value:function(){this.rowsMapper.destroy(),this.columnStatesManager.destroy(),j(M(e.prototype),"destroy",this).call(this)}}])&&k(n.prototype,u),l&&k(n,l),e}(u.a);Object(l.d)("columnSorting",R),e.a=R},246:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return a}));var o=n(14),r=n(28);function i(t,e,n){return function(e,i){var a=n.sortEmptyCells;return"string"==typeof e&&(e=e.toLowerCase()),"string"==typeof i&&(i=i.toLowerCase()),e===i?r.a:Object(o.isEmpty)(e)?Object(o.isEmpty)(i)?r.a:a&&"asc"===t?r.c:r.b:Object(o.isEmpty)(i)?a&&"asc"===t?r.b:r.c:isNaN(e)&&!isNaN(i)?"asc"===t?r.b:r.c:!isNaN(e)&&isNaN(i)?"asc"===t?r.c:r.b:(isNaN(e)||isNaN(i)||(e=parseFloat(e),i=parseFloat(i)),e<i?"asc"===t?r.c:r.b:e>i?"asc"===t?r.b:r.c:r.a)}}var a="default"},28:function(t,e,n){"use strict";var o=n(145);n.d(e,"e",(function(){return o.c})),n.d(e,"d",(function(){return o.a}));var r=n(184);n.d(e,"b",(function(){return r.b})),n.d(e,"c",(function(){return r.c})),n.d(e,"a",(function(){return r.a})),n.d(e,"f",(function(){return r.d}))},293:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return a}));n(33),n(37),n(8),n(101),n(5),n(9),n(10);var o=n(77),r=new Map([[o.a,"ascending"],[o.b,"descending"]]);function i(t,e,n,o){var i=["columnSorting"];if(o&&i.push("sortAction"),!1===n)i.push("indicatorDisabled");else if(t.isColumnSorted(e)){var a=t.getSortOrderOfColumn(e);i.push(r.get(a))}return i}function a(){return Array.from(r.values()).concat("sortAction","indicatorDisabled","columnSorting")}},294:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return a}));var o=n(14),r=n(28);function i(t,e,n){return function(e,i){var a=parseFloat(e),s=parseFloat(i),u=n.sortEmptyCells;if(a===s||isNaN(a)&&isNaN(s))return r.a;if(u){if(Object(o.isEmpty)(e))return"asc"===t?r.c:r.b;if(Object(o.isEmpty)(i))return"asc"===t?r.b:r.c}return isNaN(a)?r.b:isNaN(s)?r.c:a<s?"asc"===t?r.c:r.b:a>s?"asc"===t?r.b:r.c:r.a}}var a="numeric"},295:function(t,e,n){"use strict";n.d(e,"b",(function(){return s})),n.d(e,"a",(function(){return u}));var o=n(6),r=n.n(o),i=n(14),a=n(28);function s(t,e,n){return function(o,s){var u=n.sortEmptyCells;if(o===s)return a.a;if(Object(i.isEmpty)(o))return Object(i.isEmpty)(s)?a.a:u&&"asc"===t?a.c:a.b;if(Object(i.isEmpty)(s))return u&&"asc"===t?a.b:a.c;var l=e.dateFormat,c=r()(o,l),h=r()(s,l);return c.isValid()?h.isValid()?h.isAfter(c)?"asc"===t?a.c:a.b:h.isBefore(c)?"asc"===t?a.b:a.c:a.a:a.c:a.b}}var u="date"},297:function(t,e,n){"use strict";var o=n(4),r=n(51),i=n(614);function a(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function s(t,e,n){return e&&a(t.prototype,e),n&&a(t,n),t}var u=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.strategy=null}return s(t,null,[{key:"DEFAULT_STRATEGY",get:function(){return"loose"}}]),s(t,[{key:"setStrategy",value:function(t){var e=i[Object(r.toUpperCaseFirst)(t)];if(!e)throw new Error('Bind strategy "'.concat(t,'" does not exist.'));this.strategy=new e}},{key:"createMap",value:function(t){var e=this.strategy,n=void 0===t?e._arrayMap.length:t;e._arrayMap.length=0,Object(o.rangeEach)(n-1,(function(t){e._arrayMap.push(t)}))}},{key:"createRow",value:function(){var t;(t=this.strategy).createRow.apply(t,arguments)}},{key:"removeRow",value:function(){var t;(t=this.strategy).removeRow.apply(t,arguments)}},{key:"translate",value:function(){var t;return(t=this.strategy).getValueByIndex.apply(t,arguments)}},{key:"clearMap",value:function(){this.strategy.clearMap()}},{key:"destroy",value:function(){this.strategy&&this.strategy.destroy(),this.strategy=null}}]),t}();e.a=u},490:function(t,e,n){"use strict";n(11),n(12),n(13),n(8),n(30),n(17),n(18),n(5),n(31),n(9),n(39),n(10),n(58);var o=n(0),r=n(2),i=n(24),a=n(7),s=n(19),u=n(22),l=n(593),c=n(23),h=n(594),f=n(3);function d(t){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function y(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function p(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function g(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function m(t,e,n){return(m="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=v(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function v(t){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function b(t,e){return(b=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var C=new WeakMap,w=function(t){function e(t){var n,o,r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,(n=!(r=v(e).call(this,t))||"object"!==d(r)&&"function"!=typeof r?g(o):r).editor=null,n.displaySwitch=null,n.eventManager=null,n.range={},n.mouseDown=!1,n.contextMenuEvent=!1,n.timer=null,C.set(g(n),{tempEditorDimensions:{},cellBelowCursor:null}),n}var n,s,u;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&b(t,e)}(e,t),n=e,(s=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().comments}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.editor||(this.editor=new l.a(this.hot.rootDocument)),this.eventManager||(this.eventManager=new i.a(this)),this.displaySwitch||(this.displaySwitch=new h.a(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",(function(e){return t.addToContextMenu(e)})),this.addHook("afterRenderer",(function(e,n,o,r,i,a){return t.onAfterRenderer(e,a)})),this.addHook("afterScrollHorizontally",(function(){return t.hide()})),this.addHook("afterScrollVertically",(function(){return t.hide()})),this.addHook("afterBeginEditing",(function(){return t.onAfterBeginEditing()})),this.displaySwitch.addLocalHook("hide",(function(){return t.hide()})),this.displaySwitch.addLocalHook("show",(function(e,n){return t.showAtCell(e,n)})),this.registerListeners(),m(v(e.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),m(v(e.prototype),"updatePlugin",this).call(this),this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}},{key:"disablePlugin",value:function(){m(v(e.prototype),"disablePlugin",this).call(this)}},{key:"registerListeners",value:function(){var t=this,e=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseover",(function(e){return t.onMouseOver(e)})),this.eventManager.addEventListener(e,"mousedown",(function(e){return t.onMouseDown(e)})),this.eventManager.addEventListener(e,"mouseup",(function(){return t.onMouseUp()})),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",(function(){return t.onEditorBlur()})),this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",(function(e){return t.onEditorMouseDown(e)})),this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",(function(e){return t.onEditorMouseUp(e)}))}},{key:"setRange",value:function(t){this.range=t}},{key:"clearRange",value:function(){this.range={}}},{key:"targetIsCellWithComment",value:function(t){var e=Object(o.closest)(t.target,"TD","TBODY");return!!(e&&Object(o.hasClass)(e,"htCommentCell")&&Object(o.closest)(e,[this.hot.rootElement]))}},{key:"targetIsCommentTextArea",value:function(t){return this.editor.getInputElement()===t.target}},{key:"setComment",value:function(t){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var e=this.editor.getValue(),n="";null!=t?n=t:null!=e&&(n=e);var o=this.range.from.row,r=this.range.from.col;this.updateCommentMeta(o,r,y({},"value",n)),this.hot.render()}},{key:"setCommentAtCell",value:function(t,e,n){this.setRange({from:new a.a(t,e)}),this.setComment(n)}},{key:"removeComment",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,"comment",void 0),t&&this.hot.render(),this.hide()}},{key:"removeCommentAtCell",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.setRange({from:new a.a(t,e)}),this.removeComment(n)}},{key:"getComment",value:function(){var t=this.range.from.row,e=this.range.from.col;return this.getCommentMeta(t,e,"value")}},{key:"getCommentAtCell",value:function(t,e){return this.getCommentMeta(t,e,"value")}},{key:"show",value:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var t=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.refreshEditor(!0),this.editor.setValue(t.comment?t.comment.value:""),this.editor.hidden&&this.editor.show(),!0}},{key:"showAtCell",value:function(t,e){return this.setRange({from:new a.a(t,e)}),this.show()}},{key:"hide",value:function(){this.editor.hidden||this.editor.hide()}},{key:"refreshEditor",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(t||this.range.from&&this.editor.isVisible()){var e=this.hot.rootWindow,n=this.hot.view.wt,r=n.wtTable,i=n.wtOverlays,a=n.wtViewport,s=i.scrollableElement,u=r.getCell(this.range.from),l=this.range.from.row,c=this.range.from.col,h=Object(o.offset)(u),f=r.getStretchedColumnWidth(c),d=h.top<0?0:h.top,y=h.left;a.hasVerticalScroll()&&s!==e&&(d-=i.topOverlay.getScrollPosition()),a.hasHorizontalScroll()&&s!==e&&(y-=i.leftOverlay.getScrollPosition());var p=y+f,g=d,m=this.getCommentMeta(l,c,"style"),v=this.getCommentMeta(l,c,"readOnly");m?this.editor.setSize(m.width,m.height):this.editor.resetSize(),this.editor.setReadOnlyState(v),this.editor.setPosition(p,g)}}},{key:"checkSelectionCommentsConsistency",value:function(){var t=this.hot.getSelectedRangeLast();if(!t)return!1;var e=!1,n=t.from;return this.getCommentMeta(n.row,n.col,"value")&&(e=!0),e}},{key:"updateCommentMeta",value:function(t,e,n){var o,i=this.hot.getCellMeta(t,e).comment;i?(o=Object(r.deepClone)(i),Object(r.deepExtend)(o,n)):o=n,this.hot.setCellMeta(t,e,"comment",o)}},{key:"getCommentMeta",value:function(t,e,n){var o=this.hot.getCellMeta(t,e);if(o.comment)return o.comment[n]}},{key:"onMouseDown",value:function(t){if(this.mouseDown=!0,this.hot.view&&this.hot.view.wt){if(!this.contextMenuEvent&&!this.targetIsCommentTextArea(t)){var e=Object(o.closest)(t.target,"TD","TBODY"),n=null;e&&(n=this.hot.view.wt.wtTable.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}this.contextMenuEvent=!1}}},{key:"onMouseOver",value:function(t){var e=C.get(this),n=this.hot.rootDocument;if(e.cellBelowCursor=n.elementFromPoint(t.clientX,t.clientY),!(this.mouseDown||this.editor.isFocused()||Object(o.hasClass)(t.target,"wtBorder")||e.cellBelowCursor!==t.target)&&this.editor)if(this.targetIsCellWithComment(t)){var r=this.hot.view.wt.wtTable.getCoords(t.target),i={from:new a.a(r.row,r.col)};this.displaySwitch.show(i)}else Object(o.isChildOf)(t.target,n)&&!this.targetIsCommentTextArea(t)&&this.displaySwitch.hide()}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onAfterRenderer",value:function(t,e){e.comment&&e.comment.value&&Object(o.addClass)(t,e.commentedCellClassName)}},{key:"onEditorBlur",value:function(){this.setComment()}},{key:"onEditorMouseDown",value:function(t){C.get(this).tempEditorDimensions={width:Object(o.outerWidth)(t.target),height:Object(o.outerHeight)(t.target)}}},{key:"onEditorMouseUp",value:function(t){var e=C.get(this),n=Object(o.outerWidth)(t.target),r=Object(o.outerHeight)(t.target);n===e.tempEditorDimensions.width+1&&r===e.tempEditorDimensions.height+2||this.updateCommentMeta(this.range.from.row,this.range.from.col,y({},"style",{width:n,height:r}))}},{key:"onContextMenuAddComment",value:function(){var t=this;this.displaySwitch.cancelHiding();var e=this.hot.getSelectedRangeLast();this.contextMenuEvent=!0,this.setRange({from:e.from}),this.show(),setTimeout((function(){t.hot&&(t.hot.deselectCell(),t.editor.focus())}),10)}},{key:"onContextMenuRemoveComment",value:function(){var t=this.hot.getSelectedRangeLast(),e=t.from,n=t.to;this.contextMenuEvent=!0;for(var o=e.row;o<=n.row;o++)for(var r=e.col;r<=n.col;r++)this.removeCommentAtCell(o,r,!1);this.hot.render()}},{key:"onContextMenuMakeReadOnly",value:function(){var t=this.hot.getSelectedRangeLast(),e=t.from,n=t.to;this.contextMenuEvent=!0;for(var o=e.row;o<=n.row;o++)for(var r=e.col;r<=n.col;r++){var i=!!this.getCommentMeta(o,r,"readOnly");this.updateCommentMeta(o,r,y({},"readOnly",!i))}}},{key:"addToContextMenu",value:function(t){var e=this;t.items.push({name:"---------"},{key:"commentsAddEdit",name:function(){return e.checkSelectionCommentsConsistency()?e.hot.getTranslatedPhrase(f.CONTEXTMENU_ITEMS_EDIT_COMMENT):e.hot.getTranslatedPhrase(f.CONTEXTMENU_ITEMS_ADD_COMMENT)},callback:function(){return e.onContextMenuAddComment()},disabled:function(){return!(this.getSelectedLast()&&!this.selection.isSelectedByCorner())}},{key:"commentsRemove",name:function(){return this.getTranslatedPhrase(f.CONTEXTMENU_ITEMS_REMOVE_COMMENT)},callback:function(){return e.onContextMenuRemoveComment()},disabled:function(){return e.hot.selection.isSelectedByCorner()}},{key:"commentsReadOnly",name:function(){var t=this,e=this.getTranslatedPhrase(f.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT);return Object(c.b)(this.getSelectedRangeLast(),(function(e,n){var o=t.getCellMeta(e,n).comment;if(o&&(o=o.readOnly),o)return!0}))&&(e=Object(c.k)(e)),e},callback:function(){return e.onContextMenuMakeReadOnly()},disabled:function(){return e.hot.selection.isSelectedByCorner()||!e.checkSelectionCommentsConsistency()}})}},{key:"getDisplayDelaySetting",value:function(){var t=this.hot.getSettings().comments;if(Object(r.isObject)(t))return t.displayDelay}},{key:"onAfterBeginEditing",value:function(){this.hide()}},{key:"destroy",value:function(){this.editor&&this.editor.destroy(),this.displaySwitch&&this.displaySwitch.destroy(),m(v(e.prototype),"destroy",this).call(this)}}])&&p(n.prototype,s),u&&p(n,u),e}(u.a);Object(s.d)("comments",w),e.a=w},511:function(t,e,n){"use strict";n(11),n(12),n(13),n(8),n(30),n(17),n(18),n(5),n(31),n(9),n(10);var o=n(22),r=n(4),i=n(19),a=n(297);function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function l(t,e){return!e||"object"!==s(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function c(t,e,n){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=h(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var d=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=l(this,h(e).call(this,t))).bindStrategy=new a.a,n.removedRows=[],n}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}(e,t),n=e,(o=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().bindRowsWithHeaders}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){var n=this.hot.getSettings().bindRowsWithHeaders;"string"!=typeof n&&(n=a.a.DEFAULT_STRATEGY),this.bindStrategy.setStrategy(n),this.bindStrategy.createMap(this.hot.countSourceRows()),this.addHook("modifyRowHeader",(function(e){return t.onModifyRowHeader(e)})),this.addHook("afterCreateRow",(function(e,n){return t.onAfterCreateRow(e,n)})),this.addHook("beforeRemoveRow",(function(e,n){return t.onBeforeRemoveRow(e,n)})),this.addHook("afterRemoveRow",(function(){return t.onAfterRemoveRow()})),this.addHook("afterLoadData",(function(e){return t.onAfterLoadData(e)})),c(h(e.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){c(h(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.removedRows.length=0,this.bindStrategy.clearMap(),c(h(e.prototype),"disablePlugin",this).call(this)}},{key:"onModifyRowHeader",value:function(t){return this.bindStrategy.translate(this.hot.runHooks("modifyRow",t))}},{key:"onAfterCreateRow",value:function(t,e){this.bindStrategy.createRow(t,e)}},{key:"onBeforeRemoveRow",value:function(t,e){var n=this;this.removedRows.length=0,!1!==t&&Object(r.rangeEach)(t,t+e-1,(function(t){n.removedRows.push(n.hot.runHooks("modifyRow",t))}))}},{key:"onAfterRemoveRow",value:function(){this.bindStrategy.removeRow(this.removedRows)}},{key:"onAfterLoadData",value:function(t){t||this.bindStrategy.createMap(this.hot.countSourceRows())}},{key:"destroy",value:function(){this.bindStrategy.destroy(),c(h(e.prototype),"destroy",this).call(this)}}])&&u(n.prototype,o),i&&u(n,i),e}(o.a);Object(i.d)("bindRowsWithHeaders",d),e.a=d},512:function(t,e,n){"use strict";var o=n(92),r=n(2);function i(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var a=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,o;return e=t,o=[{key:"STRATEGY_NAME",get:function(){return"loose"}}],(n=[{key:"createRow",value:function(t,e){this.shiftItems(t,e)}},{key:"removeRow",value:function(t,e){this.unshiftItems(t,e)}},{key:"destroy",value:function(){this._arrayMap=null}}])&&i(e.prototype,n),o&&i(e,o),t}();Object(r.mixin)(a,o.a),e.a=a},513:function(t,e,n){"use strict";var o=n(92),r=n(2);function i(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var a=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,o;return e=t,o=[{key:"STRATEGY_NAME",get:function(){return"strict"}}],(n=[{key:"createRow",value:function(t,e){this.insertItems(t,e)}},{key:"removeRow",value:function(t,e){this.removeItems(t,e)}},{key:"destroy",value:function(){this._arrayMap=null}}])&&i(e.prototype,n),o&&i(e,o),t}();Object(r.mixin)(a,o.a),e.a=a},514:function(t,e,n){"use strict";n(11),n(12),n(13),n(27),n(8),n(56),n(30),n(17),n(95),n(18),n(5),n(31),n(9),n(10);var o=n(2),r=n(1),i=n(4),a=n(41),s=n(0),u=n(24),l=n(19),c=n(15);function h(t){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function f(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function d(t,e){return!e||"object"!==h(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function y(t,e,n){return(y="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=p(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function g(t,e){return(g=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var m=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=d(this,p(e).call(this,t))).settings=null,n.buttonEnabledList={},n.hiddenColumnsPlugin=null,n.nestedHeadersPlugin=null,n.collapsedSections={},n.columnHeaderLevelCount=null,n.eventManager=null,n}var n,l,h;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&g(t,e)}(e,t),n=e,(l=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().collapsibleColumns}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.settings=this.hot.getSettings().collapsibleColumns,"boolean"!=typeof this.settings&&this.parseSettings(),this.hiddenColumnsPlugin=this.hot.getPlugin("hiddenColumns"),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.checkDependencies(),this.addHook("afterRender",(function(){return t.onAfterRender()})),this.addHook("afterInit",(function(){return t.onAfterInit()})),this.addHook("afterGetColHeader",(function(e,n){return t.onAfterGetColHeader(e,n)})),this.addHook("beforeOnCellMouseDown",(function(e,n,o){return t.onBeforeOnCellMouseDown(e,n,o)})),this.eventManager=new u.a(this.hot),y(p(e.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.settings=null,this.buttonEnabledList={},this.hiddenColumnsPlugin=null,this.collapsedSections={},this.clearButtons(),y(p(e.prototype),"disablePlugin",this).call(this)}},{key:"clearButtons",value:function(){if(this.hot.view){var t=this.hot.view.wt.getSetting("columnHeaders").length,e=this.hot.view.wt.wtTable.THEAD,n=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.THEAD,o=this.hot.view.wt.wtOverlays.topLeftCornerOverlay?this.hot.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.THEAD:null,r=function(t){t&&t.parentNode.removeChild(t)};Object(i.rangeEach)(0,t-1,(function(t){var a=e.childNodes[t],s=n.childNodes[t],u=o?o.childNodes[t]:null;Object(i.rangeEach)(0,a.childNodes.length-1,(function(t){var e=a.childNodes[t].querySelector(".collapsibleIndicator");r(e),s&&s.childNodes[t]&&(e=s.childNodes[t].querySelector(".collapsibleIndicator"),r(e)),o&&u&&u.childNodes[t]&&(e=u.childNodes[t].querySelector(".collapsibleIndicator"),r(e))}))}),!0)}}},{key:"parseSettings",value:function(){var t=this;Object(o.objectEach)(this.settings,(function(e){t.buttonEnabledList[e.row]||(t.buttonEnabledList[e.row]={}),t.buttonEnabledList[e.row][e.col]=e.collapsible}))}},{key:"meetsDependencies",value:function(){var t=this.hot.getSettings();return t.nestedHeaders&&t.hiddenColumns}},{key:"checkDependencies",value:function(){var t=this.hot.getSettings();this.meetsDependencies()||(t.nestedHeaders||Object(a.b)("You need to configure the Nested Headers plugin in order to use collapsible headers."),t.hiddenColumns||Object(a.b)("You need to configure the Hidden Columns plugin in order to use collapsible headers."))}},{key:"generateIndicator",value:function(t,e){var n=e.parentNode,o=n.parentNode,r=-1*o.childNodes.length+Array.prototype.indexOf.call(o.childNodes,n);if(Object.keys(this.buttonEnabledList).length>0&&(!this.buttonEnabledList[r]||!this.buttonEnabledList[r][t]))return null;var i=this.hot.rootDocument.createElement("DIV");return Object(s.addClass)(i,"collapsibleIndicator"),this.collapsedSections[r]&&!0===this.collapsedSections[r][t]?(Object(s.addClass)(i,"collapsed"),Object(s.fastInnerText)(i,"+")):(Object(s.addClass)(i,"expanded"),Object(s.fastInnerText)(i,"-")),i}},{key:"markSectionAs",value:function(t,e,n,o){switch(this.collapsedSections[e]||(this.collapsedSections[e]={}),t){case"collapsed":this.collapsedSections[e][n]=!0;break;case"expanded":this.collapsedSections[e][n]=void 0}if(o)for(var r=this.nestedHeadersPlugin.colspanArray,i=this.nestedHeadersPlugin.rowCoordsToLevel(e),a=this.nestedHeadersPlugin.getChildHeaders(e,n),s=r[i+1],u=1;u<a.length;u++)s&&s[a[u]].colspan>1&&this.markSectionAs(t,e+1,a[u],!0)}},{key:"expandSection",value:function(t){this.markSectionAs("expanded",t.row,t.col,!0),this.toggleCollapsibleSection(t,"expand")}},{key:"collapseSection",value:function(t){this.markSectionAs("collapsed",t.row,t.col,!0),this.toggleCollapsibleSection(t,"collapse")}},{key:"toggleAllCollapsibleSections",value:function(t){var e=this,n=this.nestedHeadersPlugin.colspanArray;!0===this.settings?Object(r.arrayEach)(n,(function(n,o){Object(r.arrayEach)(n,(function(n,r){if(n.colspan>1){var i=e.nestedHeadersPlugin.levelToRowCoords(parseInt(o,10)),a=parseInt(r,10);e.markSectionAs("collapse"===t?"collapsed":"expanded",i,a,!0),e.toggleCollapsibleSection({row:i,col:a},t)}}))})):Object(o.objectEach)(this.buttonEnabledList,(function(n,r){Object(o.objectEach)(n,(function(n,o){var i=parseInt(r,10),a=parseInt(o,10);e.markSectionAs("collapse"===t?"collapsed":"expanded",i,a,!0),e.toggleCollapsibleSection({row:i,col:a},t)}))}))}},{key:"collapseAll",value:function(){this.toggleAllCollapsibleSections("collapse")}},{key:"expandAll",value:function(){this.toggleAllCollapsibleSections("expand")}},{key:"toggleCollapsibleSection",value:function(t,e){var n=this;t.row&&(t.row=parseInt(t.row,10)),t.col&&(t.col=parseInt(t.col,10));for(var o=this.hiddenColumnsPlugin.hiddenColumns,r=this.nestedHeadersPlugin.colspanArray,a=this.nestedHeadersPlugin.rowCoordsToLevel(t.row),s=r[a][t.col].colspan,u=this.nestedHeadersPlugin.getChildHeaders(t.row,t.col),l=a+1,c=r[l],h=c&&c[u[0]].colspan||1;h===s&&l<this.columnHeaderLevelCount;)h=(c=r[l+=1])&&c[u[0]].colspan||1;Object(i.rangeEach)(h,s-1,(function(r){var i=t.col+r;switch(e){case"collapse":n.hiddenColumnsPlugin.isHidden(i)||o.push(i);break;case"expand":n.hiddenColumnsPlugin.isHidden(i)&&o.splice(o.indexOf(i),1)}})),this.hot.render(),this.hot.view.wt.wtOverlays.adjustElementsSize(!0)}},{key:"onAfterGetColHeader",value:function(t,e){if(e.hasAttribute("colspan")&&e.getAttribute("colspan")>1&&t>=this.hot.getSettings().fixedColumnsLeft){var n=this.generateIndicator(t,e);null!==n&&e.querySelector("div:first-child").appendChild(n)}}},{key:"onBeforeOnCellMouseDown",value:function(t,e){if(Object(s.hasClass)(t.target,"collapsibleIndicator"))return Object(s.hasClass)(t.target,"expanded")?(this.collapsedSections[e.row]||(this.collapsedSections[e.row]=[]),this.markSectionAs("collapsed",e.row,e.col,!0),this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection(e,"collapse")):Object(s.hasClass)(t.target,"collapsed")&&(this.markSectionAs("expanded",e.row,e.col,!0),this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection(e,"expand")),Object(c.stopImmediatePropagation)(t),!1}},{key:"onAfterInit",value:function(){this.columnHeaderLevelCount=this.hot.view.wt.getSetting("columnHeaders").length}},{key:"onAfterRender",value:function(){this.nestedHeadersPlugin.enabled&&this.hiddenColumnsPlugin.enabled||this.disablePlugin()}},{key:"destroy",value:function(){this.settings=null,this.buttonEnabledList=null,this.hiddenColumnsPlugin=null,this.nestedHeadersPlugin=null,this.collapsedSections=null,this.columnHeaderLevelCount=null,y(p(e.prototype),"destroy",this).call(this)}}])&&f(n.prototype,l),h&&f(n,h),e}(n(22).a);Object(l.d)("collapsibleColumns",m),e.a=m},515:function(t,e,n){"use strict";n(11),n(12),n(13),n(33),n(27),n(8),n(30),n(17),n(18),n(5),n(31),n(40),n(9),n(67),n(84),n(10);var o=n(22),r=n(2),i=n(19),a=n(615);function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function l(t,e){return!e||"object"!==s(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function c(t,e,n){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=h(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var d=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=l(this,h(e).call(this,t))).endpoints=null,n}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}(e,t),n=e,(o=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().columnSummary}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.settings=this.hot.getSettings().columnSummary,this.endpoints=new a.a(this,this.settings),this.addHook("afterInit",(function(){return t.onAfterInit.apply(t,arguments)})),this.addHook("afterChange",(function(){return t.onAfterChange.apply(t,arguments)})),this.addHook("beforeCreateRow",(function(e,n,o){return t.endpoints.resetSetupBeforeStructureAlteration("insert_row",e,n,null,o)})),this.addHook("beforeCreateCol",(function(e,n,o){return t.endpoints.resetSetupBeforeStructureAlteration("insert_col",e,n,null,o)})),this.addHook("beforeRemoveRow",(function(){for(var e,n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.endpoints).resetSetupBeforeStructureAlteration.apply(e,["remove_row"].concat(o))})),this.addHook("beforeRemoveCol",(function(){for(var e,n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.endpoints).resetSetupBeforeStructureAlteration.apply(e,["remove_col"].concat(o))})),this.addHook("beforeRowMove",(function(){return t.onBeforeRowMove.apply(t,arguments)})),this.addHook("afterCreateRow",(function(e,n,o){return t.endpoints.resetSetupAfterStructureAlteration("insert_row",e,n,null,o)})),this.addHook("afterCreateCol",(function(e,n,o){return t.endpoints.resetSetupAfterStructureAlteration("insert_col",e,n,null,o)})),this.addHook("afterRemoveRow",(function(){for(var e,n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.endpoints).resetSetupAfterStructureAlteration.apply(e,["remove_row"].concat(o))})),this.addHook("afterRemoveCol",(function(){for(var e,n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.endpoints).resetSetupAfterStructureAlteration.apply(e,["remove_col"].concat(o))})),this.addHook("afterRowMove",(function(){return t.onAfterRowMove.apply(t,arguments)})),c(h(e.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}},{key:"calculate",value:function(t){switch(t.type.toLowerCase()){case"sum":t.result=this.calculateSum(t);break;case"min":case"max":t.result=this.calculateMinMax(t,t.type);break;case"count":t.result=this.countEntries(t);break;case"average":t.result=this.calculateAverage(t);break;case"custom":t.result=t.customFunction.call(this,t)}}},{key:"calculateSum",value:function(t){var e=this,n=0;return Object(r.objectEach)(t.ranges,(function(o){n+=e.getPartialSum(o,t.sourceColumn)})),n}},{key:"getPartialSum",value:function(t,e){var n=0,o=t[1]||t[0],r=null,i=0;do{r=this.getCellValue(o,e)||0;var a=("".concat(r).split(".")[1]||[]).length||1;a>i&&(i=a),n+=r||0,o-=1}while(o>=t[0]);return Math.round(n*Math.pow(10,i))/Math.pow(10,i)}},{key:"calculateMinMax",value:function(t,e){var n=this,o=null;return Object(r.objectEach)(t.ranges,(function(r){var i=n.getPartialMinMax(r,t.sourceColumn,e);if(null===o&&null!==i&&(o=i),null!==i)switch(e){case"min":o=Math.min(o,i);break;case"max":o=Math.max(o,i)}})),null===o?"Not enough data":o}},{key:"getPartialMinMax",value:function(t,e,n){var o,r=null,i=t[1]||t[0];do{if(o=this.getCellValue(i,e)||null,null===r)r=o;else if(null!==o)switch(n){case"min":r=Math.min(r,o);break;case"max":r=Math.max(r,o)}i-=1}while(i>=t[0]);return r}},{key:"countEmpty",value:function(t,e){var n=0,o=t[1]||t[0];do{this.getCellValue(o,e)||(n+=1),o-=1}while(o>=t[0]);return n}},{key:"countEntries",value:function(t){var e=this,n=0,o=t.ranges;return Object(r.objectEach)(o,(function(o){var r=void 0===o[1]?1:o[1]-o[0]+1,i=e.countEmpty(o,t.sourceColumn);n+=r,n-=i})),n}},{key:"calculateAverage",value:function(t){return this.calculateSum(t)/this.countEntries(t)}},{key:"getCellValue",value:function(t,e){var n=this.endpoints.getVisualRowIndex(t),o=this.endpoints.getVisualColumnIndex(e),r=this.hot.getSourceDataAtCell(t,e);if((this.hot.getCellMeta(n,o).className||"").indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&("string"==typeof r&&(r=r.replace(/,/,".")),r=parseFloat(r)),isNaN(r)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error("ColumnSummary plugin: cell at (".concat(t,", ").concat(e,") is not in a numeric format. Cannot do the calculation."));return r}},{key:"onAfterInit",value:function(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}},{key:"onAfterChange",value:function(t,e){t&&"ColumnSummary.reset"!==e&&"ColumnSummary.set"!==e&&"loadData"!==e&&this.endpoints.refreshChangedEndpoints(t)}},{key:"onBeforeRowMove",value:function(t){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName)}},{key:"onAfterRowMove",value:function(t,e){this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}}])&&u(n.prototype,o),i&&u(n,i),e}(o.a);Object(i.d)("columnSummary",d),e.a=d},589:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));n(213),n(52),n(27),n(63);var o=n(2),r=n(1);function i(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var a=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sortedColumnsStates=[],this.sortEmptyCells=!1,this.indicator=!0,this.headerAction=!0,this.compareFunctionFactory=void 0}var e,n,s;return e=t,(n=[{key:"updateAllColumnsProperties",value:function(t){var e=this;Object(o.isObject)(t)&&Object(o.objectEach)(t,(function(t,n){a.includes(n)&&(e[n]=t)}))}},{key:"getAllColumnsProperties",value:function(){var t={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return"function"==typeof this.compareFunctionFactory&&(t.compareFunctionFactory=this.compareFunctionFactory),t}},{key:"getFirstSortedColumn",value:function(){var t;return this.getNumberOfSortedColumns()>0&&(t=this.sortedColumnsStates[0].column),t}},{key:"getSortOrderOfColumn",value:function(t){var e,n=this.sortedColumnsStates.find((function(e){var n=e.column;return t===n}));return Object(o.isObject)(n)&&(e=n.sortOrder),e}},{key:"getSortedColumns",value:function(){return Object(r.arrayMap)(this.sortedColumnsStates,(function(t){return t.column}))}},{key:"getIndexOfColumnInSortQueue",value:function(t){return this.getSortedColumns().indexOf(t)}},{key:"getNumberOfSortedColumns",value:function(){return this.sortedColumnsStates.length}},{key:"isListOfSortedColumnsEmpty",value:function(){return 0===this.getNumberOfSortedColumns()}},{key:"isColumnSorted",value:function(t){return this.getSortedColumns().includes(t)}},{key:"getSortStates",value:function(){return Object(o.deepClone)(this.sortedColumnsStates)}},{key:"getColumnSortState",value:function(t){if(this.isColumnSorted(t))return Object(o.deepClone)(this.sortedColumnsStates[this.getIndexOfColumnInSortQueue(t)])}},{key:"setSortStates",value:function(t){this.sortedColumnsStates=t}},{key:"destroy",value:function(){this.sortedColumnsStates.length=0,this.sortedColumnsStates=null}}])&&i(e.prototype,n),s&&i(e,s),t}()},590:function(t,e,n){"use strict";var o=n(92),r=n(2),i=n(4);function a(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,o;return e=t,(n=[{key:"createMap",value:function(t){var e=this,n=void 0===t?this._arrayMap.length:t;this._arrayMap.length=0,Object(i.rangeEach)(n-1,(function(t){e._arrayMap[t]=t}))}},{key:"destroy",value:function(){this._arrayMap=null}}])&&a(e.prototype,n),o&&a(e,o),t}();Object(r.mixin)(s,o.a),e.a=s},591:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));n(11),n(12),n(13),n(37),n(8),n(49),n(5),n(16),n(9),n(10);var o=n(28);function r(t){return function(t){if(Array.isArray(t))return t}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function i(t,e){return function(n,i){var a,s,u,l,c,h,f=r(n).slice(1),d=r(i).slice(1);return s=t[a=0],u=e[a],l=f[a],c=d[a],((h=u.columnSorting).compareFunctionFactory?h.compareFunctionFactory:Object(o.d)(u.type))(s,u,h)(l,c)}}},593:function(t,e,n){"use strict";var o=n(0);function r(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function i(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}var a=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.container=null,this.rootDocument=e,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}return i(t,null,[{key:"CLASS_EDITOR_CONTAINER",get:function(){return"htCommentsContainer"}},{key:"CLASS_EDITOR",get:function(){return"htComments"}},{key:"CLASS_INPUT",get:function(){return"htCommentTextArea"}},{key:"CLASS_CELL",get:function(){return"htCommentCell"}}]),i(t,[{key:"setPosition",value:function(t,e){this.editorStyle.left="".concat(t,"px"),this.editorStyle.top="".concat(e,"px")}},{key:"setSize",value:function(t,e){if(t&&e){var n=this.getInputElement();n.style.width="".concat(t,"px"),n.style.height="".concat(e,"px")}}},{key:"resetSize",value:function(){var t=this.getInputElement();t.style.width="",t.style.height=""}},{key:"setReadOnlyState",value:function(t){this.getInputElement().readOnly=t}},{key:"show",value:function(){this.editorStyle.display="block",this.hidden=!1}},{key:"hide",value:function(){this.editorStyle.display="none",this.hidden=!0}},{key:"isVisible",value:function(){return"block"===this.editorStyle.display}},{key:"setValue",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=t||"";this.getInputElement().value=e}},{key:"getValue",value:function(){return this.getInputElement().value}},{key:"isFocused",value:function(){return this.rootDocument.activeElement===this.getInputElement()}},{key:"focus",value:function(){this.getInputElement().focus()}},{key:"createEditor",value:function(){var e=this.rootDocument.createElement("div"),n=this.rootDocument.createElement("textarea");return this.container=this.rootDocument.querySelector(".".concat(t.CLASS_EDITOR_CONTAINER)),this.container||(this.container=this.rootDocument.createElement("div"),Object(o.addClass)(this.container,t.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container)),Object(o.addClass)(e,t.CLASS_EDITOR),Object(o.addClass)(n,t.CLASS_INPUT),e.appendChild(n),this.container.appendChild(e),e}},{key:"getInputElement",value:function(){return this.editor.querySelector(".".concat(t.CLASS_INPUT))}},{key:"destroy",value:function(){var t=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,t&&t.removeChild(this.container)}}]),t}();e.a=a},594:function(t,e,n){"use strict";n(58);var o=n(36),r=n(2),i=n(53);function a(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var s=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(e)}var e,n,r;return e=t,(n=[{key:"hide",value:function(){var t=this;this.wasLastActionShow=!1,this.hidingTimer=setTimeout((function(){!1===t.wasLastActionShow&&t.runLocalHooks("hide")}),250)}},{key:"show",value:function(t){this.wasLastActionShow=!0,this.showDebounced(t)}},{key:"cancelHiding",value:function(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}},{key:"updateDelay",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:250;this.showDebounced=Object(o.debounce)((function(e){t.wasLastActionShow&&t.runLocalHooks("show",e.from.row,e.from.col)}),e)}},{key:"destroy",value:function(){this.clearLocalHooks()}}])&&a(e.prototype,n),r&&a(e,r),t}();Object(r.mixin)(s,i.a),e.a=s},614:function(t,e,n){"use strict";n.r(e);var o=n(512);n.d(e,"Loose",(function(){return o.a}));var r=n(513);n.d(e,"Strict",(function(){return r.a}))},615:function(t,e,n){"use strict";n(11),n(12),n(13),n(27),n(8),n(700),n(5),n(16),n(9),n(10);var o=n(1),r=n(41),i=n(91);function a(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t))&&"[object Arguments]"!==Object.prototype.toString.call(t))return;var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{o||null==s.return||s.return()}finally{if(r)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function s(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var u=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.plugin=e,this.hot=this.plugin.hot,this.endpoints=[],this.settings=n,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[],this.recordTranslator=Object(i.a)(this.hot)}var e,n,u;return e=t,(n=[{key:"getEndpoint",value:function(t){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings)[t]:this.endpoints[t]}},{key:"getAllEndpoints",value:function(){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings):this.endpoints}},{key:"fillMissingEndpointData",value:function(t){return this.parseSettings(t.call(this))}},{key:"parseSettings",value:function(t){var e=this,n=[],r=t;if(r||"function"!=typeof this.settings)return r||(r=this.settings),Object(o.arrayEach)(r,(function(t){var o={};e.assignSetting(t,o,"ranges",[[0,e.hot.countRows()-1]]),e.assignSetting(t,o,"reversedRowCoords",!1),e.assignSetting(t,o,"destinationRow",new Error("\n        You must provide a destination row for the Column Summary plugin in order to work properly!\n      ")),e.assignSetting(t,o,"destinationColumn",new Error("\n        You must provide a destination column for the Column Summary plugin in order to work properly!\n      ")),e.assignSetting(t,o,"sourceColumn",t.destinationColumn),e.assignSetting(t,o,"type","sum"),e.assignSetting(t,o,"forceNumeric",!1),e.assignSetting(t,o,"suppressDataTypeErrors",!0),e.assignSetting(t,o,"suppressDataTypeErrors",!0),e.assignSetting(t,o,"customFunction",null),e.assignSetting(t,o,"readOnly",!0),e.assignSetting(t,o,"roundFloat",!1),n.push(o)})),n;this.settingsType="function"}},{key:"assignSetting",value:function(t,e,n,o){if("ranges"!==n||void 0!==t[n]){if("ranges"!==n||0!==t[n].length)if(void 0===t[n]){if(o instanceof Error)throw o;e[n]=o}else"destinationRow"===n&&e.reversedRowCoords?e[n]=this.hot.countRows()-t[n]-1:e[n]=t[n]}else e[n]=o}},{key:"resetSetupBeforeStructureAlteration",value:function(t,e,n){if("function"===this.settingsType){var r=t.indexOf("row")>-1?"row":"col",i=this.getAllEndpoints();Object(o.arrayEach)(i,(function(o){"row"===r&&o.destinationRow>=e&&("insert_row"===t?o.alterRowOffset=n:"remove_row"===t&&(o.alterRowOffset=-1*n)),"col"===r&&o.destinationColumn>=e&&("insert_col"===t?o.alterColumnOffset=n:"remove_col"===t&&(o.alterColumnOffset=-1*n))})),this.resetAllEndpoints(i,!1)}}},{key:"resetSetupAfterStructureAlteration",value:function(t,e,n,r,i){var a=this,s=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if("function"!==this.settingsType){var u=t.indexOf("row")>-1?"row":"col",l=t.indexOf("remove")>-1?-1:1,c=this.getAllEndpoints(),h=0===t.indexOf("move_row"),f=e;Object(o.arrayEach)(c,(function(t){"row"===u&&t.destinationRow>=f&&(t.alterRowOffset=l*n),"col"===u&&t.destinationColumn>=f&&(t.alterColumnOffset=l*n)})),this.resetAllEndpoints(c,!h),h?Object(o.arrayEach)(c,(function(t){a.extendEndpointRanges(t,f,r[0],r.length),a.recreatePhysicalRanges(t),a.clearOffsetInformation(t)})):Object(o.arrayEach)(c,(function(t){a.shiftEndpointCoordinates(t,f)})),s&&this.refreshAllEndpoints()}else{var d=function t(){return a.hot.removeHook("beforeRender",t),a.refreshAllEndpoints()};this.hot.addHookOnce("beforeRender",d)}}},{key:"clearOffsetInformation",value:function(t){t.alterRowOffset=void 0,t.alterColumnOffset=void 0}},{key:"extendEndpointRanges",value:function(t,e,n,r){Object(o.arrayEach)(t.ranges,(function(t){t[1]&&(e>=t[0]&&e<=t[1]?n>t[1]?t[1]+=r:n<t[0]&&(t[0]-=r):n>=t[0]&&n<=t[1]&&(t[1]-=r,e<=t[0]&&(t[0]+=1,t[1]+=1)))}))}},{key:"recreatePhysicalRanges",value:function(t){var e=this,n=t.ranges,r=[],i=[];Object(o.arrayEach)(n,(function(t){var n=[];if(t[1])for(var o=t[0];o<=t[1];o++)n.push(e.recordTranslator.toPhysicalRow(o));else n.push(e.recordTranslator.toPhysicalRow(t[0]));i.push(n)})),Object(o.arrayEach)(i,(function(t){var e=[];Object(o.arrayEach)(t,(function(n,o){0===o?e.push(n):t[o]!==t[o-1]+1&&(e.push(t[o-1]),r.push(e),(e=[]).push(n)),o===t.length-1&&(e.push(n),r.push(e))}))})),t.ranges=r}},{key:"shiftEndpointCoordinates",value:function(t,e){t.alterRowOffset&&0!==t.alterRowOffset?(t.destinationRow+=t.alterRowOffset||0,Object(o.arrayEach)(t.ranges,(function(n){Object(o.arrayEach)(n,(function(o,r){o>=e&&(n[r]+=t.alterRowOffset||0)}))}))):t.alterColumnOffset&&0!==t.alterColumnOffset&&(t.destinationColumn+=t.alterColumnOffset||0,t.sourceColumn+=t.alterColumnOffset||0)}},{key:"resetAllEndpoints",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=t;this.cellsToSetCache=[],r||(r=this.getAllEndpoints()),Object(o.arrayEach)(r,(function(t){e.resetEndpointValue(t,n)})),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshAllEndpoints",value:function(){var t=this;this.cellsToSetCache=[],Object(o.arrayEach)(this.getAllEndpoints(),(function(e){t.currentEndpoint=e,t.plugin.calculate(e),t.setEndpointValue(e,"init")})),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshChangedEndpoints",value:function(t){var e=this,n=[];this.cellsToSetCache=[],Object(o.arrayEach)(t,(function(t,r,i){"".concat(t[2]||"")!=="".concat(t[3])&&Object(o.arrayEach)(e.getAllEndpoints(),(function(t,o){e.hot.propToCol(i[r][1])===t.sourceColumn&&-1===n.indexOf(o)&&n.push(o)}))})),Object(o.arrayEach)(n,(function(t){e.refreshEndpoint(e.getEndpoint(t))})),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshEndpoint",value:function(t){this.currentEndpoint=t,this.plugin.calculate(t),this.setEndpointValue(t),this.currentEndpoint=null}},{key:"resetEndpointValue",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=t.alterRowOffset||0,o=t.alterColumnOffset||0,r=this.recordTranslator.toVisual(t.destinationRow,t.destinationColumn),i=a(r,2),s=i[0],u=i[1],l=this.hot.getCellMeta(s,u);l.readOnly=!1,l.className="",this.cellsToSetCache.push([this.recordTranslator.toVisualRow(t.destinationRow+(e?n:0)),this.recordTranslator.toVisualColumn(t.destinationColumn+(e?o:0)),""])}},{key:"setEndpointValue",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=-1*t.alterRowOffset||0,r=-1*t.alterColumnOffset||0,i=this.getVisualRowIndex(t.destinationRow),a=this.hot.getCellMeta(this.getVisualRowIndex(t.destinationRow+o),t.destinationColumn+r);i>this.hot.countRows()||t.destinationColumn>this.hot.countCols()?this.throwOutOfBoundsWarning():("init"!==e&&a.readOnly===t.readOnly||(a.readOnly=t.readOnly,a.className="columnSummaryResult"),t.roundFloat&&!isNaN(t.result)&&(t.result=t.result.toFixed(t.roundFloat)),n?this.hot.setDataAtCell(i,t.destinationColumn,t.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,t.destinationColumn,t.result]),t.alterRowOffset=void 0,t.alterColumnOffset=void 0)}},{key:"getVisualRowIndex",value:function(t){return this.hot.runHooks("unmodifyRow",t,"columnSummary")}},{key:"getVisualColumnIndex",value:function(t){return this.hot.runHooks("unmodifyCol",t,"columnSummary")}},{key:"throwOutOfBoundsWarning",value:function(){Object(r.b)("One of the  Column Summary plugins' destination points you provided is beyond the table boundaries!")}}])&&s(e.prototype,n),u&&s(e,u),t}();e.a=u},77:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return s})),n.d(e,"c",(function(){return l})),n.d(e,"e",(function(){return c})),n.d(e,"d",(function(){return h})),n.d(e,"f",(function(){return f})),n.d(e,"g",(function(){return d}));n(144),n(37),n(52),n(27),n(8),n(214),n(123),n(124),n(5),n(125),n(9),n(10);var o=n(14),r=n(2),i=n(15),a="asc",s="desc";function u(t){if(Object(o.isUndefined)(t))return!1;var e=t.column,n=t.sortOrder;return Number.isInteger(e)&&[a,s].includes(n)}function l(t){if(!1===Array.isArray(t)||!1===t.every((function(t){return Object(r.isObject)(t)})))return!1;var e=t.map((function(t){return t.column}));return new Set(e).size===e.length&&t.every(u)}function c(t){if(t!==s)return t===a?s:a}function h(t){return t.querySelector(".".concat("colHeader"))}function f(t,e){if(t<0||!e.parentNode)return!1;var n=e.parentNode.parentNode.childNodes;return-1===Array.from(n).indexOf(e.parentNode)-n.length}function d(t,e,n){return-1===t&&e>=0&&!1===Object(i.isRightClick)(n)}}}]);