(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{108:function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return i}));var o="---------";function i(){return{name:o}}},149:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return s}));n(27);var o=n(23),i=n(108),r=n(3),a="alignment";function s(){return{key:a,name:function(){return this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_ALIGNMENT)},disabled:function(){return!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:"".concat(a,":left"),name:function(){var t=this,e=this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT);return Object(o.b)(this.getSelectedRange(),(function(e,n){var o=t.getCellMeta(e,n).className;if(o&&-1!==o.indexOf("htLeft"))return!0}))&&(e=Object(o.k)(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=Object(o.d)(e,(function(e,n){return t.getCellMeta(e,n).className}));this.runHooks("beforeCellAlignment",n,e,"horizontal","htLeft"),Object(o.a)(e,"horizontal","htLeft",(function(e,n){return t.getCellMeta(e,n)}),(function(e,n,o,i){return t.setCellMeta(e,n,o,i)})),this.render()},disabled:!1},{key:"".concat(a,":center"),name:function(){var t=this,e=this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER);return Object(o.b)(this.getSelectedRange(),(function(e,n){var o=t.getCellMeta(e,n).className;if(o&&-1!==o.indexOf("htCenter"))return!0}))&&(e=Object(o.k)(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=Object(o.d)(e,(function(e,n){return t.getCellMeta(e,n).className}));this.runHooks("beforeCellAlignment",n,e,"horizontal","htCenter"),Object(o.a)(e,"horizontal","htCenter",(function(e,n){return t.getCellMeta(e,n)}),(function(e,n,o,i){return t.setCellMeta(e,n,o,i)})),this.render()},disabled:!1},{key:"".concat(a,":right"),name:function(){var t=this,e=this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT);return Object(o.b)(this.getSelectedRange(),(function(e,n){var o=t.getCellMeta(e,n).className;if(o&&-1!==o.indexOf("htRight"))return!0}))&&(e=Object(o.k)(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=Object(o.d)(e,(function(e,n){return t.getCellMeta(e,n).className}));this.runHooks("beforeCellAlignment",n,e,"horizontal","htRight"),Object(o.a)(e,"horizontal","htRight",(function(e,n){return t.getCellMeta(e,n)}),(function(e,n,o,i){return t.setCellMeta(e,n,o,i)})),this.render()},disabled:!1},{key:"".concat(a,":justify"),name:function(){var t=this,e=this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY);return Object(o.b)(this.getSelectedRange(),(function(e,n){var o=t.getCellMeta(e,n).className;if(o&&-1!==o.indexOf("htJustify"))return!0}))&&(e=Object(o.k)(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=Object(o.d)(e,(function(e,n){return t.getCellMeta(e,n).className}));this.runHooks("beforeCellAlignment",n,e,"horizontal","htJustify"),Object(o.a)(e,"horizontal","htJustify",(function(e,n){return t.getCellMeta(e,n)}),(function(e,n,o,i){return t.setCellMeta(e,n,o,i)})),this.render()},disabled:!1},{name:i.a},{key:"".concat(a,":top"),name:function(){var t=this,e=this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_ALIGNMENT_TOP);return Object(o.b)(this.getSelectedRange(),(function(e,n){var o=t.getCellMeta(e,n).className;if(o&&-1!==o.indexOf("htTop"))return!0}))&&(e=Object(o.k)(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=Object(o.d)(e,(function(e,n){return t.getCellMeta(e,n).className}));this.runHooks("beforeCellAlignment",n,e,"vertical","htTop"),Object(o.a)(e,"vertical","htTop",(function(e,n){return t.getCellMeta(e,n)}),(function(e,n,o,i){return t.setCellMeta(e,n,o,i)})),this.render()},disabled:!1},{key:"".concat(a,":middle"),name:function(){var t=this,e=this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE);return Object(o.b)(this.getSelectedRange(),(function(e,n){var o=t.getCellMeta(e,n).className;if(o&&-1!==o.indexOf("htMiddle"))return!0}))&&(e=Object(o.k)(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=Object(o.d)(e,(function(e,n){return t.getCellMeta(e,n).className}));this.runHooks("beforeCellAlignment",n,e,"vertical","htMiddle"),Object(o.a)(e,"vertical","htMiddle",(function(e,n){return t.getCellMeta(e,n)}),(function(e,n,o,i){return t.setCellMeta(e,n,o,i)})),this.render()},disabled:!1},{key:"".concat(a,":bottom"),name:function(){var t=this,e=this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM);return Object(o.b)(this.getSelectedRange(),(function(e,n){var o=t.getCellMeta(e,n).className;if(o&&-1!==o.indexOf("htBottom"))return!0}))&&(e=Object(o.k)(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=Object(o.d)(e,(function(e,n){return t.getCellMeta(e,n).className}));this.runHooks("beforeCellAlignment",n,e,"vertical","htBottom"),Object(o.a)(e,"vertical","htBottom",(function(e,n){return t.getCellMeta(e,n)}),(function(e,n,o,i){return t.setCellMeta(e,n,o,i)})),this.render()},disabled:!1}]}}}},150:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return s}));n(11),n(12),n(13),n(8),n(85),n(6),n(16),n(9),n(10);var o=n(23),i=n(3);function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t))&&"[object Arguments]"!==Object.prototype.toString.call(t))return;var n=[],o=!0,i=!1,r=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){i=!0,r=t}finally{try{o||null==s.return||s.return()}finally{if(i)throw r}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var a="clear_column";function s(){return{key:a,name:function(){return this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_CLEAR_COLUMN)},callback:function(t,e){var n=e[0].start.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),n,"ContextMenu.clearColumn")},disabled:function(){var t=Object(o.e)(this);if(!t)return!0;var e=r(t[0],3),n=e[0],i=e[1],a=[n,0,e[2],this.countCols()-1].join(",")===t.join(",");return i<0||this.countCols()>=this.getSettings().maxCols||a}}}},151:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return s}));n(11),n(12),n(13),n(8),n(85),n(6),n(16),n(9),n(10);var o=n(23),i=n(3);function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t))&&"[object Arguments]"!==Object.prototype.toString.call(t))return;var n=[],o=!0,i=!1,r=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){i=!0,r=t}finally{try{o||null==s.return||s.return()}finally{if(i)throw r}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var a="col_left";function s(){return{key:a,name:function(){return this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_INSERT_LEFT)},callback:function(t,e){var n=e[Math.max(e.length-1,0)];this.alter("insert_col",n.start.col,1,"ContextMenu.columnLeft")},disabled:function(){var t=Object(o.e)(this);if(!t)return!0;if(!this.isColumnModificationAllowed())return!0;var e=r(t[0],3),n=e[0],i=e[1],a=[n,0,e[2],this.countCols()-1].join(",")===t.join(","),s=1===this.countCols();return i<0||this.countCols()>=this.getSettings().maxCols||!s&&a},hidden:function(){return!this.getSettings().allowInsertColumn}}}},152:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return s}));n(11),n(12),n(13),n(8),n(85),n(6),n(16),n(9),n(10);var o=n(23),i=n(3);function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t))&&"[object Arguments]"!==Object.prototype.toString.call(t))return;var n=[],o=!0,i=!1,r=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){i=!0,r=t}finally{try{o||null==s.return||s.return()}finally{if(i)throw r}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var a="col_right";function s(){return{key:a,name:function(){return this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_INSERT_RIGHT)},callback:function(t,e){var n=e[Math.max(e.length-1,0)];this.alter("insert_col",n.end.col+1,1,"ContextMenu.columnRight")},disabled:function(){var t=Object(o.e)(this);if(!t)return!0;if(!this.isColumnModificationAllowed())return!0;var e=r(t[0],3),n=e[0],i=e[1],a=[n,0,e[2],this.countCols()-1].join(",")===t.join(","),s=1===this.countCols();return i<0||this.countCols()>=this.getSettings().maxCols||!s&&a},hidden:function(){return!this.getSettings().allowInsertColumn}}}},153:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return s}));var o=n(23),i=n(1),r=n(3),a="make_read_only";function s(){return{key:a,name:function(){var t=this,e=this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_READ_ONLY);return Object(o.b)(this.getSelectedRange(),(function(e,n){return t.getCellMeta(e,n).readOnly}))&&(e=Object(o.k)(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=Object(o.b)(e,(function(e,n){return t.getCellMeta(e,n).readOnly}));Object(i.arrayEach)(e,(function(e){e.forAll((function(e,o){t.setCellMeta(e,o,"readOnly",!n)}))})),this.render()},disabled:function(){return!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())}}}},154:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return r}));var o=n(3),i="redo";function r(){return{key:i,name:function(){return this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_REDO)},callback:function(){this.redo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isRedoAvailable()}}}},155:function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return u}));n(11),n(12),n(13),n(8),n(6),n(16),n(9),n(10);var o=n(23),i=n(67),r=n(3);function a(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t))&&"[object Arguments]"!==Object.prototype.toString.call(t))return;var n=[],o=!0,i=!1,r=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){i=!0,r=t}finally{try{o||null==s.return||s.return()}finally{if(i)throw r}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var s="remove_col";function u(){return{key:s,name:function(){var t=this.getSelected(),e=0;if(t)if(t.length>1)e=1;else{var n=a(t[0],4);n[1]-n[3]!=0&&(e=1)}return this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_REMOVE_COLUMN,e)},callback:function(){this.alter("remove_col",Object(i.f)(this.getSelected()),null,"ContextMenu.removeColumn")},disabled:function(){var t=Object(o.e)(this),e=this.countCols();return!t||(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner()||!this.isColumnModificationAllowed()||!e)},hidden:function(){return!this.getSettings().allowRemoveColumn}}}},156:function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return u}));n(11),n(12),n(13),n(8),n(6),n(16),n(9),n(10);var o=n(23),i=n(67),r=n(3);function a(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t))&&"[object Arguments]"!==Object.prototype.toString.call(t))return;var n=[],o=!0,i=!1,r=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){i=!0,r=t}finally{try{o||null==s.return||s.return()}finally{if(i)throw r}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var s="remove_row";function u(){return{key:s,name:function(){var t=this.getSelected(),e=0;if(t)if(t.length>1)e=1;else{var n=a(t[0],3);n[0]-n[2]!=0&&(e=1)}return this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_REMOVE_ROW,e)},callback:function(){this.alter("remove_row",Object(i.g)(this.getSelected()),1,"ContextMenu.removeRow")},disabled:function(){var t=Object(o.e)(this),e=this.countRows();return!t||(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner()||!e)},hidden:function(){return!this.getSettings().allowRemoveRow}}}},157:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return a}));var o=n(23),i=n(3),r="row_above";function a(){return{key:r,name:function(){return this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_ROW_ABOVE)},callback:function(t,e){var n=e[Math.max(e.length-1,0)];this.alter("insert_row",n.start.row,1,"ContextMenu.rowAbove")},disabled:function(){return!Object(o.e)(this)||(this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows)},hidden:function(){return!this.getSettings().allowInsertRow}}}},158:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return a}));var o=n(23),i=n(3),r="row_below";function a(){return{key:r,name:function(){return this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_ROW_BELOW)},callback:function(t,e){var n=e[Math.max(e.length-1,0)];this.alter("insert_row",n.end.row+1,1,"ContextMenu.rowBelow")},disabled:function(){return!Object(o.e)(this)||(this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows)},hidden:function(){return!this.getSettings().allowInsertRow}}}},159:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return r}));var o=n(3),i="no_items";function r(){return{key:i,name:function(){return this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_NO_ITEMS)},disabled:!0,isCommand:!1}}},160:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return r}));var o=n(3),i="undo";function r(){return{key:i,name:function(){return this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_UNDO)},callback:function(){this.undo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isUndoAvailable()}}}},161:function(t,e,n){"use strict";n(33),n(86),n(96),n(6),n(181),n(40),n(16),n(70);var o=n(131),i=n(0),r=n(1),a=n(595),s=n(24),u=n(2),l=n(14),c=n(36),h=n(23),f=n(21),d=n(53),b=n(25),m=n(15),g=n(50);function v(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var p=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:215,container:this.hot.rootDocument.documentElement},this.eventManager=new s.a(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.keyEvent=!1,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()}var e,n,d;return e=t,(n=[{key:"registerEvents",value:function(){for(var t=this,e=this.hot.rootWindow;e;)this.eventManager.addEventListener(e.document,"mousedown",(function(e){return t.onDocumentMouseDown(e)})),e=Object(i.getParentWindow)(e)}},{key:"setMenuItems",value:function(t){this.menuItems=t}},{key:"getSelectedItem",value:function(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}},{key:"hasSelectedItem",value:function(){return Array.isArray(this.hotMenu.getSelectedLast())}},{key:"setOffset",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.offset[t]=e}},{key:"isSubMenu",value:function(){return null!==this.parentMenu}},{key:"open",value:function(){var t=this;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";var e=Object(c.debounce)((function(e){return t.openSubMenu(e)}),300),n=this.options.minWidth||215,i=!1,a=Object(r.arrayFilter)(this.menuItems,(function(e){return e.key===b.f&&(i=!0),Object(h.h)(e,t.hot)}));if(a.length<1&&!i)a.push(Object(b.o)()[b.f]);else if(0===a.length)return;a=Object(h.c)(a,b.m);var s=!1,u={data:a,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:function(t){return Object(l.isDefined)(t)&&t<n?n:t},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,columns:[{data:"name",renderer:function(e,n,o,i,r,a){return t.menuItemRenderer(e,n,o,i,r,a)}}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",beforeKeyDown:function(e){return t.onBeforeKeyDown(e)},afterOnCellMouseOver:function(n,o){t.isAllSubMenusClosed()?e(o.row):t.openSubMenu(o.row)},rowHeights:function(t){return a[t].name===b.m?1:23},afterOnCellContextMenu:function(e){e.preventDefault(),Object(g.isWindowsOS)()&&s&&t.hasSelectedItem()&&t.close(!0)},beforeOnCellMouseUp:function(e){t.hasSelectedItem()&&(s=!t.isCommandPassive(t.getSelectedItem()),t.executeCommand(e))},afterOnCellMouseUp:function(e){Object(g.isWindowsOS)()&&Object(m.isRightClick)(e)||!s||!t.hasSelectedItem()||t.close(!0)},afterUnlisten:function(){!t.hasSelectedItem()&&t.isOpened()&&t.hotMenu.listen(!1)}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new o.a(this.container,u),this.hotMenu.addHook("afterInit",(function(){return t.onAfterInit()})),this.hotMenu.addHook("afterSelection",(function(){return t.onAfterSelection.apply(t,arguments)})),this.hotMenu.init(),this.hotMenu.listen(),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")}},{key:"close",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isOpened()&&(t&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}},{key:"openSubMenu",value:function(e){if(!this.hotMenu)return!1;var n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!Object(h.f)(n))return!1;var o=this.hotMenu.getSourceDataAtRow(e),i=new t(this.hot,{parent:this,name:o.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(o.submenu.items),i.open(),i.setPosition(n.getBoundingClientRect()),this.hotSubMenus[o.key]=i,i}},{key:"closeSubMenu",value:function(t){var e=this.hotMenu.getSourceDataAtRow(t),n=this.hotSubMenus[e.key];n&&(n.destroy(),delete this.hotSubMenus[e.key])}},{key:"closeAllSubMenus",value:function(){var t=this;Object(r.arrayEach)(this.hotMenu.getData(),(function(e,n){return t.closeSubMenu(n)}))}},{key:"isAllSubMenusClosed",value:function(){return 0===Object.keys(this.hotSubMenus).length}},{key:"destroy",value:function(){var t=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),t&&t.removeChild(this.container)}},{key:"isOpened",value:function(){return null!==this.hotMenu}},{key:"executeCommand",value:function(t){if(this.isOpened()&&this.hasSelectedItem()){var e=this.getSelectedItem();if(this.runLocalHooks("select",e,t),!this.isCommandPassive(e)){var n=this.hot.getSelectedRange(),o=n?Object(h.l)(n):[];this.runLocalHooks("executeCommand",e.key,o,t),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",e.key,o,t)}}}},{key:"isCommandPassive",value:function(t){var e=t.isCommand,n=t.name,o=t.disabled,i=t.submenu,r=!0===o||"function"==typeof o&&!0===o.call(this.hot);return!1===e||n===b.m||!0===r||i}},{key:"setPosition",value:function(t){var e=new a.a(t,this.container.ownerDocument.defaultView);this.options.keepInViewport?(e.fitsBelow(this.container)?this.setPositionBelowCursor(e):e.fitsAbove(this.container)?this.setPositionAboveCursor(e):this.setPositionBelowCursor(e),e.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(e):this.setPositionOnLeftOfCursor(e)):(this.setPositionBelowCursor(e),this.setPositionOnRightOfCursor(e))}},{key:"setPositionAboveCursor",value:function(t){var e=this.offset.above+t.top-this.container.offsetHeight;this.isSubMenu()&&(e=t.top+t.cellHeight-this.container.offsetHeight+3),this.container.style.top="".concat(e,"px")}},{key:"setPositionBelowCursor",value:function(t){var e=this.offset.below+t.top;this.isSubMenu()&&(e=t.top-1),this.container.style.top="".concat(e,"px")}},{key:"setPositionOnRightOfCursor",value:function(t){var e;e=this.isSubMenu()?1+t.left+t.cellWidth:this.offset.right+1+t.left,this.container.style.left="".concat(e,"px")}},{key:"setPositionOnLeftOfCursor",value:function(t){var e=this.offset.left+t.left-this.container.offsetWidth+Object(i.getScrollbarWidth)(this.hot.rootDocument)+4;this.container.style.left="".concat(e,"px")}},{key:"selectFirstCell",value:function(){var t=this.hotMenu.getCell(0,0);Object(h.j)(t)||Object(h.g)(t)||Object(h.i)(t)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}},{key:"selectLastCell",value:function(){var t=this.hotMenu.countRows()-1,e=this.hotMenu.getCell(t,0);Object(h.j)(e)||Object(h.g)(e)||Object(h.i)(e)?this.selectPrevCell(t,0):this.hotMenu.selectCell(t,0)}},{key:"selectNextCell",value:function(t,e){var n=t+1,o=n<this.hotMenu.countRows()?this.hotMenu.getCell(n,e):null;o&&(Object(h.j)(o)||Object(h.g)(o)||Object(h.i)(o)?this.selectNextCell(n,e):this.hotMenu.selectCell(n,e))}},{key:"selectPrevCell",value:function(t,e){var n=t-1,o=n>=0?this.hotMenu.getCell(n,e):null;o&&(Object(h.j)(o)||Object(h.g)(o)||Object(h.i)(o)?this.selectPrevCell(n,e):this.hotMenu.selectCell(n,e))}},{key:"menuItemRenderer",value:function(t,e,n,o,r,a){var s,l=this,c=t.getSourceDataAtRow(n),h=this.hot.rootDocument.createElement("div"),f=function(t){return t.disableSelection},d=a;"function"==typeof d&&(d=d.call(this.hot)),Object(i.empty)(e),Object(i.addClass)(h,"htItemWrapper"),e.appendChild(h),s=c,new RegExp(b.m,"i").test(s.name)?Object(i.addClass)(e,"htSeparator"):"function"==typeof c.renderer?(Object(i.addClass)(e,"htCustomMenuRenderer"),e.appendChild(c.renderer(t,h,n,o,r,d))):Object(i.fastInnerHTML)(h,d),function(t){return!0===t.disabled||"function"==typeof t.disabled&&!0===t.disabled.call(l.hot)}(c)?(Object(i.addClass)(e,"htDisabled"),this.eventManager.addEventListener(e,"mouseenter",(function(){return t.deselectCell()}))):f(c)?(Object(i.addClass)(e,"htSelectionDisabled"),this.eventManager.addEventListener(e,"mouseenter",(function(){return t.deselectCell()}))):function(t){return Object(u.hasOwnProperty)(t,"submenu")}(c)?(Object(i.addClass)(e,"htSubmenu"),f(c)?this.eventManager.addEventListener(e,"mouseenter",(function(){return t.deselectCell()})):this.eventManager.addEventListener(e,"mouseenter",(function(){return t.selectCell(n,o,void 0,void 0,!1,!1)}))):(Object(i.removeClass)(e,["htSubmenu","htDisabled"]),f(c)?this.eventManager.addEventListener(e,"mouseenter",(function(){return t.deselectCell()})):this.eventManager.addEventListener(e,"mouseenter",(function(){return t.selectCell(n,o,void 0,void 0,!1,!1)})))}},{key:"createContainer",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=this.options.container.ownerDocument,o=e;return o&&(Object(c.isFunction)(o)&&(o=null===(o=o.call(this.hot))||Object(l.isUndefined)(o)?"":o.toString()),o=o.replace(/[^A-z0-9]/g,"_"),o="".concat(this.options.className,"Sub_").concat(o),t=n.querySelector(".".concat(this.options.className,".").concat(o))),t||(t=n.createElement("div"),Object(i.addClass)(t,"htMenu ".concat(this.options.className)),o&&Object(i.addClass)(t,o),this.options.container.appendChild(t)),t}},{key:"blockMainTableCallbacks",value:function(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}},{key:"releaseMainTableCallbacks",value:function(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}},{key:"onBeforeKeyDown",value:function(t){if(Object(i.isInput)(t.target)&&this.container.contains(t.target))Object(m.stopImmediatePropagation)(t);else{var e=this.hotMenu.getSelectedLast(),n=!1;switch(this.keyEvent=!0,t.keyCode){case f.KEY_CODES.ESCAPE:this.close(),n=!0;break;case f.KEY_CODES.ENTER:e&&(this.hotMenu.getSourceDataAtRow(e[0]).submenu?n=!0:(this.executeCommand(t),this.close(!0)));break;case f.KEY_CODES.ARROW_DOWN:e?this.selectNextCell(e[0],e[1]):this.selectFirstCell(),n=!0;break;case f.KEY_CODES.ARROW_UP:e?this.selectPrevCell(e[0],e[1]):this.selectLastCell(),n=!0;break;case f.KEY_CODES.ARROW_RIGHT:if(e){var o=this.openSubMenu(e[0]);o&&o.selectFirstCell()}n=!0;break;case f.KEY_CODES.ARROW_LEFT:e&&this.isSubMenu()&&(this.close(),this.parentMenu&&this.parentMenu.hotMenu.listen(),n=!0)}n&&(t.preventDefault(),Object(m.stopImmediatePropagation)(t)),this.keyEvent=!1}}},{key:"onAfterInit",value:function(){var t=this.hotMenu.view.wt.wtTable,e=this.hotMenu.getSettings().data,n=t.hider.style,o=t.holder.style,i=parseInt(n.width,10),a=Object(r.arrayReduce)(e,(function(t,e){return t+(e.name===b.m?1:26)}),0);o.width="".concat(i+22,"px"),o.height="".concat(a+4,"px"),n.height=o.height}},{key:"onAfterSelection",value:function(t,e,n,o,i){!1===this.keyEvent&&(i.value=!0)}},{key:"onDocumentMouseDown",value:function(t){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!Object(i.isChildOf)(t.target,this.hotMenu.rootElement)?this.close(!0):!this.isAllSubMenusClosed()&&!this.isSubMenu()||Object(i.isChildOf)(t.target,".htMenu")||!Object(i.isChildOf)(t.target,this.container.ownerDocument)&&!Object(i.isChildOf)(t.target,this.hot.rootDocument)||this.close(!0))}}])&&v(e.prototype,n),d&&v(e,d),t}();Object(u.mixin)(p,d.a),e.a=p},23:function(t,e,n){"use strict";n.d(e,"l",(function(){return a})),n.d(e,"j",(function(){return s})),n.d(e,"f",(function(){return u})),n.d(e,"g",(function(){return l})),n.d(e,"i",(function(){return c})),n.d(e,"e",(function(){return h})),n.d(e,"d",(function(){return f})),n.d(e,"a",(function(){return d})),n.d(e,"b",(function(){return m})),n.d(e,"k",(function(){return g})),n.d(e,"h",(function(){return v})),n.d(e,"c",(function(){return O}));n(33),n(27),n(212),n(49),n(86),n(40),n(70);var o=n(1),i=n(0),r=n(108);function a(t){return Object(o.arrayMap)(t,(function(t){return{start:t.getTopLeftCorner(),end:t.getBottomRightCorner()}}))}function s(t){return Object(i.hasClass)(t,"htSeparator")}function u(t){return Object(i.hasClass)(t,"htSubmenu")}function l(t){return Object(i.hasClass)(t,"htDisabled")}function c(t){return Object(i.hasClass)(t,"htSelectionDisabled")}function h(t){var e=t.getSelected();return e?e[0]<0?null:e:null}function f(t,e){var n={};return Object(o.arrayEach)(t,(function(t){for(var o=t.from,i=t.to,r=o.row;r<=i.row;r++)for(var a=o.col;a<=i.col;a++)n[r]||(n[r]=[]),n[r][a]=e(r,a)})),n}function d(t,e,n,i,r){Object(o.arrayEach)(t,(function(t){var o=t.from,a=t.to;if(o.row===a.row&&o.col===a.col)b(o.row,o.col,e,n,i,r);else for(var s=o.row;s<=a.row;s++)for(var u=o.col;u<=a.col;u++)b(s,u,e,n,i,r)}))}function b(t,e,n,o,i,r){var a=i(t,e),s=o;a.className&&(s="vertical"===n?function(t,e){if(-1!==t.indexOf(e))return t;var n=t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return"".concat(n," ").concat(e)}(a.className,o):function(t,e){if(-1!==t.indexOf(e))return t;var n=t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return"".concat(n," ").concat(e)}(a.className,o)),r(t,e,"className",s)}function m(t,e){var n=!1;return Array.isArray(t)&&Object(o.arrayEach)(t,(function(t){return t.forAll((function(t,o){if(e(t,o))return n=!0,!1})),n})),n}function g(t){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(t)}function v(t,e){return!t.hidden||!("function"==typeof t.hidden&&t.hidden.call(e))}function p(t,e){for(var n=t.slice(0);0<n.length&&n[0].name===e;)n.shift();return n}function y(t,e){var n=t.slice(0);return n.reverse(),(n=p(n,e)).reverse(),n}function C(t){var e=[];return Object(o.arrayEach)(t,(function(t,n){n>0?e[e.length-1].name!==t.name&&e.push(t):e.push(t)})),e}function O(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.a,n=t.slice(0);return n=C(n=y(n=p(n,e),e))}},237:function(t,e,n){"use strict";n(85),n(40),n(84);var o=n(1),i=n(2);function r(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var a=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hot=e,this.commands={},this.commonCallback=null}var e,n,a;return e=t,(n=[{key:"registerCommand",value:function(t,e){this.commands[t]=e}},{key:"setCommonCallback",value:function(t){this.commonCallback=t}},{key:"execute",value:function(t){for(var e=this,n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];var u=t.split(":"),l=u[0],c=2===u.length?u[1]:null,h=this.commands[l];if(!h)throw new Error("Menu command '".concat(l,"' not exists."));if(c&&h.submenu&&(h=s(c,h.submenu.items)),!0!==h.disabled&&("function"!=typeof h.disabled||!0!==h.disabled.call(this.hot))&&!Object(i.hasOwnProperty)(h,"submenu")){var f=[];"function"==typeof h.callback&&f.push(h.callback),"function"==typeof this.commonCallback&&f.push(this.commonCallback),r.unshift(u.join(":")),Object(o.arrayEach)(f,(function(t){return t.apply(e.hot,r)}))}}}])&&r(e.prototype,n),a&&r(e,a),t}();function s(t,e){var n;return Object(o.arrayEach)(e,(function(e){var o=e.key?e.key.split(":"):null;if(Array.isArray(o)&&o[1]===t)return n=e,!1})),n}e.a=a},238:function(t,e,n){"use strict";n(27),n(86);var o=n(2),i=n(1),r=n(25);function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var u=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;a(this,t),this.hot=e,this.predefinedItems=Object(r.o)(),this.defaultOrderPattern=n}var e,n,i;return e=t,(n=[{key:"setPredefinedItems",value:function(t){var e=this,n={};this.defaultOrderPattern.length=0,Object(o.objectEach)(t,(function(t,o){var i="";t.name===r.m?(n[r.m]=t,i=r.m):isNaN(parseInt(o,10))?(t.key=void 0===t.key?o:t.key,n[o]=t,i=t.key):(n[t.key]=t,i=t.key),e.defaultOrderPattern.push(i)})),this.predefinedItems=n}},{key:"getItems",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return l(t,this.defaultOrderPattern,this.predefinedItems)}}])&&s(e.prototype,n),i&&s(e,i),t}();function l(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=[],s=t;return s&&s.items?s=s.items:Array.isArray(s)||(s=e),Object(o.isObject)(s)?Object(o.objectEach)(s,(function(t,e){var i=n["string"==typeof t?t:e];i||(i=t),Object(o.isObject)(t)?Object(o.extend)(i,t):"string"==typeof i&&(i={name:i}),void 0===i.key&&(i.key=e),a.push(i)})):Object(i.arrayEach)(s,(function(t,e){var i=n[t];!i&&r.e.indexOf(t)>=0||(i||(i={name:t,key:"".concat(e)}),Object(o.isObject)(t)&&Object(o.extend)(i,t),void 0===i.key&&(i.key=e),a.push(i))})),a}e.a=u},247:function(t,e,n){"use strict";n.d(e,"a",(function(){return h})),n.d(e,"b",(function(){return m}));n(8),n(6),n(9),n(39),n(707),n(10);var o=n(24),i=n(53),r=n(2),a=n(50),s=n(0);function u(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var l=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.rootDocument=e.defaultView?e:e.ownerDocument,this.mainElement=null,this.eventManager=new o.a(this),this.listenersCount=new WeakSet,this.container=e}var e,n,i;return e=t,(n=[{key:"useSecondaryElement",value:function(){var t=function(t){var e=b.get(t);if(e)return e.parentElement||t.appendChild(e),e;var n=(t.defaultView?t:t.ownerDocument).createElement("textarea");return b.set(t,n),n.className="HandsontableCopyPaste",n.tabIndex=-1,n.autocomplete="off",n.wrap="hard",n.value=" ",t.appendChild(n),n}(this.container);this.listenersCount.has(t)||(this.listenersCount.add(t),d(this.eventManager,t,this)),this.mainElement=t}},{key:"setFocusableElement",value:function(t){this.listenersCount.has(t)||(this.listenersCount.add(t),d(this.eventManager,t,this)),this.mainElement=t}},{key:"getFocusableElement",value:function(){return this.mainElement}},{key:"focus",value:function(){this.mainElement.value=" ",Object(a.isMobileBrowser)()||Object(s.selectElementIfAllowed)(this.mainElement)}}])&&u(e.prototype,n),i&&u(e,i),t}();Object(r.mixin)(l,i.a);var c=new WeakMap;function h(t){var e=new l(t),n=c.get(t);return n=isNaN(n)?0:n,c.set(t,n+1),e}var f=function(t,e){return function(n){return e.runLocalHooks(t,n)}};function d(t,e,n){t.addEventListener(e,"copy",f("copy",n)),t.addEventListener(e,"cut",f("cut",n)),t.addEventListener(e,"paste",f("paste",n))}var b=new WeakMap;function m(t){if(t instanceof l){var e=c.get(t.container);if((e=isNaN(e)?0:e)>0&&(e-=1),function(t){t.eventManager.clear()}(t),e<=0){e=0;var n=b.get(t.container);n&&n.parentNode&&(n.parentNode.removeChild(n),b.delete(t.container)),t.mainElement=null}c.set(t.container,e)}}},25:function(t,e,n){"use strict";n.d(e,"e",(function(){return y})),n.d(e,"o",(function(){return O}));n(27);var o,i=n(2),r=n(149),a=n(150),s=n(151),u=n(152),l=n(153),c=n(154),h=n(155),f=n(156),d=n(157),b=n(158),m=n(108),g=n(159),v=n(160);function p(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n.d(e,"a",(function(){return r.a})),n.d(e,"b",(function(){return a.a})),n.d(e,"c",(function(){return s.a})),n.d(e,"d",(function(){return u.a})),n.d(e,"g",(function(){return l.a})),n.d(e,"h",(function(){return c.a})),n.d(e,"i",(function(){return h.a})),n.d(e,"j",(function(){return f.a})),n.d(e,"k",(function(){return d.a})),n.d(e,"l",(function(){return b.a})),n.d(e,"m",(function(){return m.a})),n.d(e,"f",(function(){return g.a})),n.d(e,"n",(function(){return v.a}));var y=[d.a,b.a,s.a,u.a,a.a,f.a,h.a,v.a,c.a,l.a,r.a,m.a,g.a],C=(p(o={},m.a,m.b),p(o,g.a,g.b),p(o,d.a,d.b),p(o,b.a,b.b),p(o,s.a,s.b),p(o,u.a,u.b),p(o,a.a,a.b),p(o,f.a,f.b),p(o,h.a,h.b),p(o,v.a,v.b),p(o,c.a,c.b),p(o,l.a,l.b),p(o,r.a,r.b),o);function O(){var t={};return Object(i.objectEach)(C,(function(e,n){t[n]=e()})),t}},491:function(t,e,n){"use strict";n(11),n(12),n(13),n(33),n(8),n(30),n(17),n(18),n(6),n(31),n(9),n(10);var o=n(22),i=n(20),r=n(1),a=n(237),s=n(24),u=n(238),l=n(161),c=n(19),h=n(15),f=n(0),d=n(25);function b(t){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function m(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function g(t,e,n){return(g="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=v(t)););return t}(t,e);if(o){var i=Object.getOwnPropertyDescriptor(o,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function v(t){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function p(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function y(t,e,n){return e&&p(t.prototype,e),n&&p(t,n),t}function C(t,e){return(C=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}i.a.getSingleton().register("afterContextMenuDefaultOptions"),i.a.getSingleton().register("beforeContextMenuShow"),i.a.getSingleton().register("afterContextMenuShow"),i.a.getSingleton().register("afterContextMenuHide"),i.a.getSingleton().register("afterContextMenuExecute");var O=function(t){function e(t){var n,o,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,(n=!(i=v(e).call(this,t))||"object"!==b(i)&&"function"!=typeof i?m(o):i).eventManager=new s.a(m(n)),n.commandExecutor=new a.a(n.hot),n.itemsFactory=null,n.menu=null,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&C(t,e)}(e,t),y(e,null,[{key:"DEFAULT_ITEMS",get:function(){return[d.k,d.l,d.m,d.c,d.d,d.m,d.j,d.i,d.m,d.n,d.h,d.m,d.g,d.m,d.a]}}]),y(e,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().contextMenu}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){var n=this.hot.getSettings().contextMenu;"function"==typeof n.callback&&this.commandExecutor.setCommonCallback(n.callback),this.menu=new l.a(this.hot,{className:"htContextMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",(function(){return t.onMenuBeforeOpen()})),this.menu.addLocalHook("afterOpen",(function(){return t.onMenuAfterOpen()})),this.menu.addLocalHook("afterClose",(function(){return t.onMenuAfterClose()})),this.menu.addLocalHook("executeCommand",(function(){for(var e,n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(e=t.executeCommand).call.apply(e,[t].concat(o))})),this.addHook("afterOnCellContextMenu",(function(e){return t.onAfterOnCellContextMenu(e)})),g(v(e.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),g(v(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),g(v(e.prototype),"disablePlugin",this).call(this)}},{key:"open",value:function(t){if(this.menu&&(this.prepareMenuItems(),this.menu.open(),this.menu.isOpened())){var e=0,n=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var o=this.hot.rootWindow.frameElement.getBoundingClientRect(),i=o.top,r=o.left;e=i-Object(f.getWindowScrollTop)(t.view),n=r-Object(f.getWindowScrollLeft)(t.view)}else e=-1*Object(f.getWindowScrollTop)(this.menu.hotMenu.rootWindow),n=-1*Object(f.getWindowScrollLeft)(this.menu.hotMenu.rootWindow);this.menu.setPosition({top:parseInt(Object(h.pageY)(t),10)+e,left:parseInt(Object(h.pageX)(t),10)+n}),this.menu.hotMenu.isHotTableEnv=this.hot.isHotTableEnv}}},{key:"close",value:function(){this.menu&&(this.menu.close(),this.itemsFactory=null)}},{key:"executeCommand",value:function(t){var e;null===this.itemsFactory&&this.prepareMenuItems();for(var n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];(e=this.commandExecutor).execute.apply(e,[t].concat(o))}},{key:"prepareMenuItems",value:function(){var t=this;this.itemsFactory=new u.a(this.hot,e.DEFAULT_ITEMS);var n=this.hot.getSettings().contextMenu,o={items:this.itemsFactory.getItems(n)};this.hot.runHooks("afterContextMenuDefaultOptions",o),this.itemsFactory.setPredefinedItems(o.items);var i=this.itemsFactory.getItems(n);this.hot.runHooks("beforeContextMenuSetItems",i),this.menu.setMenuItems(i),Object(r.arrayEach)(i,(function(e){return t.commandExecutor.registerCommand(e.key,e)}))}},{key:"onAfterOnCellContextMenu",value:function(t){var e=this.hot.getSettings(),n=e.rowHeaders,o=e.colHeaders;var i=t.realTarget;this.close(),Object(f.hasClass)(i,"handsontableInput")||(t.preventDefault(),Object(h.stopPropagation)(t),(n||o||function(t){return"TD"===t.nodeName||"TD"===t.parentNode.nodeName}(i)||Object(f.hasClass)(i,"current")&&Object(f.hasClass)(i,"wtBorder"))&&this.open(t))}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeContextMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterContextMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),g(v(e.prototype),"destroy",this).call(this)}}]),e}(o.a);O.SEPARATOR={name:d.m},Object(c.d)("contextMenu",O),e.a=O},492:function(t,e,n){"use strict";n(11),n(12),n(13),n(27),n(8),n(85),n(30),n(17),n(18),n(6),n(31),n(16),n(9),n(39),n(10);var o=n(22),i=n(20),r=n(128),a=n.n(r),s=n(1),u=n(4),l=n(0),c=n(19),h=n(596),f=n(597),d=n(598),b=n(247),m=n(117);function g(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t))&&"[object Arguments]"!==Object.prototype.toString.call(t))return;var n=[],o=!0,i=!1,r=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){i=!0,r=t}finally{try{o||null==s.return||s.return()}finally{if(i)throw r}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function v(t){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function p(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function y(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function C(t,e,n){return(C="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=O(t)););return t}(t,e);if(o){var i=Object.getOwnPropertyDescriptor(o,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function O(t){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function M(t,e){return(M=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}i.a.getSingleton().register("afterCopyLimit"),i.a.getSingleton().register("modifyCopyableRange"),i.a.getSingleton().register("beforeCut"),i.a.getSingleton().register("afterCut"),i.a.getSingleton().register("beforePaste"),i.a.getSingleton().register("afterPaste"),i.a.getSingleton().register("beforeCopy"),i.a.getSingleton().register("afterCopy");var k=new WeakMap,E=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join(""),S=function(t){function e(t){var n,o,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,(n=!(i=O(e).call(this,t))||"object"!==v(i)&&"function"!=typeof i?y(o):i).columnsLimit=1e3,n.copyableRanges=[],n.focusableElement=void 0,n.pasteMode="overwrite",n.rowsLimit=1e3,n.uiContainer=n.hot.rootDocument.body,k.set(y(n),{isTriggeredByCopy:!1,isTriggeredByCut:!1,isBeginEditing:!1,isFragmentSelectionEnabled:!1}),n}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&M(t,e)}(e,t),n=e,(o=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().copyPaste}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){var n=this.hot.getSettings(),o=n.copyPaste,i=n.fragmentSelection;k.get(this).isFragmentSelectionEnabled=!!i,"object"===v(o)&&(this.pasteMode=o.pasteMode||this.pasteMode,this.rowsLimit=isNaN(o.rowsLimit)?this.rowsLimit:o.rowsLimit,this.columnsLimit=isNaN(o.columnsLimit)?this.columnsLimit:o.columnsLimit,this.uiContainer=o.uiContainer||this.uiContainer),this.addHook("afterContextMenuDefaultOptions",(function(e){return t.onAfterContextMenuDefaultOptions(e)})),this.addHook("afterOnCellMouseUp",(function(){return t.onAfterOnCellMouseUp()})),this.addHook("afterSelectionEnd",(function(){return t.onAfterSelectionEnd()})),this.addHook("beforeKeyDown",(function(){return t.onBeforeKeyDown()})),this.focusableElement=Object(b.a)(this.uiContainer),this.focusableElement.addLocalHook("copy",(function(e){return t.onCopy(e)})).addLocalHook("cut",(function(e){return t.onCut(e)})).addLocalHook("paste",(function(e){return t.onPaste(e)})),C(O(e.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),C(O(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.focusableElement&&Object(b.b)(this.focusableElement),C(O(e.prototype),"disablePlugin",this).call(this)}},{key:"copy",value:function(){k.get(this).isTriggeredByCopy=!0,this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("copy")}},{key:"cut",value:function(){k.get(this).isTriggeredByCut=!0,this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("cut")}},{key:"getRangedCopyableData",value:function(t){var e=this,n=[],o=[],i=[];return Object(s.arrayEach)(t,(function(t){Object(u.rangeEach)(t.startRow,t.endRow,(function(t){-1===o.indexOf(t)&&o.push(t)})),Object(u.rangeEach)(t.startCol,t.endCol,(function(t){-1===i.indexOf(t)&&i.push(t)}))})),Object(s.arrayEach)(o,(function(t){var o=[];Object(s.arrayEach)(i,(function(n){o.push(e.hot.getCopyableData(t,n))})),n.push(o)})),a.a.stringify(n)}},{key:"getRangedData",value:function(t){var e=this,n=[],o=[],i=[];return Object(s.arrayEach)(t,(function(t){Object(u.rangeEach)(t.startRow,t.endRow,(function(t){-1===o.indexOf(t)&&o.push(t)})),Object(u.rangeEach)(t.startCol,t.endCol,(function(t){-1===i.indexOf(t)&&i.push(t)}))})),Object(s.arrayEach)(o,(function(t){var o=[];Object(s.arrayEach)(i,(function(n){o.push(e.hot.getCopyableData(t,n))})),n.push(o)})),n}},{key:"paste",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;if(t||e){var n=new d.a;t&&n.clipboardData.setData("text/plain",t),e&&n.clipboardData.setData("text/html",e),this.getOrCreateFocusableElement(),this.onPaste(n)}}},{key:"setCopyableText",value:function(){var t=this.hot.getSelectedRangeLast();if(t){var e=t.getTopLeftCorner(),n=t.getBottomRightCorner(),o=e.row,i=e.col,r=n.row,a=n.col,s=Math.min(r,o+this.rowsLimit-1),u=Math.min(a,i+this.columnsLimit-1);this.copyableRanges.length=0,this.copyableRanges.push({startRow:o,startCol:i,endRow:s,endCol:u}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges),r===s&&a===u||this.hot.runHooks("afterCopyLimit",r-o+1,a-i+1,this.rowsLimit,this.columnsLimit)}}},{key:"getOrCreateFocusableElement",value:function(){var t=this.hot.getActiveEditor(),e=t?t.TEXTAREA:void 0;e?this.focusableElement.setFocusableElement(e):this.focusableElement.useSecondaryElement()}},{key:"isEditorOpened",value:function(){var t=this.hot.getActiveEditor();return t&&t.isOpened()}},{key:"populateValues",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.hot.getSelectedLast();if(t.length){for(var n=t.length-1,o=t[0].length-1,i=Math.min(e[0],e[2]),r=Math.max(e[0],e[2],n+i),a=Math.min(e[1],e[3]),s=Math.max(e[1],e[3],o+a),u=[],l=i,c=0;l<=r;l+=1){for(var h=[],f=a,d=0;f<=s;f+=1)h.push(t[c][d]),d=d===o?0:d+=1;u.push(h),c=c===n?0:c+=1}return this.hot.populateFromArray(i,a,u,void 0,void 0,"CopyPaste.paste",this.pasteMode),[i,a,r,s]}}},{key:"onCopy",value:function(t){var e=k.get(this);if((this.hot.isListening()||e.isTriggeredByCopy)&&!this.isEditorOpened()){this.setCopyableText(),e.isTriggeredByCopy=!1;var n=this.getRangedData(this.copyableRanges);if(this.hot.runHooks("beforeCopy",n,this.copyableRanges)){var o=a.a.stringify(n);if(t&&t.clipboardData){var i=Object(m._dataToHTML)(n,this.hot.rootDocument);t.clipboardData.setData("text/plain",o),t.clipboardData.setData("text/html",[E,i].join(""))}else"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",o);this.hot.runHooks("afterCopy",n,this.copyableRanges)}t.preventDefault()}}},{key:"onCut",value:function(t){var e=k.get(this);if((this.hot.isListening()||e.isTriggeredByCut)&&!this.isEditorOpened()){this.setCopyableText(),e.isTriggeredByCut=!1;var n=this.getRangedData(this.copyableRanges);if(this.hot.runHooks("beforeCut",n,this.copyableRanges)){var o=a.a.stringify(n);if(t&&t.clipboardData){var i=Object(m._dataToHTML)(n,this.hot.rootDocument);t.clipboardData.setData("text/plain",o),t.clipboardData.setData("text/html",[E,i].join(""))}else"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",o);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",n,this.copyableRanges)}t.preventDefault()}}},{key:"onPaste",value:function(t){if(this.hot.isListening()&&!this.isEditorOpened()){var e;if(t&&t.preventDefault&&t.preventDefault(),t&&void 0!==t.clipboardData){var n=t.clipboardData.getData("text/html");e=n&&/(<table)|(<TABLE)/g.test(n)?Object(m.htmlToGridSettings)(n,this.hot.rootDocument).data:t.clipboardData.getData("text/plain")}else"undefined"==typeof ClipboardEvent&&void 0!==this.hot.rootWindow.clipboardData&&(e=this.hot.rootWindow.clipboardData.getData("Text"));if("string"==typeof e&&(e=a.a.parse(e)),(!e||0!==e.length)&&!1!==this.hot.runHooks("beforePaste",e,this.copyableRanges)){var o=g(this.populateValues(e),4),i=o[0],r=o[1],s=o[2],u=o[3];this.hot.selectCell(i,r,Math.min(this.hot.countRows()-1,s),Math.min(this.hot.countCols()-1,u)),this.hot.runHooks("afterPaste",e,this.copyableRanges)}}}},{key:"onAfterContextMenuDefaultOptions",value:function(t){t.items.push({name:"---------"},Object(h.a)(this),Object(f.a)(this))}},{key:"onAfterOnCellMouseUp",value:function(){this.hot.isListening()&&!this.isEditorOpened()&&(this.getOrCreateFocusableElement(),this.focusableElement.focus())}},{key:"onAfterSelectionEnd",value:function(){var t=k.get(this).isFragmentSelectionEnabled;this.isEditorOpened()||(this.getOrCreateFocusableElement(),t&&this.focusableElement.getFocusableElement()!==this.hot.rootDocument.activeElement&&Object(l.getSelectionText)()||(this.setCopyableText(),this.focusableElement.focus()))}},{key:"onBeforeKeyDown",value:function(){if(this.hot.isListening()&&!this.isEditorOpened()){var t=this.hot.rootDocument.activeElement,e=this.hot.getActiveEditor();!e||t!==this.focusableElement.getFocusableElement()&&t!==e.select||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}}},{key:"destroy",value:function(){this.focusableElement&&(Object(b.b)(this.focusableElement),this.focusableElement=null),C(O(e.prototype),"destroy",this).call(this)}}])&&p(n.prototype,o),i&&p(n,i),e}(o.a);Object(c.d)("CopyPaste",S),e.a=S},595:function(t,e,n){"use strict";var o=n(0),i=n(15);function r(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var a=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var r,a,s,u,l,c,h=Object(o.getWindowScrollTop)(n),f=Object(o.getWindowScrollLeft)(n);this.rootWindow=n,this.type=this.getSourceType(e),"literal"===this.type?(r=parseInt(e.top,10),s=parseInt(e.left,10),l=e.height||0,c=e.width||0,a=r,u=s,r+=h,s+=f):"event"===this.type&&(r=parseInt(Object(i.pageY)(e),10),s=parseInt(Object(i.pageX)(e),10),l=e.target.clientHeight,c=e.target.clientWidth,a=r-h,u=s-f),this.top=r,this.topRelative=a,this.left=s,this.leftRelative=u,this.scrollTop=h,this.scrollLeft=f,this.cellHeight=l,this.cellWidth=c}var e,n,a;return e=t,(n=[{key:"getSourceType",value:function(t){var e="literal";return t instanceof Event&&(e="event"),e}},{key:"fitsAbove",value:function(t){return this.topRelative>=t.offsetHeight}},{key:"fitsBelow",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+t.offsetHeight<=e}},{key:"fitsOnRight",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+t.offsetWidth<=e}},{key:"fitsOnLeft",value:function(t){return this.leftRelative>=t.offsetWidth}}])&&r(e.prototype,n),a&&r(e,a),t}();e.a=a},596:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var o=n(3);function i(t){return{key:"copy",name:function(){return this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_COPY)},callback:function(){t.copy()},disabled:function(){var t=this.getSelected();return!t||t.length>1},hidden:!1}}},597:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var o=n(3);function i(t){return{key:"cut",name:function(){return this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_CUT)},callback:function(){t.cut()},disabled:function(){var t=this.getSelected();return!t||t.length>1},hidden:!1}}},598:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var o=n(599);var i=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.clipboardData=new o.a}},599:function(t,e,n){"use strict";function o(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}n.d(e,"a",(function(){return i}));var i=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.data={}}var e,n,i;return e=t,(n=[{key:"setData",value:function(t,e){this.data[t]=e}},{key:"getData",value:function(t){return this.data[t]||void 0}}])&&o(e.prototype,n),i&&o(e,i),t}()}}]);