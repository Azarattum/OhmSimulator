(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{132:function(t,e,o){"use strict";o.d(e,"b",(function(){return v})),o.d(e,"a",(function(){return E}));o(84),o(171),o(18),o(17),o(19),o(10),o(12),o(4),o(13),o(5),o(6),o(7),o(15),o(20),o(16);var n=o(11),r=o(9),i=o(2),s=o(503);function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var o=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==o)return;var n,r,i=[],s=!0,a=!1;try{for(o=o.call(t);!(s=(n=o.next()).done)&&(i.push(n.value),!e||i.length!==e);s=!0);}catch(t){a=!0,r=t}finally{try{s||null==o.return||o.return()}finally{if(a)throw r}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return l(t,e);var o=Object.prototype.toString.call(t).slice(8,-1);"Object"===o&&t.constructor&&(o=t.constructor.name);if("Map"===o||"Set"===o)return Array.from(t);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return l(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var o=0,n=new Array(e);o<e;o++)n[o]=t[o];return n}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,n=p(t);if(e){var r=p(this).constructor;o=Reflect.construct(n,arguments,r)}else o=n.apply(this,arguments);return h(this,o)}}function h(t,e){if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function d(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function y(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var v=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),E=function(){function t(e){d(this,t),this.hot=e,this.instance=e,this.state=v.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}var e,o,i;return e=t,i=[{key:"EDITOR_TYPE",get:function(){return"base"}}],(o=[{key:"_fireCallbacks",value:function(t){this._closeCallback&&(this._closeCallback(t),this._closeCallback=null)}},{key:"init",value:function(){}},{key:"getValue",value:function(){throw Error("Editor getValue() method unimplemented")}},{key:"setValue",value:function(){throw Error("Editor setValue() method unimplemented")}},{key:"open",value:function(){throw Error("Editor open() method unimplemented")}},{key:"close",value:function(){throw Error("Editor close() method unimplemented")}},{key:"prepare",value:function(t,e,o,n,r,i){this.TD=n,this.row=t,this.col=e,this.prop=o,this.originalValue=r,this.cellProperties=i,this.state=v.VIRGIN}},{key:"extend",value:function(){return function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(o,t);var e=f(o);function o(){return d(this,o),e.apply(this,arguments)}return o}(this.constructor)}},{key:"saveValue",value:function(t,e){var o,n,r,i;if(e){var s=this.hot.getSelectedLast();o=Math.max(Math.min(s[0],s[2]),0),n=Math.max(Math.min(s[1],s[3]),0),r=Math.max(s[0],s[2]),i=Math.max(s[1],s[3])}else{var a=[this.row,this.col,null,null];o=a[0],n=a[1],r=a[2],i=a[3]}var l=this.hot.runHooks("modifyGetCellCoords",o,n);if(Array.isArray(l)){var u=c(l,2);o=u[0],n=u[1]}this.hot.populateFromArray(o,n,t,r,i,"edit")}},{key:"beginEditing",value:function(t,e){if(this.state===v.VIRGIN){var o=this.hot,i=o.rowIndexMapper.getRenderableFromVisualIndex(this.row),s=o.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(o.view.scrollViewport(new n.a(i,s)),this.state=v.EDITING,this.isInFullEditMode()){var a="string"==typeof t?t:Object(r.stringify)(this.originalValue);this.setValue(a)}this.open(e),this._opened=!0,this.focus(),o.view.render(),o.runHooks("afterBeginEditing",this.row,this.col)}}},{key:"finishEditing",value:function(t,e,o){var n,r=this;if(o){var i=this._closeCallback;this._closeCallback=function(t){i&&i(t),o(t),r.hot.view.render()}}if(!this.isWaiting())if(this.state!==v.VIRGIN){if(this.state===v.EDITING){if(t)return this.cancelChanges(),void this.hot.view.render();var s=this.getValue();n=this.hot.getSettings().trimWhitespace?[["string"==typeof s?String.prototype.trim.call(s||""):s]]:[[s]],this.state=v.WAITING,this.saveValue(n,e),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",(function(t){r.state=v.FINISHED,r.discardEditor(t)})):(this.state=v.FINISHED,this.discardEditor(!0))}}else this.hot._registerTimeout((function(){r._fireCallbacks(!0)}))}},{key:"cancelChanges",value:function(){this.state=v.FINISHED,this.discardEditor()}},{key:"discardEditor",value:function(t){this.state===v.FINISHED&&(!1===t&&!0!==this.cellProperties.allowInvalid?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=v.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=v.VIRGIN,this._fireCallbacks(!0)))}},{key:"enableFullEditMode",value:function(){this._fullEditMode=!0}},{key:"isInFullEditMode",value:function(){return this._fullEditMode}},{key:"isOpened",value:function(){return this._opened}},{key:"isWaiting",value:function(){return this.state===v.WAITING}},{key:"getEditedCellsLayerClass",value:function(){switch(this.checkEditorSection()){case"right":return"ht_clone_right";case"left":return"ht_clone_left";case"bottom":return"ht_clone_bottom";case"bottom-right-corner":return"ht_clone_bottom_right_corner";case"bottom-left-corner":return"ht_clone_bottom_left_corner";case"top":return"ht_clone_top";case"top-right-corner":return"ht_clone_top_right_corner";case"top-left-corner":return"ht_clone_top_left_corner";default:return"ht_clone_master"}}},{key:"getEditedCell",value:function(){return this.hot.getCell(this.row,this.col,!0)}},{key:"checkEditorSection",value:function(){var t=this.hot.countRows(),e="";return this.row<this.hot.getSettings().fixedRowsTop?e=this.col<this.hot.getSettings().fixedColumnsLeft?"top-left-corner":"top":this.hot.getSettings().fixedRowsBottom&&this.row>=t-this.hot.getSettings().fixedRowsBottom?e=this.col<this.hot.getSettings().fixedColumnsLeft?"bottom-left-corner":"bottom":this.col<this.hot.getSettings().fixedColumnsLeft&&(e="left"),e}}])&&y(e.prototype,o),i&&y(e,i),t}();Object(i.mixin)(E,s.a)},166:function(t,e,o){"use strict";o.d(e,"a",(function(){return g}));o(42),o(32),o(15),o(26),o(18),o(17),o(19),o(31),o(23),o(10),o(12),o(4),o(13),o(5),o(6),o(7);var n=o(132),r=o(28),i=o(41),s=o(0),a=o(25),c=o(14),l=o(22),u=o(719);function f(t){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function h(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function p(t,e,o){return(p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,o){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=b(t)););return t}(t,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(o):r.value}})(t,e,o||t)}function d(t,e){return(d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function y(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,n=b(t);if(e){var r=b(this).constructor;o=Reflect.construct(n,arguments,r)}else o=n.apply(this,arguments);return v(this,o)}}function v(t,e){if(e&&("object"===f(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return E(t)}function E(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function b(t){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}(g,t);var e,o,f,v=y(g);function g(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,g),(e=v.call(this,t)).eventManager=new r.a(E(e)),e.autoResize=Object(u.a)(),e.TEXTAREA=void 0,e.textareaStyle=void 0,e.TEXTAREA_PARENT=void 0,e.textareaParentStyle=void 0,e.layerClass=void 0,e.createElements(),e.bindEvents(),e.hot.addHookOnce("afterDestroy",(function(){return e.destroy()})),e}return e=g,f=[{key:"EDITOR_TYPE",get:function(){return"text"}}],(o=[{key:"getValue",value:function(){return this.TEXTAREA.value}},{key:"setValue",value:function(t){this.TEXTAREA.value=t}},{key:"open",value:function(){var t=this;this.refreshDimensions(),this.showEditableElement(),this.addHook("beforeKeyDown",(function(e){return t.onBeforeKeyDown(e)}))}},{key:"close",value:function(){this.autoResize.unObserve(),this.hot.rootDocument.activeElement===this.TEXTAREA&&this.hot.listen(),this.hideEditableElement(),this.removeHooksByKey("beforeKeyDown")}},{key:"prepare",value:function(t,e,o,r,s,a){var c=this.state;if(p(b(g.prototype),"prepare",this).call(this,t,e,o,r,s,a),!a.readOnly){this.refreshDimensions(!0);var l=a.allowInvalid,u=a.fragmentSelection;l&&(this.TEXTAREA.value=""),c!==n.b.FINISHED&&this.hideEditableElement(),!u&&!Object(i.isMobileBrowser)()&&this.focus()}}},{key:"beginEditing",value:function(t,e){this.state===n.b.VIRGIN&&(this.TEXTAREA.value="",p(b(g.prototype),"beginEditing",this).call(this,t,e))}},{key:"focus",value:function(){this.TEXTAREA.select(),Object(s.setCaretPosition)(this.TEXTAREA,this.TEXTAREA.value.length)}},{key:"createElements",value:function(){var t=this.hot.rootDocument;this.TEXTAREA=t.createElement("TEXTAREA"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.tabIndex=-1,Object(s.addClass)(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=t.createElement("DIV"),Object(s.addClass)(this.TEXTAREA_PARENT,"handsontableInputHolder"),Object(s.hasClass)(this.TEXTAREA_PARENT,this.layerClass)&&Object(s.removeClass)(this.TEXTAREA_PARENT,this.layerClass),Object(s.addClass)(this.TEXTAREA_PARENT,"ht_editor_hidden"),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}},{key:"hideEditableElement",value:function(){(Object(i.isIE)()||Object(i.isEdge)())&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Object(s.hasClass)(this.TEXTAREA_PARENT,this.layerClass)&&Object(s.removeClass)(this.TEXTAREA_PARENT,this.layerClass),Object(s.addClass)(this.TEXTAREA_PARENT,"ht_editor_hidden")}},{key:"showEditableElement",value:function(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle.right="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";var t=this.TEXTAREA_PARENT.childNodes,e=!1;Object(c.rangeEach)(t.length-1,(function(o){var n=t[o];if(Object(s.hasClass)(n,"handsontableEditor"))return e=!0,!1})),Object(s.hasClass)(this.TEXTAREA_PARENT,"ht_editor_hidden")&&Object(s.removeClass)(this.TEXTAREA_PARENT,"ht_editor_hidden"),e?(this.layerClass="ht_editor_visible",Object(s.addClass)(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),Object(s.addClass)(this.TEXTAREA_PARENT,this.layerClass))}},{key:"refreshValue",value:function(){var t=this.hot.toPhysicalRow(this.row),e=this.hot.getSourceDataAtCell(t,this.col);this.originalValue=e,this.setValue(e),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.state===n.b.EDITING||t)if(this.TD=this.getEditedCell(),this.TD){var e,o=this.hot.view.wt,r=o.wtOverlays,i=o.wtViewport,a=Object(s.offset)(this.TD),c=Object(s.offset)(this.hot.rootElement),l=r.topOverlay.holder,u=r.leftOverlay.holder,f=l!==this.hot.rootWindow?l.scrollTop:0,h=u!==this.hot.rootWindow?u.scrollLeft:0,p=this.checkEditorSection(),d=["","left"].includes(p)?f:0,y=["","top","bottom"].includes(p)?h:0,v=a.top===c.top?0:1,E=this.TD.style.backgroundColor,b=a.top-c.top-v-d,g=a.left-c.left-1-y;switch(p){case"top":e=Object(s.getCssTransform)(r.topOverlay.clone.wtTable.holder.parentNode);break;case"left":e=Object(s.getCssTransform)(r.leftOverlay.clone.wtTable.holder.parentNode);break;case"top-left-corner":e=Object(s.getCssTransform)(r.topLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom-left-corner":e=Object(s.getCssTransform)(r.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom":e=Object(s.getCssTransform)(r.bottomOverlay.clone.wtTable.holder.parentNode)}var m=this.hot.hasColHeaders(),O=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),w=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),T=this.hot.rowIndexMapper.getRenderableIndexesLength(),R=T-this.hot.view.wt.getSetting("fixedRowsBottom");(m&&O<=0||O===R)&&(b+=1),w<=0&&(g+=1),e&&-1!==e?this.textareaParentStyle[e[0]]=e[1]:Object(s.resetCssTransform)(this.TEXTAREA_PARENT),this.textareaParentStyle.top="".concat(b,"px"),this.textareaParentStyle.left="".concat(g,"px"),this.showEditableElement();var k=i.rowsRenderCalculator.startPosition,S=i.columnsRenderCalculator.startPosition,C=r.leftOverlay.getScrollPosition(),A=r.topOverlay.getScrollPosition(),P=Object(s.getScrollbarWidth)(this.hot.rootDocument),_=this.TD.offsetTop+k-A,D=this.TD.offsetLeft+S-C,j=Object(s.innerWidth)(this.TD)-8,I=Object(s.hasVerticalScrollbar)(l)?P:0,x=Object(s.hasHorizontalScrollbar)(u)?P:0,N=this.hot.view.maximumVisibleElementWidth(D)-9-I,M=this.TD.scrollHeight+1,K=Math.max(this.hot.view.maximumVisibleElementHeight(_)-x,23),V=Object(s.getComputedStyle)(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=V.fontSize,this.TEXTAREA.style.fontFamily=V.fontFamily,this.TEXTAREA.style.backgroundColor=E,this.autoResize.init(this.TEXTAREA,{minHeight:Math.min(M,K),maxHeight:K,minWidth:Math.min(j,N),maxWidth:N},!0)}else t||this.close()}},{key:"bindEvents",value:function(){var t=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",(function(t){return t.stopPropagation()})),this.eventManager.addEventListener(this.TEXTAREA,"paste",(function(t){return t.stopPropagation()})),Object(i.isIOS)()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",(function(){return t.finishEditing(!1)})),this.addHook("afterScrollHorizontally",(function(){return t.refreshDimensions()})),this.addHook("afterScrollVertically",(function(){return t.refreshDimensions()})),this.addHook("afterColumnResize",(function(){t.refreshDimensions(),t.focus()})),this.addHook("afterRowResize",(function(){t.refreshDimensions(),t.focus()}))}},{key:"allowKeyEventPropagation",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.clearHooks()}},{key:"onBeforeKeyDown",value:function(t){var e=(t.ctrlKey||t.metaKey)&&!t.altKey;if(t.target===this.TEXTAREA&&!Object(a.isImmediatePropagationStopped)(t)){switch(t.keyCode){case l.KEY_CODES.ARROW_RIGHT:case l.KEY_CODES.ARROW_LEFT:this.isInFullEditMode()&&(this.isWaiting()||this.allowKeyEventPropagation(t.keyCode)||Object(a.stopImmediatePropagation)(t));break;case l.KEY_CODES.ARROW_UP:case l.KEY_CODES.ARROW_DOWN:this.isInFullEditMode()&&(this.isWaiting()||this.allowKeyEventPropagation(t.keyCode)||Object(a.stopImmediatePropagation)(t));break;case l.KEY_CODES.ENTER:var o=this.hot.selection.isMultiple();if(e&&!o||t.altKey){if(this.isOpened()){var n=Object(s.getCaretPosition)(this.TEXTAREA),r=this.getValue(),i="".concat(r.slice(0,n),"\n").concat(r.slice(n));this.setValue(i),Object(s.setCaretPosition)(this.TEXTAREA,n+1)}else this.beginEditing("".concat(this.originalValue,"\n"));Object(a.stopImmediatePropagation)(t)}t.preventDefault();break;case l.KEY_CODES.BACKSPACE:case l.KEY_CODES.DELETE:case l.KEY_CODES.HOME:case l.KEY_CODES.END:Object(a.stopImmediatePropagation)(t)}-1===[l.KEY_CODES.ARROW_UP,l.KEY_CODES.ARROW_RIGHT,l.KEY_CODES.ARROW_DOWN,l.KEY_CODES.ARROW_LEFT].indexOf(t.keyCode)&&this.autoResize.resize(String.fromCharCode(t.keyCode))}}}])&&h(e.prototype,o),f&&h(e,f),g}(n.a)},326:function(t,e,o){"use strict";o.d(e,"a",(function(){return g}));o(5),o(4),o(6),o(40),o(7),o(26),o(231),o(53),o(96),o(47),o(119),o(18),o(17),o(19),o(31),o(23),o(10),o(12),o(13);var n=o(327),r=o(1),i=o(0),s=o(9),a=o(44),c=o(22),l=o(165);function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function f(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function h(t,e,o){return(h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,o){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=E(t)););return t}(t,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(o):r.value}})(t,e,o||t)}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function d(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,n=E(t);if(e){var r=E(this).constructor;o=Reflect.construct(n,arguments,r)}else o=n.apply(this,arguments);return y(this,o)}}function y(t,e){if(e&&("object"===u(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return v(t)}function v(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function E(t){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var b=new WeakMap,g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}(y,t);var e,o,n,u=d(y);function y(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,y),(e=u.call(this,t)).query=null,e.strippedChoices=[],e.rawChoices=[],b.set(v(e),{skipOne:!1,isMacOS:e.hot.rootWindow.navigator.platform.indexOf("Mac")>-1}),e}return e=y,n=[{key:"EDITOR_TYPE",get:function(){return"autocomplete"}}],(o=[{key:"getValue",value:function(){var t=this,e=this.rawChoices.find((function(e){return t.stripValueIfNeeded(e)===t.TEXTAREA.value}));return Object(s.isDefined)(e)?e:this.TEXTAREA.value}},{key:"createElements",value:function(){h(E(y.prototype),"createElements",this).call(this),Object(i.addClass)(this.htContainer,"autocompleteEditor"),Object(i.addClass)(this.htContainer,-1===this.hot.rootWindow.navigator.platform.indexOf("Mac")?"":"htMacScroll")}},{key:"open",value:function(){var t=this,e=b.get(this);h(E(y.prototype),"open",this).call(this);var o=this.htEditor.getInstance(),n=void 0===this.cellProperties.trimDropdown||this.cellProperties.trimDropdown;this.showEditableElement(),this.focus();var r=Object(i.getScrollbarWidth)();0===r&&e.isMacOS&&(r+=15),o.updateSettings({colWidths:n?[Object(i.outerWidth)(this.TEXTAREA)-2]:void 0,width:n?Object(i.outerWidth)(this.TEXTAREA)+r:void 0,renderer:function(e,o,n,r,i,a,c){Object(l.a)(e,o,n,r,i,a,c);var u,f,h=t.cellProperties,p=h.filteringCaseSensitive,d=h.allowHtml,y=t.query,v=Object(s.stringify)(a);v&&!d&&-1!==(u=!0===p?v.indexOf(y):v.toLowerCase().indexOf(y.toLowerCase()))&&(f=v.substr(u,y.length),v=v.replace(f,"<strong>".concat(f,"</strong>"))),o.innerHTML=v},autoColumnSize:!0}),e.skipOne&&(e.skipOne=!1),this.hot._registerTimeout((function(){t.queryChoices(t.TEXTAREA.value)}))}},{key:"close",value:function(){this.removeHooksByKey("beforeKeyDown"),h(E(y.prototype),"close",this).call(this)}},{key:"discardEditor",value:function(t){h(E(y.prototype),"discardEditor",this).call(this,t),this.hot.view.render()}},{key:"queryChoices",value:function(t){var e=this,o=this.cellProperties.source;this.query=t,"function"==typeof o?o.call(this.cellProperties,t,(function(t){e.rawChoices=t,e.updateChoicesList(e.stripValuesIfNeeded(t))})):Array.isArray(o)?(this.rawChoices=o,this.updateChoicesList(this.stripValuesIfNeeded(o))):this.updateChoicesList([])}},{key:"updateChoicesList",value:function(t){var e=Object(i.getCaretPosition)(this.TEXTAREA),o=Object(i.getSelectionEndPosition)(this.TEXTAREA),n=this.cellProperties.sortByRelevance,s=this.cellProperties.filter,a=null,c=null,l=t;n&&(a=y.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));var u=Array.isArray(a)?a.length:0;if(!1===s)u&&(c=a[0]);else{for(var f=[],h=0,p=l.length;h<p&&!(n&&u<=h);h++)u?f.push(l[a[h]]):f.push(l[h]);c=0,l=f}this.strippedChoices=l,this.htEditor.loadData(Object(r.pivot)([l])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),!0===this.cellProperties.strict&&this.highlightBestMatchingChoice(c),this.hot.listen(),Object(i.setCaretPosition)(this.TEXTAREA,e,e===o?void 0:o)}},{key:"flipDropdownIfNeeded",value:function(){var t=Object(i.offset)(this.TEXTAREA),e=Object(i.outerHeight)(this.TEXTAREA),o=this.getDropdownHeight(),n=Object(i.getTrimmingContainer)(this.hot.view.wt.wtTable.TABLE),r=n.scrollTop,s=Object(i.outerHeight)(this.hot.view.wt.wtTable.THEAD),a={row:0,col:0};n!==this.hot.rootWindow&&(a=Object(i.offset)(n));var c=t.top-a.top-s+r,l=n.scrollHeight-c-s-e,u=o>l&&c>l;return u?this.flipDropdown(o):this.unflipDropdown(),this.limitDropdownIfNeeded(u?c:l,o),u}},{key:"limitDropdownIfNeeded",value:function(t,e){if(e>t){var o,n=0,r=0,i=0;do{n+=i=this.htEditor.getRowHeight(r)||this.htEditor.view.wt.wtSettings.settings.defaultRowHeight,r+=1}while(n<t);o=n-i,this.htEditor.flipped&&(this.htEditor.rootElement.style.top="".concat(parseInt(this.htEditor.rootElement.style.top,10)+e-o,"px")),this.setDropdownHeight(n-i)}}},{key:"flipDropdown",value:function(t){var e=this.htEditor.rootElement.style;e.position="absolute",e.top="".concat(-t,"px"),this.htEditor.flipped=!0}},{key:"unflipDropdown",value:function(){var t=this.htEditor.rootElement.style;"absolute"===t.position&&(t.position="",t.top=""),this.htEditor.flipped=void 0}},{key:"updateDropdownHeight",value:function(){var t=this.htEditor.getColWidth(0)+Object(i.getScrollbarWidth)(this.hot.rootDocument)+2,e=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:e?void 0:t}),this.htEditor.view.wt.wtTable.alignOverlaysWithTrimmingContainer()}},{key:"setDropdownHeight",value:function(t){this.htEditor.updateSettings({height:t})}},{key:"highlightBestMatchingChoice",value:function(t){"number"==typeof t?this.htEditor.selectCell(t,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}},{key:"getDropdownHeight",value:function(){var t=this.htEditor.getInstance().getRowHeight(0)||23,e=this.cellProperties.visibleRows;return this.strippedChoices.length>=e?e*t:this.strippedChoices.length*t+8}},{key:"stripValueIfNeeded",value:function(t){return this.stripValuesIfNeeded([t])[0]}},{key:"stripValuesIfNeeded",value:function(t){var e=this.cellProperties.allowHtml,o=Object(r.arrayMap)(t,(function(t){return Object(s.stringify)(t)}));return Object(r.arrayMap)(o,(function(t){return e?t:Object(a.stripTags)(t)}))}},{key:"allowKeyEventPropagation",value:function(t){var e=this.htEditor.getSelectedRangeLast(),o=e?e.from.row:-1,n=!1;return t===c.KEY_CODES.ARROW_DOWN&&o>0&&o<this.htEditor.countRows()-1&&(n=!0),t===c.KEY_CODES.ARROW_UP&&o>-1&&(n=!0),n}},{key:"onBeforeKeyDown",value:function(t){var e=this,o=b.get(this);if(o.skipOne=!1,Object(c.isPrintableChar)(t.keyCode)||t.keyCode===c.KEY_CODES.BACKSPACE||t.keyCode===c.KEY_CODES.DELETE||t.keyCode===c.KEY_CODES.INSERT){var n=0;if(t.keyCode===c.KEY_CODES.C&&(t.ctrlKey||t.metaKey))return;this.isOpened()||(n+=10),this.htEditor&&this.hot._registerTimeout((function(){e.queryChoices(e.TEXTAREA.value),o.skipOne=!0}),n)}h(E(y.prototype),"onBeforeKeyDown",this).call(this,t)}}])&&f(e.prototype,o),n&&f(e,n),y}(n.a);g.sortByRelevance=function(t,e,o){var n,r,i,c,l=[],u=[],f=t.length,h=e.length;if(0===f){for(i=0;i<h;i++)u.push(i);return u}for(i=0;i<h;i++)r=Object(a.stripTags)(Object(s.stringify)(e[i])),-1!==(c=o?r.indexOf(t):r.toLowerCase().indexOf(t.toLowerCase()))&&(n=r.length-c-f,l.push({baseIndex:i,index:c,charsLeft:n,value:r}));for(l.sort((function(t,e){if(-1===e.index)return-1;if(-1===t.index)return 1;if(t.index<e.index)return-1;if(e.index<t.index)return 1;if(t.index===e.index){if(t.charsLeft<e.charsLeft)return-1;if(t.charsLeft>e.charsLeft)return 1}return 0})),i=0,h=l.length;i<h;i++)u.push(l[i].baseIndex);return u}},327:function(t,e,o){"use strict";o.d(e,"a",(function(){return v}));o(18),o(17),o(19),o(31),o(23),o(10),o(12),o(4),o(13),o(5),o(6),o(7);var n=o(166),r=o(0),i=o(25),s=o(22),a=o(2);function c(t){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function f(t,e,o){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,o){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=y(t)););return t}(t,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(o):r.value}})(t,e,o||t)}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function p(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,n=y(t);if(e){var r=y(this).constructor;o=Reflect.construct(n,arguments,r)}else o=n.apply(this,arguments);return d(this,o)}}function d(t,e){if(e&&("object"===c(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function y(t){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var v=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(d,t);var e,o,n,c=p(d);function d(){return l(this,d),c.apply(this,arguments)}return e=d,n=[{key:"EDITOR_TYPE",get:function(){return"handsontable"}}],(o=[{key:"open",value:function(){f(y(d.prototype),"open",this).call(this),this.htEditor&&this.htEditor.destroy(),"none"===this.htContainer.style.display&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Object(r.setCaretPosition)(this.TEXTAREA,0,this.TEXTAREA.value.length)}},{key:"close",value:function(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),f(y(d.prototype),"close",this).call(this)}},{key:"prepare",value:function(t,e,o,n,r,i){f(y(d.prototype),"prepare",this).call(this,t,e,o,n,r,i);var s=this,c={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,afterOnCellMouseDown:function(t,e){var o=this.getSourceData(e.row,e.col);void 0!==o&&s.setValue(o),s.instance.destroyEditor()},preventWheel:!0};this.cellProperties.handsontable&&Object(a.extend)(c,i.handsontable),this.htOptions=c}},{key:"beginEditing",value:function(t,e){var o=this.hot.getSettings().onBeginEditing;o&&!1===o()||f(y(d.prototype),"beginEditing",this).call(this,t,e)}},{key:"createElements",value:function(){f(y(d.prototype),"createElements",this).call(this);var t=this.hot.rootDocument.createElement("DIV");t.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(t),this.htContainer=t,this.assignHooks()}},{key:"finishEditing",value:function(t,e,o){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){var n=this.htEditor.getInstance().getValue();void 0!==n&&this.setValue(n)}f(y(d.prototype),"finishEditing",this).call(this,t,e,o)}},{key:"assignHooks",value:function(){var t=this;this.hot.addHook("afterDestroy",(function(){t.htEditor&&t.htEditor.destroy()}))}},{key:"onBeforeKeyDown",value:function(t){if(!Object(i.isImmediatePropagationStopped)(t)){var e,o,n=this.htEditor.getInstance();if(t.keyCode===s.KEY_CODES.ARROW_DOWN)if(n.getSelectedLast()||n.flipped){if(n.getSelectedLast())if(n.flipped)e=n.getSelectedLast()[0]+1;else if(!n.flipped){var r=n.countRows()-1;o=n.getSelectedLast()[0],e=Math.min(r,o+1)}}else e=0;else t.keyCode===s.KEY_CODES.ARROW_UP&&(!n.getSelectedLast()&&n.flipped?e=n.countRows()-1:n.getSelectedLast()&&(n.flipped?(o=n.getSelectedLast()[0],e=Math.max(0,o-1)):e=(o=n.getSelectedLast()[0])-1));void 0!==e&&(e<0||n.flipped&&e>n.countRows()-1?n.deselectCell():n.selectCell(e,0),n.getData().length&&(t.preventDefault(),Object(i.stopImmediatePropagation)(t),this.hot.listen(),this.TEXTAREA.focus())),f(y(d.prototype),"onBeforeKeyDown",this).call(this,t)}}}])&&u(e.prototype,o),n&&u(e,n),d}(n.a)},328:function(t,e,o){"use strict";o.d(e,"b",(function(){return E})),o.d(e,"a",(function(){return b}));o(18),o(17),o(19),o(31),o(23),o(10),o(12),o(4),o(13),o(5),o(6),o(7);var n=o(8),r=o(302),i=o(166),s=o(28),a=o(0),c=o(2),l=o(22);function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function f(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function h(t,e,o){return(h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,o){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=v(t)););return t}(t,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(o):r.value}})(t,e,o||t)}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function d(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,n=v(t);if(e){var r=v(this).constructor;o=Reflect.construct(n,arguments,r)}else o=n.apply(this,arguments);return y(this,o)}}function y(t,e){if(e&&("object"===u(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function v(t){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var E="date",b=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}(y,t);var e,o,i,u=d(y);function y(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,y),(e=u.call(this,t)).defaultDateFormat="DD/MM/YYYY",e.isCellEdited=!1,e.parentDestroyed=!1,e.$datePicker=null,e}return e=y,i=[{key:"EDITOR_TYPE",get:function(){return E}}],(o=[{key:"init",value:function(){var t=this;if("function"!=typeof n)throw new Error("You need to include moment.js to your project.");if("function"!=typeof r)throw new Error("You need to include Pikaday to your project.");h(v(y.prototype),"init",this).call(this),this.instance.addHook("afterDestroy",(function(){t.parentDestroyed=!0,t.destroyElements()}))}},{key:"createElements",value:function(){h(v(y.prototype),"createElements",this).call(this),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,Object(a.addClass)(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker),new s.a(this).addEventListener(this.datePicker,"mousedown",(function(t){return t.stopPropagation()}))}},{key:"destroyElements",value:function(){var t=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),t&&t.removeChild(this.datePicker)}},{key:"prepare",value:function(t,e,o,n,r,i){h(v(y.prototype),"prepare",this).call(this,t,e,o,n,r,i)}},{key:"open",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;h(v(y.prototype),"open",this).call(this),this.showDatepicker(t)}},{key:"close",value:function(){var t=this;this._opened=!1,this.$datePicker.destroy(),this.instance._registerTimeout((function(){t.instance._refreshBorders()})),h(v(y.prototype),"close",this).call(this)}},{key:"finishEditing",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t){var o=this.originalValue;void 0!==o&&this.setValue(o)}h(v(y.prototype),"finishEditing",this).call(this,t,e)}},{key:"showDatepicker",value:function(t){var e,o=this.TD.getBoundingClientRect(),i=this.cellProperties.dateFormat||this.defaultDateFormat,s=this.instance.view.isMouseDown(),c=!!t&&Object(l.isFunctionKey)(t.keyCode);this.datePickerStyle.top="".concat(this.hot.rootWindow.pageYOffset+o.top+Object(a.outerHeight)(this.TD),"px"),this.datePickerStyle.left="".concat(this.hot.rootWindow.pageXOffset+o.left,"px"),this.$datePicker=new r(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.originalValue?(e=this.originalValue,n(e,i,!0).isValid()&&this.$datePicker.setMoment(n(e,i),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),c||s||this.setValue("")):this.cellProperties.defaultDate?(e=this.cellProperties.defaultDate,n(e,i,!0).isValid()&&this.$datePicker.setMoment(n(e,i),!0),c||s||this.setValue("")):this.$datePicker.gotoToday(),this.datePickerStyle.display="block"}},{key:"hideDatepicker",value:function(){this.datePickerStyle.display="none",this.$datePicker.hide()}},{key:"getDatePickerConfig",value:function(){var t=this,e=this.TEXTAREA,o={};this.cellProperties&&this.cellProperties.datePickerConfig&&Object(c.deepExtend)(o,this.cellProperties.datePickerConfig);var r=o.onSelect,i=o.onClose;return o.field=e,o.trigger=e,o.container=this.datePicker,o.bound=!1,o.format=o.format||this.defaultDateFormat,o.reposition=o.reposition||!1,o.onSelect=function(e){var o=e;isNaN(o.getTime())||(o=n(o).format(t.cellProperties.dateFormat||t.defaultDateFormat)),t.setValue(o),t.hideDatepicker(),r&&r()},o.onClose=function(){t.parentDestroyed||t.finishEditing(!1),i&&i()},o}}])&&f(e.prototype,o),i&&f(e,i),y}(i.a)},542:function(t,e,o){"use strict";o(5),o(4),o(6),o(40),o(7),o(10),o(12),o(13),o(15),o(20),o(16);var n=o(11),r=o(22),i=o(25),s=o(69),a=o(28),c=o(132),l=o(0);function u(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var o=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==o)return;var n,r,i=[],s=!0,a=!1;try{for(o=o.call(t);!(s=(n=o.next()).done)&&(i.push(n.value),!e||i.length!==e);s=!0);}catch(t){a=!0,r=t}finally{try{s||null==o.return||o.return()}finally{if(a)throw r}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return f(t,e);var o=Object.prototype.toString.call(t).slice(8,-1);"Object"===o&&t.constructor&&(o=t.constructor.name);if("Map"===o||"Set"===o)return Array.from(t);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return f(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var o=0,n=new Array(e);o<e;o++)n[o]=t[o];return n}function h(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var p=function(){function t(e,o,n){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.instance=e,this.tableMeta=o,this.selection=n,this.eventManager=new a.a(e),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0,this.lastKeyCode=void 0,this.instance.addHook("afterDocumentKeyDown",(function(t){return r.onAfterDocumentKeyDown(t)}));for(var i=this.instance.rootWindow;i;)this.eventManager.addEventListener(i.document.documentElement,"keydown",(function(t){r.destroyed||r.instance.runHooks("afterDocumentKeyDown",t)})),i=Object(l.getParentWindow)(i);this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",(function(t){!r.destroyed&&r.activeEditor&&!r.activeEditor.isOpened()&&r.instance.isListening()&&r.openEditor("",t)})),this.instance.view.wt.update("onCellDblClick",(function(t,e,o){return r.onCellDblClick(t,e,o)}))}var e,o,f;return e=t,(o=[{key:"lockEditor",value:function(){this.lock=!0}},{key:"unlockEditor",value:function(){this.lock=!1}},{key:"destroyEditor",value:function(t){this.lock||this.closeEditor(t)}},{key:"getActiveEditor",value:function(){return this.activeEditor}},{key:"prepareEditor",value:function(){var t=this;if(!this.lock)if(this.activeEditor&&this.activeEditor.isWaiting())this.closeEditor(!1,!1,(function(e){e&&t.prepareEditor()}));else{var e=this.instance.selection.selectedRange.current().highlight,o=e.row,n=e.col,r=this.instance.runHooks("modifyGetCellCoords",o,n),i=o,a=n;if(Array.isArray(r)){var c=u(r,2);i=c[0],a=c[1]}this.cellProperties=this.instance.getCellMeta(i,a);var l=this.instance.rootDocument.activeElement;if(l&&l.blur(),this.cellProperties.readOnly)this.clearActiveEditor();else{var f=this.instance.getCellEditor(this.cellProperties),h=this.instance.getCell(o,n,!0);if(f&&h){var p=this.instance.colToProp(a),d=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(i),a);this.activeEditor=Object(s.b)(f,this.instance),this.activeEditor.prepare(o,n,p,h,d,this.cellProperties)}else this.clearActiveEditor()}}}},{key:"isEditorOpened",value:function(){return this.activeEditor&&this.activeEditor.isOpened()}},{key:"openEditor",value:function(t,e){this.activeEditor&&this.activeEditor.beginEditing(t,e)}},{key:"closeEditor",value:function(t,e,o){this.activeEditor?this.activeEditor.finishEditing(t,e,o):o&&o(!1)}},{key:"closeEditorAndSaveChanges",value:function(t){this.closeEditor(!1,t)}},{key:"closeEditorAndRestoreOriginalValue",value:function(t){this.closeEditor(!0,t)}},{key:"clearActiveEditor",value:function(){this.activeEditor=void 0}},{key:"moveSelectionAfterEnter",value:function(t){var e="function"==typeof this.tableMeta.enterMoves?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;t?this.selection.transformStart(-e.row,-e.col):this.selection.transformStart(e.row,e.col,!0)}},{key:"moveSelectionUp",value:function(t){t?this.selection.transformEnd(-1,0):this.selection.transformStart(-1,0)}},{key:"moveSelectionDown",value:function(t){t?this.selection.transformEnd(1,0):this.selection.transformStart(1,0)}},{key:"moveSelectionRight",value:function(t){t?this.selection.transformEnd(0,1):this.selection.transformStart(0,1)}},{key:"moveSelectionLeft",value:function(t){t?this.selection.transformEnd(0,-1):this.selection.transformStart(0,-1)}},{key:"onAfterDocumentKeyDown",value:function(t){if(this.instance.isListening()){this.instance.runHooks("beforeKeyDown",t);var e=t.keyCode;if(!this.destroyed&&229!==e&&!Object(i.isImmediatePropagationStopped)(t)&&(this.lastKeyCode=e,this.selection.isSelected())){var o=(t.ctrlKey||t.metaKey)&&!t.altKey;if(!this.activeEditor||this.activeEditor.isWaiting()||Object(r.isFunctionKey)(e)||Object(r.isCtrlMetaKey)(e)||o||this.isEditorOpened()){var s,a=t.shiftKey,l=a?this.selection.setRangeEnd:this.selection.setRangeStart;switch(e){case r.KEY_CODES.A:!this.isEditorOpened()&&o&&(this.instance.selectAll(),t.preventDefault(),t.stopPropagation());break;case r.KEY_CODES.ARROW_UP:this.isEditorOpened()&&!this.activeEditor.isWaiting()&&this.closeEditorAndSaveChanges(o),this.moveSelectionUp(a),t.preventDefault(),t.stopPropagation();break;case r.KEY_CODES.ARROW_DOWN:this.isEditorOpened()&&!this.activeEditor.isWaiting()&&this.closeEditorAndSaveChanges(o),this.moveSelectionDown(a),t.preventDefault(),t.stopPropagation();break;case r.KEY_CODES.ARROW_RIGHT:this.isEditorOpened()&&!this.activeEditor.isWaiting()&&this.closeEditorAndSaveChanges(o),this.moveSelectionRight(a),t.preventDefault(),t.stopPropagation();break;case r.KEY_CODES.ARROW_LEFT:this.isEditorOpened()&&!this.activeEditor.isWaiting()&&this.closeEditorAndSaveChanges(o),this.moveSelectionLeft(a),t.preventDefault(),t.stopPropagation();break;case r.KEY_CODES.TAB:s="function"==typeof this.tableMeta.tabMoves?this.tableMeta.tabMoves(t):this.tableMeta.tabMoves,a?this.selection.transformStart(-s.row,-s.col):this.selection.transformStart(s.row,s.col,!0),t.preventDefault(),t.stopPropagation();break;case r.KEY_CODES.BACKSPACE:case r.KEY_CODES.DELETE:this.instance.emptySelectedCells(),this.prepareEditor(),t.preventDefault();break;case r.KEY_CODES.F2:this.activeEditor&&this.activeEditor.enableFullEditMode(),this.openEditor(null,t),t.preventDefault();break;case r.KEY_CODES.ENTER:this.isEditorOpened()?(this.activeEditor&&this.activeEditor.state!==c.b.WAITING&&this.closeEditorAndSaveChanges(o),this.moveSelectionAfterEnter(a)):this.instance.getSettings().enterBeginsEditing?this.cellProperties.readOnly?this.moveSelectionAfterEnter():this.activeEditor&&(this.activeEditor.enableFullEditMode(),this.openEditor(null,t)):this.moveSelectionAfterEnter(a),t.preventDefault(),Object(i.stopImmediatePropagation)(t);break;case r.KEY_CODES.ESCAPE:this.isEditorOpened()&&(this.closeEditorAndRestoreOriginalValue(o),this.activeEditor.focus()),t.preventDefault();break;case r.KEY_CODES.HOME:t.ctrlKey||t.metaKey?l.call(this.selection,new n.a(this.instance.rowIndexMapper.getFirstNotHiddenIndex(0,1),this.selection.selectedRange.current().from.col)):l.call(this.selection,new n.a(this.selection.selectedRange.current().from.row,this.instance.columnIndexMapper.getFirstNotHiddenIndex(0,1))),t.preventDefault(),t.stopPropagation();break;case r.KEY_CODES.END:t.ctrlKey||t.metaKey?l.call(this.selection,new n.a(this.instance.rowIndexMapper.getFirstNotHiddenIndex(this.instance.countRows()-1,-1),this.selection.selectedRange.current().from.col)):l.call(this.selection,new n.a(this.selection.selectedRange.current().from.row,this.instance.columnIndexMapper.getFirstNotHiddenIndex(this.instance.countCols()-1,-1))),t.preventDefault(),t.stopPropagation();break;case r.KEY_CODES.PAGE_UP:this.selection.transformStart(-this.instance.countVisibleRows(),0),t.preventDefault(),t.stopPropagation();break;case r.KEY_CODES.PAGE_DOWN:this.selection.transformStart(this.instance.countVisibleRows(),0),t.preventDefault(),t.stopPropagation()}}else this.openEditor("",t)}}}},{key:"onCellDblClick",value:function(t,e,o){"TD"===o.nodeName&&(this.activeEditor&&this.activeEditor.enableFullEditMode(),this.openEditor(null,t))}},{key:"destroy",value:function(){this.destroyed=!0,this.eventManager.destroy()}}])&&h(e.prototype,o),f&&h(e,f),t}(),d=new WeakMap;p.getInstance=function(t,e,o){var n=d.get(t);return n||(n=new p(t,e,o),d.set(t,n)),n},e.a=p},627:function(t,e,o){"use strict";o.d(e,"a",(function(){return h}));o(18),o(17),o(19),o(10),o(12),o(4),o(13),o(5),o(6),o(7);var n=o(132),r=o(0);function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,n=f(t);if(e){var r=f(this).constructor;o=Reflect.construct(n,arguments,r)}else o=n.apply(this,arguments);return u(this,o)}}function u(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(u,t);var e,o,n,i=l(u);function u(){return s(this,u),i.apply(this,arguments)}return e=u,n=[{key:"EDITOR_TYPE",get:function(){return"checkbox"}}],(o=[{key:"beginEditing",value:function(t,e){if(e&&"mouseup"===e.type){var o=this.TD.querySelector('input[type="checkbox"]');Object(r.hasClass)(o,"htBadValue")||o.click()}}},{key:"finishEditing",value:function(){}},{key:"init",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"focus",value:function(){}}])&&a(e.prototype,o),n&&a(e,n),u}(n.a)},628:function(t,e,o){"use strict";o.d(e,"a",(function(){return p}));o(47),o(18),o(17),o(19),o(31),o(23),o(10),o(12),o(4),o(13),o(5),o(6),o(7);var n=o(326),r=o(21);function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(t,e,o){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,o){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=h(t)););return t}(t,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(o):r.value}})(t,e,o||t)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,n=h(t);if(e){var r=h(this).constructor;o=Reflect.construct(n,arguments,r)}else o=n.apply(this,arguments);return f(this,o)}}function f(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(i,t);var e,o,n,r=u(i);function i(){return s(this,i),r.apply(this,arguments)}return e=i,n=[{key:"EDITOR_TYPE",get:function(){return"dropdown"}}],(o=[{key:"prepare",value:function(t,e,o,n,r,s){c(h(i.prototype),"prepare",this).call(this,t,e,o,n,r,s),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}])&&a(e.prototype,o),n&&a(e,n),i}(n.a);r.a.getSingleton().add("beforeValidate",(function(t,e,o){var n=this.getCellMeta(e,this.propToCol(o));n.editor===p&&void 0===n.strict&&(n.filter=!1,n.strict=!0)}))},629:function(t,e,o){"use strict";o.d(e,"a",(function(){return f}));o(18),o(17),o(19),o(10),o(12),o(4),o(13),o(5),o(6),o(7);var n=o(166);function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,n=u(t);if(e){var r=u(this).constructor;o=Reflect.construct(n,arguments,r)}else o=n.apply(this,arguments);return l(this,o)}}function l(t,e){if(e&&("object"===r(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(l,t);var e,o,n,r=c(l);function l(){return i(this,l),r.apply(this,arguments)}return e=l,n=[{key:"EDITOR_TYPE",get:function(){return"numeric"}}],(o=null)&&s(e.prototype,o),n&&s(e,n),l}(n.a)},630:function(t,e,o){"use strict";o.d(e,"a",(function(){return p}));o(18),o(17),o(19),o(31),o(23),o(10),o(12),o(4),o(13),o(5),o(6),o(7);var n=o(166),r=o(0);function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(t,e,o){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,o){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=h(t)););return t}(t,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(o):r.value}})(t,e,o||t)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,n=h(t);if(e){var r=h(this).constructor;o=Reflect.construct(n,arguments,r)}else o=n.apply(this,arguments);return f(this,o)}}function f(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(f,t);var e,o,n,i=u(f);function f(){return s(this,f),i.apply(this,arguments)}return e=f,n=[{key:"EDITOR_TYPE",get:function(){return"password"}}],(o=[{key:"createElements",value:function(){c(h(f.prototype),"createElements",this).call(this),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,Object(r.empty)(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}])&&a(e.prototype,o),n&&a(e,n),f}(n.a)},69:function(t,e,o){"use strict";o.d(e,"e",(function(){return d})),o.d(e,"a",(function(){return p})),o.d(e,"b",(function(){return h})),o.d(e,"d",(function(){return l})),o.d(e,"c",(function(){return u}));o(5),o(4),o(6),o(40),o(7);var n=o(21),r=o(67),i=new WeakMap,s=Object(r.a)("editors"),a=s.register,c=s.getItem,l=s.hasItem,u=s.getNames;s.getValues;function f(t){var e={},o=t;this.getConstructor=function(){return t},this.getInstance=function(t){return t.guid in e||(e[t.guid]=new o(t)),e[t.guid]},n.a.getSingleton().add("afterDestroy",(function(){e[this.guid]=null}))}function h(t,e){var o;if("function"==typeof t)i.get(t)||d(null,t),o=i.get(t);else{if("string"!=typeof t)throw Error('Only strings and functions can be passed as "editor" parameter');o=c(t)}if(!o)throw Error('No editor registered under name "'.concat(t,'"'));return o.getInstance(e)}function p(t){if(!l(t))throw Error('No registered editor found under "'.concat(t,'" name'));return c(t).getConstructor()}function d(t,e){t&&"string"!=typeof t&&(t=(e=t).EDITOR_TYPE);var o=new f(e);"string"==typeof t&&a(t,o),i.set(e,o)}},720:function(t,e,o){"use strict";o.d(e,"a",(function(){return v}));o(18),o(17),o(19),o(31),o(23),o(10),o(12),o(4),o(13),o(5),o(6),o(7);var n=o(132),r=o(0),i=o(25),s=o(2),a=o(22);function c(t){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function f(t,e,o){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,o){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=y(t)););return t}(t,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(o):r.value}})(t,e,o||t)}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function p(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,n=y(t);if(e){var r=y(this).constructor;o=Reflect.construct(n,arguments,r)}else o=n.apply(this,arguments);return d(this,o)}}function d(t,e){if(e&&("object"===c(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function y(t){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var v=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(E,t);var e,o,d,v=p(E);function E(){return l(this,E),v.apply(this,arguments)}return e=E,d=[{key:"EDITOR_TYPE",get:function(){return"select"}}],(o=[{key:"init",value:function(){this.select=this.hot.rootDocument.createElement("SELECT"),Object(r.addClass)(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}},{key:"getValue",value:function(){return this.select.value}},{key:"setValue",value:function(t){this.select.value=t}},{key:"open",value:function(){var t=this;this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.addHook("beforeKeyDown",(function(){return t.onBeforeKeyDown()}))}},{key:"close",value:function(){this._opened=!1,this.select.style.display="none",Object(r.hasClass)(this.select,"ht_editor_visible")&&Object(r.removeClass)(this.select,"ht_editor_visible"),this.clearHooks()}},{key:"focus",value:function(){this.select.focus()}},{key:"registerHooks",value:function(){var t=this;this.addHook("afterScrollHorizontally",(function(){return t.refreshDimensions()})),this.addHook("afterScrollVertically",(function(){return t.refreshDimensions()})),this.addHook("afterColumnResize",(function(){return t.refreshDimensions()})),this.addHook("afterRowResize",(function(){return t.refreshDimensions()}))}},{key:"prepare",value:function(t,e,o,n,i,a){var c=this;f(y(E.prototype),"prepare",this).call(this,t,e,o,n,i,a);var l,u=this.cellProperties.selectOptions;l="function"==typeof u?this.prepareOptions(u(this.row,this.col,this.prop)):this.prepareOptions(u),Object(r.empty)(this.select),Object(s.objectEach)(l,(function(t,e){var o=c.hot.rootDocument.createElement("OPTION");o.value=e,Object(r.fastInnerHTML)(o,t),c.select.appendChild(o)}))}},{key:"prepareOptions",value:function(t){var e={};if(Array.isArray(t))for(var o=0,n=t.length;o<n;o++)e[t[o]]=t[o];else"object"===c(t)&&(e=t);return e}},{key:"refreshValue",value:function(){var t=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=t,this.setValue(t),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){if(this.state===n.b.EDITING)if(this.TD=this.getEditedCell(),this.TD){var t,e=this.hot.view.wt.wtOverlays,o=Object(r.offset)(this.TD),i=Object(r.offset)(this.hot.rootElement),s=e.scrollableElement,a=this.checkEditorSection(),c=Object(r.outerWidth)(this.TD)+1,l=Object(r.outerHeight)(this.TD)+1,u=o.top-i.top-1-(s.scrollTop||0),f=o.left-i.left-1-(s.scrollLeft||0);switch(a){case"top":t=Object(r.getCssTransform)(e.topOverlay.clone.wtTable.holder.parentNode);break;case"left":t=Object(r.getCssTransform)(e.leftOverlay.clone.wtTable.holder.parentNode);break;case"top-left-corner":t=Object(r.getCssTransform)(e.topLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom-left-corner":t=Object(r.getCssTransform)(e.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom":t=Object(r.getCssTransform)(e.bottomOverlay.clone.wtTable.holder.parentNode)}var h=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),p=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),d=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view.wt.getSetting("fixedRowsBottom");(h<=0||h===d)&&(u+=1),p<=0&&(f+=1);var y=this.select.style;t&&-1!==t?y[t[0]]=t[1]:Object(r.resetCssTransform)(this.select);var v=Object(r.getComputedStyle)(this.TD,this.hot.rootWindow);parseInt(v.borderTopWidth,10)>0&&(l-=1),parseInt(v.borderLeftWidth,10)>0&&(c-=1),y.height="".concat(l,"px"),y.minWidth="".concat(c,"px"),y.top="".concat(u,"px"),y.left="".concat(f,"px"),y.margin="0px",Object(r.addClass)(this.select,"ht_editor_visible")}else this.close()}},{key:"onBeforeKeyDown",value:function(){var t=this.select.selectedIndex-1,e=this.select.selectedIndex+1;switch(event.keyCode){case a.KEY_CODES.ARROW_UP:t>=0&&(this.select[t].selected=!0),Object(i.stopImmediatePropagation)(event),event.preventDefault();break;case a.KEY_CODES.ARROW_DOWN:e<=this.select.length-1&&(this.select[e].selected=!0),Object(i.stopImmediatePropagation)(event),event.preventDefault()}}}])&&u(e.prototype,o),d&&u(e,d),E}(n.a)}}]);