(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{146:function(t,e,o){"use strict";o.d(e,"a",(function(){return a})),o.d(e,"b",(function(){return l})),o.d(e,"c",(function(){return u})),o.d(e,"d",(function(){return s}));o(26),o(64);var n=o(2),r=o(9),i=o(11),a={horizontal:"horizontal",vertical:"vertical"};function l(t,e,o,n){var r=o.length,i=o?o[0].length:0,a=[],l=e.row-t.row,u=e.col-t.col;if(-1!==["down","up"].indexOf(n)){for(var s=[],c=0;c<u;c++){var h=parseInt(o[0][c],10),f=parseInt(o[r-1][c],10),d=("down"===n?f-h:h-f)/(r-1)||0;s.push(d)}a.push(s)}if(-1!==["right","left"].indexOf(n))for(var g=0;g<l;g++){var y=parseInt(o[g][0],10),p=parseInt(o[g][i-1],10),v=("right"===n?p-y:y-p)/(i-1)||0;a.push([v])}return a}function u(t,e){var o,n,r;return e[0]===t[0]&&e[1]<t[1]?(r="left",o=new i.a(e[0],e[1]),n=new i.a(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(r="right",o=new i.a(e[0],t[3]+1),n=new i.a(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(r="up",o=new i.a(e[0],e[1]),n=new i.a(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(r="down",o=new i.a(t[2]+1,e[1]),n=new i.a(e[2],e[3])),o&&o.normalize(),n&&n.normalize(),{directionOfDrag:r,startOfDragCoords:o,endOfDragCoords:n}}function s(t){var e={};return!0===t?(e.directions=Object.keys(a),e.autoInsertRow=!0):Object(n.isObject)(t)?(Object(r.isDefined)(t.autoInsertRow)?t.direction===a.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,Object(r.isDefined)(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(a)):"string"==typeof t?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}},740:function(t,e,o){"use strict";o.d(e,"a",(function(){return j}));o(5),o(4),o(6),o(40),o(7),o(15),o(72),o(16),o(78),o(18),o(17),o(19),o(31),o(23),o(10),o(12),o(13),o(20);var n=o(49),r=o(1),i=o(60),a=o(175),l=o(21),u=o(2),s=o(14),c=o(242),h=o(44),f=o(330),d=o(110),g=o(9);function y(t){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function p(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var o=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==o)return;var n,r,i=[],a=!0,l=!1;try{for(o=o.call(t);!(a=(n=o.next()).done)&&(i.push(n.value),!e||i.length!==e);a=!0);}catch(t){l=!0,r=t}finally{try{a||null==o.return||o.return()}finally{if(l)throw r}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return v(t,e);var o=Object.prototype.toString.call(t).slice(8,-1);"Object"===o&&t.constructor&&(o=t.constructor.name);if("Map"===o||"Set"===o)return Array.from(t);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return v(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(t,e){(null==e||e>t.length)&&(e=t.length);for(var o=0,n=new Array(e);o<e;o++)n[o]=t[o];return n}function m(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function w(t,e,o){return(w="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,o){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=S(t)););return t}(t,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(o):r.value}})(t,e,o||t)}function b(t,e){return(b=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function C(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,n=S(t);if(e){var r=S(this).constructor;o=Reflect.construct(n,arguments,r)}else o=n.apply(this,arguments);return R(this,o)}}function R(t,e){if(e&&("object"===y(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return O(t)}function O(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function S(t){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}l.a.getSingleton().register("modifyAutoColumnSizeSeed");var k="autoColumnSize",A=new WeakMap,j=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&b(t,e)}(y,t);var e,o,n,l=C(y);function y(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,y),e=l.call(this,t),A.set(O(e),{cachedColumnHeaders:[]}),e.ghostTable=new a.a(e.hot),e.samplesGenerator=new c.a((function(t,o){var n=e.hot.getCellMeta(t,o),r="";n.spanned||(r=e.hot.getDataAtCell(t,o));var i="";return e.hot.hasHook("modifyAutoColumnSizeSeed")&&(i=e.hot.runHooks("modifyAutoColumnSizeSeed",i,n,r)),{value:r,bundleSeed:i}})),e.firstCalculation=!0,e.inProgress=!1,e.measuredColumns=0,e.columnWidthsMap=new d.a,e.hot.columnIndexMapper.registerMap("autoColumnSize",e.columnWidthsMap),e.addHook("beforeColumnResize",(function(t,o,n){return e.onBeforeColumnResize(t,o,n)})),e}return e=y,n=[{key:"PLUGIN_KEY",get:function(){return k}},{key:"PLUGIN_PRIORITY",get:function(){return 10}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 50}}],(o=[{key:"isEnabled",value:function(){return!1!==this.hot.getSettings()[k]&&!this.hot.getSettings().colWidths}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){var e=this.hot.getSettings()[k];e&&null!==e.useHeaders&&void 0!==e.useHeaders&&this.ghostTable.setSetting("useHeaders",e.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",(function(){return t.onAfterLoadData()})),this.addHook("beforeChange",(function(e){return t.onBeforeChange(e)})),this.addHook("afterFormulasValuesUpdate",(function(e){return t.onAfterFormulasValuesUpdate(e)})),this.addHook("beforeViewRender",(function(e){return t.onBeforeViewRender(e)})),this.addHook("modifyColWidth",(function(e,o){return t.getColumnWidth(o,e)})),this.addHook("afterInit",(function(){return t.onAfterInit()})),w(S(y.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var t=this.findColumnsWhereHeaderWasChanged();t.length&&(this.clearCache(t),this.calculateVisibleColumnsWidth()),w(S(y.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var t=this;w(S(y.prototype),"disablePlugin",this).call(this),this.addHook("beforeColumnResize",(function(e,o,n){return t.onBeforeColumnResize(e,o,n)}))}},{key:"calculateVisibleColumnsWidth",value:function(){if(this.hot.countRows()){var t=this.hot.renderCall,e=this.getFirstVisibleColumn(),o=this.getLastVisibleColumn();-1!==e&&-1!==o&&this.calculateColumnsWidth({from:e,to:o},void 0,t)}}},{key:"calculateColumnsWidth",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countRows()-1},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i="number"==typeof e?{from:e,to:e}:e,a="number"==typeof o?{from:o,to:o}:o;Object(s.rangeEach)(i.from,i.to,(function(e){var o=t.hot.toPhysicalColumn(e);if(null===o&&(o=e),n||null===t.columnWidthsMap.getValueAtIndex(o)&&!t.hot._getColWidthFromSettings(o)){var i=t.samplesGenerator.generateColumnSamples(e,a);Object(r.arrayEach)(i,(function(e){var o=p(e,2),n=o[0],r=o[1];return t.ghostTable.addColumn(n,r)}))}})),this.ghostTable.columns.length&&(this.hot.batchExecution((function(){t.ghostTable.getWidths((function(e,o){var n=t.hot.toPhysicalColumn(e);t.columnWidthsMap.setValueAtIndex(n,o)}))}),!0),this.measuredColumns=i.to+1,this.ghostTable.clean())}},{key:"calculateAllColumnsWidth",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},o=0,n=this.hot.countCols()-1,r=null;this.inProgress=!0;var a=function a(){if(!t.hot)return Object(i.cancelAnimationFrame)(r),void(t.inProgress=!1);t.calculateColumnsWidth({from:o,to:Math.min(o+y.CALCULATION_STEP,n)},e),(o=o+y.CALCULATION_STEP+1)<n?r=Object(i.requestAnimationFrame)(a):(Object(i.cancelAnimationFrame)(r),t.inProgress=!1,t.hot.view.adjustElementsSize())},l=this.getSyncCalculationLimit();this.firstCalculation&&l>=0&&(this.calculateColumnsWidth({from:0,to:l},e),this.firstCalculation=!1,o=l+1),o<n?a():this.inProgress=!1}},{key:"setSamplingOptions",value:function(){var t=this.hot.getSettings()[k],e=t&&Object(u.hasOwnProperty)(t,"samplingRatio")?t.samplingRatio:void 0,o=t&&Object(u.hasOwnProperty)(t,"allowSampleDuplicates")?t.allowSampleDuplicates:void 0;e&&!isNaN(e)&&this.samplesGenerator.setSampleCount(parseInt(e,10)),o&&this.samplesGenerator.setAllowDuplicates(o)}},{key:"recalculateAllColumnsWidth",value:function(){this.hot.view&&this.hot.view.wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}},{key:"getSyncCalculationLimit",value:function(){var t=this.hot.getSettings()[k],e=y.SYNC_CALCULATION_LIMIT,o=this.hot.countCols()-1;return Object(u.isObject)(t)&&(e=t.syncLimit,Object(h.isPercentValue)(e)?e=Object(s.valueAccordingPercent)(o,e):e>>=0),Math.min(e,o)}},{key:"getColumnWidth",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=e;return void 0===n&&(n=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(t)),o&&"number"==typeof n&&(n=Math.max(n,f.a.DEFAULT_WIDTH))),n}},{key:"getFirstVisibleColumn",value:function(){var t=this.hot.view.wt;if(t.wtViewport.columnsVisibleCalculator){var e=t.wtTable.getFirstVisibleColumn();if(-1!==e)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(e)}if(t.wtViewport.columnsRenderCalculator){var o=t.wtTable.getFirstRenderedColumn();if(-1!==o)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(o)}return-1}},{key:"getLastVisibleColumn",value:function(){var t=this.hot.view.wt;if(t.wtViewport.columnsVisibleCalculator){var e=t.wtTable.getLastVisibleColumn();if(-1!==e)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(e)}if(t.wtViewport.columnsRenderCalculator){var o=t.wtTable.getLastRenderedColumn();if(-1!==o)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(o)}return-1}},{key:"findColumnsWhereHeaderWasChanged",value:function(){var t=this.hot.getColHeader(),e=A.get(this).cachedColumnHeaders;return Object(r.arrayReduce)(t,(function(t,o,n){var r=e.length;return(r-1<n||e[n]!==o)&&t.push(n),r-1<n?e.push(o):e[n]=o,t}),[])}},{key:"clearCache",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.length?this.hot.batchExecution((function(){Object(r.arrayEach)(e,(function(e){t.columnWidthsMap.setValueAtIndex(e,null)}))}),!0):this.columnWidthsMap.clear()}},{key:"isNeedRecalculate",value:function(){return!!Object(r.arrayFilter)(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),(function(t){return null===t})).length}},{key:"onBeforeViewRender",value:function(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}},{key:"onAfterLoadData",value:function(){var t=this;this.hot.view?this.recalculateAllColumnsWidth():setTimeout((function(){t.hot&&t.recalculateAllColumnsWidth()}),0)}},{key:"onBeforeChange",value:function(t){var e=this,o=Object(r.arrayMap)(t,(function(t){var o=p(t,2)[1];return e.hot.toPhysicalColumn(e.hot.propToCol(o))}));this.clearCache(Array.from(new Set(o)))}},{key:"onBeforeColumnResize",value:function(t,e,o){var n=t;return o&&(this.calculateColumnsWidth(e,void 0,!0),n=this.getColumnWidth(e,void 0,!1)),n}},{key:"onAfterInit",value:function(){A.get(this).cachedColumnHeaders=this.hot.getColHeader()}},{key:"onAfterFormulasValuesUpdate",value:function(t){var e=Object(r.arrayFilter)(t,(function(t){var e;return Object(g.isDefined)(null===(e=t.address)||void 0===e?void 0:e.col)})),o=Object(r.arrayMap)(e,(function(t){return t.address.col}));this.clearCache(Array.from(new Set(o)))}},{key:"destroy",value:function(){this.ghostTable.clean(),w(S(y.prototype),"destroy",this).call(this)}}])&&m(e.prototype,o),n&&m(e,n),y}(n.a)},741:function(t,e,o){"use strict";o.d(e,"a",(function(){return O}));o(26),o(42),o(51),o(32),o(18),o(17),o(19),o(31),o(23),o(10),o(12),o(4),o(13),o(5),o(6),o(7),o(15),o(20),o(16);var n=o(49),r=o(21),i=o(0),a=o(1),l=o(28),u=o(76),s=o(11),c=o(146);function h(t){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function f(t){return function(t){if(Array.isArray(t))return y(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||g(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var o=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==o)return;var n,r,i=[],a=!0,l=!1;try{for(o=o.call(t);!(a=(n=o.next()).done)&&(i.push(n.value),!e||i.length!==e);a=!0);}catch(t){l=!0,r=t}finally{try{a||null==o.return||o.return()}finally{if(l)throw r}}return i}(t,e)||g(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(t,e){if(t){if("string"==typeof t)return y(t,e);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?y(t,e):void 0}}function y(t,e){(null==e||e>t.length)&&(e=t.length);for(var o=0,n=new Array(e);o<e;o++)n[o]=t[o];return n}function p(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function v(t,e,o){return(v="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,o){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=R(t)););return t}(t,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(o):r.value}})(t,e,o||t)}function m(t,e){return(m=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function w(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,n=R(t);if(e){var r=R(this).constructor;o=Reflect.construct(n,arguments,r)}else o=n.apply(this,arguments);return b(this,o)}}function b(t,e){if(e&&("object"===h(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return C(t)}function C(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function R(t){return(R=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}r.a.getSingleton().register("modifyAutofillRange"),r.a.getSingleton().register("beforeAutofill"),r.a.getSingleton().register("afterAutofill");var O=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&m(t,e)}(h,t);var e,o,n,r=w(h);function h(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),(e=r.call(this,t)).eventManager=new l.a(C(e)),e.addingStarted=!1,e.mouseDownOnCellCorner=!1,e.mouseDragOutside=!1,e.handleDraggedCells=0,e.directions=[],e.autoInsertRow=!1,e}return e=h,n=[{key:"PLUGIN_KEY",get:function(){return"autofill"}},{key:"PLUGIN_PRIORITY",get:function(){return 20}}],(o=[{key:"isEnabled",value:function(){return this.hot.getSettings().fillHandle}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",(function(e){return t.onAfterCellCornerMouseDown(e)})),this.addHook("afterOnCellCornerDblClick",(function(e){return t.onCellCornerDblClick(e)})),this.addHook("beforeOnCellMouseOver",(function(e,o){return t.onBeforeCellMouseOver(o)})),v(R(h.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),v(R(h.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.clearMappedSettings(),v(R(h.prototype),"disablePlugin",this).call(this)}},{key:"getSelectionData",value:function(){var t=this,e=this.hot.getSelectedRangeLast(),o=e.getTopLeftCorner(),n=o.row,r=o.col,i=e.getBottomRightCorner(),l=i.row,u=i.col,s=this.hot.runHooks("modifyCopyableRange",[{startRow:n,startCol:r,endRow:l,endCol:u}]),c=[],h=[],f=[];return Object(a.arrayEach)(s,(function(t){for(var e=t.startRow;e<=t.endRow;e+=1)-1===c.indexOf(e)&&c.push(e);for(var o=t.startCol;o<=t.endCol;o+=1)-1===h.indexOf(o)&&h.push(o)})),Object(a.arrayEach)(c,(function(e){var o=[];Object(a.arrayEach)(h,(function(n){o.push(t.hot.getCopyableData(e,n))})),f.push(o)})),f}},{key:"fillIn",value:function(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;var t=d(this.hot.selection.highlight.getFill().getVisualCorners(),4),e=t[0],o=t[1],n=t[2],r=t[3],i=this.hot.getSelectedRangeLast(),a=i.getTopLeftCorner(),l=i.getBottomRightCorner();this.resetSelectionOfDraggedArea();var s=[a.row,a.col,l.row,l.col],h=this.hot.runHooks("modifyAutofillRange",[Math.min(a.row,e),Math.min(a.col,o),Math.max(l.row,n),Math.max(l.col,r)],s),f=Object(c.c)(s,h),g=f.directionOfDrag,y=f.startOfDragCoords,p=f.endOfDragCoords;if(y&&y.row>-1&&y.col>-1){var v=this.getSelectionData(),m=i.clone(),w=new u.a(y,y,p),b=this.hot.runHooks("beforeAutofill",v,m,w,g);if(!1===b)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;var C=Object(c.b)(y,p,v,g),R=b,O=b;if(["up","left"].indexOf(g)>-1&&(1!==O.length||0!==O[0].length))if(R=[],"up"===g)for(var S=p.row-y.row+1,k=S%O.length,A=0;A<S;A++)R.push(O[(A+(O.length-k))%O.length]);else for(var j=p.col-y.col+1,I=j%O[0].length,H=0;H<O.length;H++){R.push([]);for(var P=0;P<j;P++)R[H].push(O[H][(P+(O[H].length-I))%O[H].length])}this.hot.populateFromArray(y.row,y.col,R,p.row,p.col,"".concat(this.pluginName,".fill"),null,g,C),this.setSelection(h),this.hot.runHooks("afterAutofill",R,m,w,g),this.hot.render()}else this.hot._refreshBorders();return!0}},{key:"reduceSelectionAreaIfNeeded",value:function(t){return t.row<0&&(t.row=0),t.col<0&&(t.col=0),t}},{key:"getCoordsOfDragAndDropBorders",value:function(t){var e=this.hot.getSelectedRangeLast(),o=e.getBottomRightCorner(),n=t;if(this.directions.includes(c.a.vertical)&&this.directions.includes(c.a.horizontal)){var r=e.getTopLeftCorner();(o.col<=t.col||r.col>=t.col)&&(n=new s.a(o.row,t.col)),(o.row<t.row||r.row>t.row)&&(n=new s.a(t.row,o.col))}else if(this.directions.includes(c.a.vertical))n=new s.a(t.row,o.col);else{if(!this.directions.includes(c.a.horizontal))return;n=new s.a(o.row,t.col)}return this.reduceSelectionAreaIfNeeded(n)}},{key:"showBorder",value:function(t){var e=this.getCoordsOfDragAndDropBorders(t);e&&this.redrawBorders(e)}},{key:"addRow",value:function(){var t=this;this.hot._registerTimeout((function(){t.hot.alter("insert_row",void 0,1,"".concat(t.pluginName,".fill")),t.addingStarted=!1}),200)}},{key:"addNewRowIfNeeded",value:function(){if(!this.hot.selection.highlight.getFill().isEmpty()&&!1===this.addingStarted&&this.autoInsertRow){var t=this.hot.getSelectedLast(),e=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.countRows();t[2]<o-1&&e[2]===o-1&&(this.addingStarted=!0,this.addRow())}}},{key:"getIndexOfLastAdjacentFilledInRow",value:function(t){for(var e,o=this.hot.getData(),n=this.hot.countRows(),r=t[2]+1;r<n;r++){for(var i=t[1];i<=t[3];i++)if(o[r][i])return-1;var a=o[r][t[1]-1],l=o[r][t[3]+1];(a||l)&&(e=r)}return e}},{key:"addSelectionFromStartAreaToSpecificRowIndex",value:function(t,e){this.hot.selection.highlight.getFill().clear().add(new s.a(t[0],t[1])).add(new s.a(e,t[3])).commit()}},{key:"setSelection",value:function(t){var e;(e=this.hot).selectCell.apply(e,f(Object(a.arrayMap)(t,(function(t){return Math.max(t,0)}))).concat([!1,!1]))}},{key:"selectAdjacent",value:function(){var t=this.hot.getSelectedLast(),e=this.getIndexOfLastAdjacentFilledInRow(t);return-1!==e&&void 0!==e&&(this.addSelectionFromStartAreaToSpecificRowIndex(t,e),!0)}},{key:"resetSelectionOfDraggedArea",value:function(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}},{key:"redrawBorders",value:function(t){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(t).commit(),this.hot.view.render()}},{key:"getIfMouseWasDraggedOutside",value:function(t){var e=this.hot.rootDocument.documentElement,o=Object(i.offset)(this.hot.table).top-(this.hot.rootWindow.pageYOffset||e.scrollTop)+Object(i.outerHeight)(this.hot.table),n=Object(i.offset)(this.hot.table).left-(this.hot.rootWindow.pageXOffset||e.scrollLeft)+Object(i.outerWidth)(this.hot.table);return t.clientY>o&&t.clientX<=n}},{key:"registerEvents",value:function(){var t=this,e=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(e,"mouseup",(function(){return t.onMouseUp()})),this.eventManager.addEventListener(e,"mousemove",(function(e){return t.onMouseMove(e)}))}},{key:"onCellCornerDblClick",value:function(){this.selectAdjacent()&&this.fillIn()}},{key:"onAfterCellCornerMouseDown",value:function(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}},{key:"onBeforeCellMouseOver",value:function(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}},{key:"onMouseUp",value:function(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}},{key:"onMouseMove",value:function(t){var e=this.getIfMouseWasDraggedOutside(t);!1===this.addingStarted&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}},{key:"clearMappedSettings",value:function(){this.directions.length=0,this.autoInsertRow=!1}},{key:"mapSettings",value:function(){var t=Object(c.d)(this.hot.getSettings().fillHandle);this.directions=t.directions,this.autoInsertRow=t.autoInsertRow}},{key:"destroy",value:function(){v(R(h.prototype),"destroy",this).call(this)}}])&&p(e.prototype,o),n&&p(e,n),h}(n.a)},742:function(t,e,o){"use strict";o.d(e,"a",(function(){return R}));o(15),o(72),o(18),o(17),o(19),o(31),o(23),o(10),o(12),o(4),o(13),o(5),o(6),o(7),o(20),o(16);var n=o(49),r=o(1),i=o(60),a=o(0),l=o(175),u=o(2),s=o(14),c=o(242),h=o(44),f=o(110);function d(t){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function g(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var o=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==o)return;var n,r,i=[],a=!0,l=!1;try{for(o=o.call(t);!(a=(n=o.next()).done)&&(i.push(n.value),!e||i.length!==e);a=!0);}catch(t){l=!0,r=t}finally{try{a||null==o.return||o.return()}finally{if(l)throw r}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return y(t,e);var o=Object.prototype.toString.call(t).slice(8,-1);"Object"===o&&t.constructor&&(o=t.constructor.name);if("Map"===o||"Set"===o)return Array.from(t);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return y(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(t,e){(null==e||e>t.length)&&(e=t.length);for(var o=0,n=new Array(e);o<e;o++)n[o]=t[o];return n}function p(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function v(t,e,o){return(v="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,o){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=C(t)););return t}(t,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(o):r.value}})(t,e,o||t)}function m(t,e){return(m=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function w(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,n=C(t);if(e){var r=C(this).constructor;o=Reflect.construct(n,arguments,r)}else o=n.apply(this,arguments);return b(this,o)}}function b(t,e){if(e&&("object"===d(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function C(t){return(C=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var R=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&m(t,e)}(y,t);var e,o,n,d=w(y);function y(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,y),(e=d.call(this,t)).rowHeightsMap=void 0,e.headerHeight=null,e.ghostTable=new l.a(e.hot),e.samplesGenerator=new c.a((function(t,o){var n;return t>=0?n=e.hot.getDataAtCell(t,o):-1===t&&(n=e.hot.getColHeader(o)),{value:n}})),e.firstCalculation=!0,e.inProgress=!1,e.measuredRows=0,e.rowHeightsMap=new f.a,e.hot.rowIndexMapper.registerMap("autoRowSize",e.rowHeightsMap),e.addHook("beforeRowResize",(function(t,o,n){return e.onBeforeRowResize(t,o,n)})),e}return e=y,n=[{key:"PLUGIN_KEY",get:function(){return"autoRowSize"}},{key:"PLUGIN_PRIORITY",get:function(){return 40}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 500}}],(o=[{key:"isEnabled",value:function(){var t=this.hot.getSettings().autoRowSize;return!0===t||Object(u.isObject)(t)}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",(function(){return t.onAfterLoadData()})),this.addHook("beforeChange",(function(e){return t.onBeforeChange(e)})),this.addHook("beforeColumnResize",(function(){return t.recalculateAllRowsHeight()})),this.addHook("beforeViewRender",(function(e){return t.onBeforeViewRender(e)})),this.addHook("modifyRowHeight",(function(e,o){return t.getRowHeight(o,e)})),this.addHook("modifyColumnHeaderHeight",(function(){return t.getColumnHeaderHeight()})),v(C(y.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var t=this;this.headerHeight=null,v(C(y.prototype),"disablePlugin",this).call(this),this.addHook("beforeRowResize",(function(e,o,n){return t.onBeforeRowResize(e,o,n)}))}},{key:"calculateRowsHeight",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countCols()-1},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i="number"==typeof e?{from:e,to:e}:e,a="number"==typeof o?{from:o,to:o}:o;if(null!==this.hot.getColHeader(0)){var l=this.samplesGenerator.generateRowSamples(-1,a);this.ghostTable.addColumnHeadersRow(l.get(-1))}Object(s.rangeEach)(i.from,i.to,(function(e){if(n||null===t.rowHeightsMap.getValueAtIndex(e)){var o=t.samplesGenerator.generateRowSamples(e,a);Object(r.arrayEach)(o,(function(e){var o=g(e,2),n=o[0],r=o[1];return t.ghostTable.addRow(n,r)}))}})),this.ghostTable.rows.length&&(this.hot.batchExecution((function(){t.ghostTable.getHeights((function(e,o){e<0?t.headerHeight=o:t.rowHeightsMap.setValueAtIndex(t.hot.toPhysicalRow(e),o)}))}),!0),this.measuredRows=i.to+1,this.ghostTable.clean())}},{key:"calculateAllRowsHeight",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},o=0,n=this.hot.countRows()-1,r=null;this.inProgress=!0;var a=function a(){if(!t.hot)return Object(i.cancelAnimationFrame)(r),void(t.inProgress=!1);t.calculateRowsHeight({from:o,to:Math.min(o+y.CALCULATION_STEP,n)},e),(o=o+y.CALCULATION_STEP+1)<n?r=Object(i.requestAnimationFrame)(a):(Object(i.cancelAnimationFrame)(r),t.inProgress=!1,t.hot.view.adjustElementsSize(!0),t.hot.view.wt.wtOverlays.leftOverlay.needFullRender&&t.hot.view.wt.wtOverlays.leftOverlay.clone.draw())},l=this.getSyncCalculationLimit();this.firstCalculation&&l>=0&&(this.calculateRowsHeight({from:0,to:l},e),this.firstCalculation=!1,o=l+1),o<n?a():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}},{key:"setSamplingOptions",value:function(){var t=this.hot.getSettings().autoRowSize,e=t&&Object(u.hasOwnProperty)(t,"samplingRatio")?t.samplingRatio:void 0,o=t&&Object(u.hasOwnProperty)(t,"allowSampleDuplicates")?t.allowSampleDuplicates:void 0;e&&!isNaN(e)&&this.samplesGenerator.setSampleCount(parseInt(e,10)),o&&this.samplesGenerator.setAllowDuplicates(o)}},{key:"recalculateAllRowsHeight",value:function(){Object(a.isVisible)(this.hot.view.wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}},{key:"getSyncCalculationLimit",value:function(){var t=this.hot.getSettings().autoRowSize,e=y.SYNC_CALCULATION_LIMIT,o=this.hot.countRows()-1;return Object(u.isObject)(t)&&(e=t.syncLimit,Object(h.isPercentValue)(e)?e=Object(s.valueAccordingPercent)(o,e):e>>=0),Math.min(e,o)}},{key:"getRowHeight",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,o=t<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(t)),n=e;return null!==o&&o>(e||0)&&(n=o),n}},{key:"getColumnHeaderHeight",value:function(){return this.headerHeight}},{key:"getFirstVisibleRow",value:function(){var t=this.hot.view.wt;return t.wtViewport.rowsVisibleCalculator?t.wtTable.getFirstVisibleRow():t.wtViewport.rowsRenderCalculator?t.wtTable.getFirstRenderedRow():-1}},{key:"getLastVisibleRow",value:function(){var t=this.hot.view.wt;return t.wtViewport.rowsVisibleCalculator?t.wtTable.getLastVisibleRow():t.wtViewport.rowsRenderCalculator?t.wtTable.getLastRenderedRow():-1}},{key:"clearCache",value:function(){this.headerHeight=null,this.rowHeightsMap.init()}},{key:"clearCacheByRange",value:function(t){var e=this,o="number"==typeof t?{from:t,to:t}:t,n=o.from,r=o.to;this.hot.batchExecution((function(){Object(s.rangeEach)(Math.min(n,r),Math.max(n,r),(function(t){e.rowHeightsMap.setValueAtIndex(t,null)}))}),!0)}},{key:"isNeedRecalculate",value:function(){return!!Object(r.arrayFilter)(this.rowHeightsMap.getValues().slice(0,this.measuredRows),(function(t){return null===t})).length}},{key:"onBeforeViewRender",value:function(){var t=this.hot.renderCall,e=this.hot.getSettings().fixedRowsBottom,o=this.getFirstVisibleRow(),n=this.getLastVisibleRow();if(-1!==o&&-1!==n){if(this.calculateRowsHeight({from:o,to:n},void 0,t),e){var r=this.hot.countRows()-1;this.calculateRowsHeight({from:r-e,to:r})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}},{key:"onBeforeRowMove",value:function(t,e){this.clearCacheByRange({from:t,to:e}),this.calculateAllRowsHeight()}},{key:"onBeforeRowResize",value:function(t,e,o){var n=t;return o&&(this.calculateRowsHeight(e,void 0,!0),n=this.getRowHeight(e)),n}},{key:"onAfterLoadData",value:function(){var t=this;this.hot.view?this.recalculateAllRowsHeight():setTimeout((function(){t.hot&&t.recalculateAllRowsHeight()}),0)}},{key:"onBeforeChange",value:function(t){var e=null;1===t.length?e=t[0][0]:t.length>1&&(e={from:t[0][0],to:t[t.length-1][0]}),null!==e&&this.clearCacheByRange(e)}},{key:"destroy",value:function(){this.ghostTable.clean(),v(C(y.prototype),"destroy",this).call(this)}}])&&p(e.prototype,o),n&&p(e,n),y}(n.a)}}]);